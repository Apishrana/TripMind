{"file_contents":{"pyproject.toml":{"content":"[project]\nname = \"python-template\"\nversion = \"0.1.0\"\ndescription = \"\"\nauthors = [\"Your Name <you@example.com>\"]\nrequires-python = \">=3.11\"\ndependencies = [\n    \"fastapi>=0.121.0\",\n    \"langchain>=1.0.5\",\n    \"langchain-community>=0.4.1\",\n    \"langchain-google-genai>=3.0.1\",\n    \"langchain-groq>=1.0.0\",\n    \"langchain-openai>=1.0.2\",\n    \"openai>=2.7.1\",\n    \"psycopg2-binary>=2.9.11\",\n    \"pydantic>=2.12.4\",\n    \"python-dotenv>=1.2.1\",\n    \"sqlalchemy>=2.0.44\",\n    \"stripe>=13.2.0\",\n    \"uvicorn>=0.38.0\",\n]\n","size_bytes":512},"main.py":{"content":"import os\nfrom fastapi import FastAPI, HTTPException, Depends\nfrom fastapi.staticfiles import StaticFiles\nfrom fastapi.responses import FileResponse, RedirectResponse\nfrom pydantic import BaseModel\nfrom agent.travel_agent import TravelPlannerAgent\nimport uvicorn\nimport stripe\nfrom stripe._error import StripeError\nfrom typing import Optional, Dict, Any, List\nfrom datetime import datetime\nimport json\nfrom sqlalchemy.orm import Session\nfrom database import init_db, get_db, Itinerary, Booking, CalendarEvent\n\n# Initialize FastAPI app\napp = FastAPI(title=\"Travel Planner AI Agent\")\n\n# Initialize database\ninit_db()\n\n# Initialize Stripe (API key will be set from environment)\nstripe.api_key = os.environ.get('STRIPE_SECRET_KEY', '')\n\n# Initialize the AI agent (only if API key is available)\nagent = None\ntry:\n    if os.environ.get('GROQ_API_KEY'):\n        agent = TravelPlannerAgent()\n    else:\n        print(\"Warning: GROQ_API_KEY not set. AI agent features will be unavailable.\")\nexcept Exception as e:\n    print(f\"Warning: Failed to initialize AI agent: {e}. AI agent features will be unavailable.\")\n\n# In-memory storage for bookings (fallback, but we'll use database)\nbookings_store = {}\n\n# Server-side trip pricing (canonical source of truth)\nTRIP_PRICES = {\n    \"goa-beach\": 450.00,\n    \"paris-family\": 750.00,\n    \"manali-adventure\": 200.00\n}\n\n# Request/Response models\nclass TravelQuery(BaseModel):\n    query: str\n\nclass TravelResponse(BaseModel):\n    status: str\n    response: str\n    request: str = \"\"\n    error: str = \"\"\n\nclass BookingRequest(BaseModel):\n    trip_id: str\n    trip_name: str\n    destination: str\n    start_date: str\n    end_date: str\n    total_price: float\n    passengers: int\n    email: Optional[str] = None\n    flight_details: Optional[Dict[str, Any]] = None\n    hotel_details: Optional[Dict[str, Any]] = None\n    special_requests: Optional[str] = None\n\nclass PaymentRequest(BaseModel):\n    booking_id: str\n    amount: float\n\nclass CalendarEventRequest(BaseModel):\n    title: str\n    description: Optional[str] = None\n    start_date: str\n    end_date: str\n    start_time: Optional[str] = None\n    end_time: Optional[str] = None\n    all_day: Optional[str] = \"true\"\n    event_type: Optional[str] = \"personal\"\n    tags: Optional[List[str]] = None\n    color: Optional[str] = None\n    booking_id: Optional[str] = None\n    reminder_enabled: Optional[str] = \"false\"\n    reminder_time: Optional[str] = None\n\nclass ItineraryRequest(BaseModel):\n    trip_name: str\n    destination: str\n    start_date: str\n    end_date: str\n    duration_days: int\n    budget: Optional[float] = None\n    description: Optional[str] = None\n    itinerary_data: Optional[Dict[str, Any]] = None\n\n# Serve static files\napp.mount(\"/static\", StaticFiles(directory=\"static\"), name=\"static\")\n\n@app.get(\"/\")\nasync def read_root():\n    \"\"\"Serve the main HTML page.\"\"\"\n    return FileResponse(\"static/index.html\")\n\n@app.post(\"/api/plan\", response_model=TravelResponse)\nasync def plan_trip(query: TravelQuery):\n    \"\"\"\n    Main endpoint for travel planning.\n    Accepts natural language queries and returns AI-generated travel plans.\n    \"\"\"\n    if agent is None:\n        return TravelResponse(\n            status=\"error\",\n            response=\"⚠️ AI Agent is currently unavailable. Please configure the GROQ_API_KEY environment variable to enable AI-powered trip planning. You can still use the booking features!\",\n            request=query.query,\n            error=\"AI agent is not available. Please set GROQ_API_KEY environment variable.\"\n        )\n    try:\n        result = agent.plan_trip(query.query)\n        \n        return TravelResponse(\n            status=result.get(\"status\", \"success\"),\n            response=result.get(\"response\", \"\"),\n            request=result.get(\"request\", query.query),\n            error=result.get(\"error\", \"\")\n        )\n    except Exception as e:\n        return TravelResponse(\n            status=\"error\",\n            response=f\"❌ An error occurred: {str(e)}\",\n            request=query.query,\n            error=str(e)\n        )\n\n@app.post(\"/api/reset\")\nasync def reset_memory():\n    \"\"\"Reset the agent's conversation memory.\"\"\"\n    if agent is None:\n        return {\"status\": \"error\", \"message\": \"AI agent is not available\"}\n    try:\n        agent.reset_memory()\n        return {\"status\": \"success\", \"message\": \"Memory cleared\"}\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.get(\"/api/history\")\nasync def get_history():\n    \"\"\"Get conversation history.\"\"\"\n    if agent is None:\n        return {\"status\": \"success\", \"history\": []}\n    try:\n        history = agent.get_conversation_history()\n        return {\"status\": \"success\", \"history\": history}\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.get(\"/api/preferences\")\nasync def get_preferences():\n    \"\"\"Get saved user preferences.\"\"\"\n    try:\n        from agent.travel_agent import user_preferences_store\n        return {\n            \"status\": \"success\",\n            \"preferences\": user_preferences_store\n        }\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.post(\"/api/booking-options\")\nasync def get_booking_options(request: Dict[str, Any] = None):\n    \"\"\"Extract flight and hotel options from conversation history or provided trip details.\"\"\"\n    try:\n        # Get trip details from request or conversation history\n        destination = None\n        origin = \"Mumbai\"  # Default origin\n        start_date = None\n        end_date = None\n        budget = None\n        passengers = 1\n        \n        if request and request.get(\"trip_details\"):\n            # Use provided trip details\n            trip = request[\"trip_details\"]\n            destination = trip.get(\"destination\")\n            origin = trip.get(\"origin\", \"Mumbai\")\n            start_date = trip.get(\"start_date\")\n            end_date = trip.get(\"end_date\")\n            budget = trip.get(\"budget\")\n            passengers = trip.get(\"passengers\", 1)\n        elif agent is not None:\n            # Extract from conversation history\n            history = agent.get_conversation_history()\n            import re\n            for entry in history:\n                content = entry.get(\"content\", \"\")\n                \n                # Extract dates\n                date_pattern = r'\\d{4}-\\d{2}-\\d{2}'\n                dates = re.findall(date_pattern, content)\n                if dates:\n                    if not start_date:\n                        start_date = dates[0]\n                    if len(dates) > 1:\n                        end_date = dates[1]\n                    elif not end_date:\n                        end_date = dates[0]\n                \n                # Extract destination\n                dest_patterns = [\n                    r'(?:destination|going to|visit|trip to|travel to)[:\\s]+([A-Z][a-z]+(?:\\s+[A-Z][a-z]+)*)',\n                    r'([A-Z][a-z]+(?:\\s+[A-Z][a-z]+)*)\\s+(?:trip|vacation|getaway)',\n                ]\n                for pattern in dest_patterns:\n                    dest_match = re.search(pattern, content, re.IGNORECASE)\n                    if dest_match and not destination:\n                        destination = dest_match.group(1)\n                        break\n                \n                # Extract budget\n                budget_match = re.search(r'\\$(\\d+(?:\\.\\d{2})?)', content)\n                if budget_match and not budget:\n                    budget = float(budget_match.group(1))\n                \n                # Extract passengers\n                passenger_match = re.search(r'(\\d+)\\s*(?:passenger|person|people|guest)', content, re.IGNORECASE)\n                if passenger_match and passengers == 1:\n                    passengers = int(passenger_match.group(1))\n        \n        # Use defaults if not found\n        if not destination:\n            destination = \"Goa\"\n        if not start_date:\n            from datetime import datetime, timedelta\n            start_date = (datetime.now() + timedelta(days=7)).strftime(\"%Y-%m-%d\")\n        if not end_date:\n            from datetime import datetime, timedelta\n            end_date = (datetime.now() + timedelta(days=14)).strftime(\"%Y-%m-%d\")\n        if not budget:\n            budget = 1000.0\n        \n        # Get flight options using the agent's search_flights tool\n        flights_data = []\n        hotels_data = []\n        \n        if agent is not None:\n            from agent.travel_agent import search_flights, search_hotels\n            import json\n            \n            # Search flights\n            flight_budget = budget * 0.4  # Allocate 40% of budget to flights\n            flights_result = search_flights(origin, destination, start_date, flight_budget / passengers)\n            flights_json = json.loads(flights_result)\n            flights_data = flights_json.get(\"flights\", [])\n            \n            # Search hotels\n            hotel_budget = budget * 0.4  # Allocate 40% of budget to hotels per night\n            num_nights = (datetime.strptime(end_date, \"%Y-%m-%d\") - datetime.strptime(start_date, \"%Y-%m-%d\")).days\n            hotels_result = search_hotels(destination, start_date, end_date, hotel_budget / num_nights if num_nights > 0 else hotel_budget)\n            hotels_json = json.loads(hotels_result)\n            hotels_data = hotels_json.get(\"hotels\", [])\n        else:\n            # Fallback: Generate sample flights and hotels\n            flights_data = [\n                {\n                    \"airline\": \"Air India\",\n                    \"flight_number\": \"AI202\",\n                    \"departure_time\": \"08:00\",\n                    \"arrival_time\": \"10:30\",\n                    \"duration\": \"2h 30m\",\n                    \"price\": min(budget * 0.3, 450),\n                    \"stops\": 0,\n                    \"class\": \"Economy\"\n                },\n                {\n                    \"airline\": \"IndiGo\",\n                    \"flight_number\": \"6E345\",\n                    \"departure_time\": \"14:00\",\n                    \"arrival_time\": \"16:45\",\n                    \"duration\": \"2h 45m\",\n                    \"price\": min(budget * 0.25, 350),\n                    \"stops\": 0,\n                    \"class\": \"Economy\"\n                },\n                {\n                    \"airline\": \"SpiceJet\",\n                    \"flight_number\": \"SG890\",\n                    \"departure_time\": \"18:30\",\n                    \"arrival_time\": \"21:15\",\n                    \"duration\": \"2h 45m\",\n                    \"price\": min(budget * 0.2, 320),\n                    \"stops\": 0,\n                    \"class\": \"Economy\"\n                }\n            ]\n            \n            num_nights = (datetime.strptime(end_date, \"%Y-%m-%d\") - datetime.strptime(start_date, \"%Y-%m-%d\")).days\n            hotels_data = [\n                {\n                    \"name\": \"Beach Paradise Resort\",\n                    \"rating\": 4.5,\n                    \"price_per_night\": min(budget * 0.3 / num_nights if num_nights > 0 else budget * 0.3, 120),\n                    \"location\": \"Beachfront\",\n                    \"amenities\": [\"Pool\", \"WiFi\", \"Breakfast\", \"Spa\", \"Beach Access\"],\n                    \"reviews\": 1250,\n                    \"style\": \"luxury\"\n                },\n                {\n                    \"name\": \"Cozy Inn & Suites\",\n                    \"rating\": 4.2,\n                    \"price_per_night\": min(budget * 0.2 / num_nights if num_nights > 0 else budget * 0.2, 80),\n                    \"location\": \"City Center\",\n                    \"amenities\": [\"WiFi\", \"Breakfast\", \"Parking\", \"Gym\"],\n                    \"reviews\": 890,\n                    \"style\": \"mid-range\"\n                },\n                {\n                    \"name\": \"Budget Stay Hotel\",\n                    \"rating\": 3.8,\n                    \"price_per_night\": min(budget * 0.15 / num_nights if num_nights > 0 else budget * 0.15, 50),\n                    \"location\": \"Near Beach\",\n                    \"amenities\": [\"WiFi\", \"AC\", \"24/7 Reception\"],\n                    \"reviews\": 456,\n                    \"style\": \"budget-friendly\"\n                }\n            ]\n        \n        return {\n            \"status\": \"success\",\n            \"trip_details\": {\n                \"origin\": origin,\n                \"destination\": destination,\n                \"start_date\": start_date,\n                \"end_date\": end_date,\n                \"budget\": budget,\n                \"passengers\": passengers\n            },\n            \"flights\": flights_data,\n            \"hotels\": hotels_data\n        }\n    except Exception as e:\n        return {\n            \"status\": \"error\",\n            \"message\": str(e),\n            \"flights\": [],\n            \"hotels\": []\n        }\n\n@app.post(\"/api/bookings\")\nasync def create_booking(booking: BookingRequest, db: Session = Depends(get_db)):\n    \"\"\"Create a new booking with server-side price calculation.\"\"\"\n    try:\n        # SECURITY: Calculate price server-side using canonical trip prices\n        # Ignore any client-provided total_price\n        \n        if booking.trip_id not in TRIP_PRICES:\n            raise HTTPException(\n                status_code=400, \n                detail=f\"Unknown trip ID: {booking.trip_id}\"\n            )\n        \n        # Validate passenger count\n        if booking.passengers < 1 or booking.passengers > 10:\n            raise HTTPException(\n                status_code=400,\n                detail=\"Passenger count must be between 1 and 10\"\n            )\n        \n        # Calculate total using TRUSTED server-side pricing\n        base_price = TRIP_PRICES[booking.trip_id]\n        calculated_total = base_price * booking.passengers\n        \n        booking_id = f\"BK{datetime.now().strftime('%Y%m%d%H%M%S')}\"\n        \n        # Extract email from flight_details if not provided directly\n        email = booking.email\n        if not email and booking.flight_details and isinstance(booking.flight_details, dict):\n            email = booking.flight_details.get('email')\n        \n        # Extract special_requests from flight_details if not provided directly\n        special_requests = booking.special_requests\n        if not special_requests and booking.flight_details and isinstance(booking.flight_details, dict):\n            special_requests = booking.flight_details.get('special_requests')\n        \n        # Create booking in database\n        db_booking = Booking(\n            booking_id=booking_id,\n            trip_id=booking.trip_id,\n            trip_name=booking.trip_name,\n            destination=booking.destination,\n            start_date=booking.start_date,\n            end_date=booking.end_date,\n            base_price=base_price,\n            total_price=calculated_total,\n            passengers=booking.passengers,\n            email=email,\n            flight_details=booking.flight_details or {},\n            hotel_details=booking.hotel_details or {},\n            special_requests=special_requests,\n            status=\"pending\",\n            payment_status=\"unpaid\"\n        )\n        \n        db.add(db_booking)\n        db.commit()\n        db.refresh(db_booking)\n        \n        # Also store in memory for backward compatibility\n        booking_data = {\n            \"id\": booking_id,\n            \"booking_id\": booking_id,\n            \"trip_id\": booking.trip_id,\n            \"trip_name\": booking.trip_name,\n            \"destination\": booking.destination,\n            \"start_date\": booking.start_date,\n            \"end_date\": booking.end_date,\n            \"base_price\": base_price,\n            \"total_price\": calculated_total,\n            \"passengers\": booking.passengers,\n            \"email\": email,\n            \"flight_details\": booking.flight_details,\n            \"hotel_details\": booking.hotel_details,\n            \"special_requests\": special_requests,\n            \"status\": \"pending\",\n            \"payment_status\": \"unpaid\",\n            \"created_at\": db_booking.created_at.isoformat() if db_booking.created_at else datetime.now().isoformat()\n        }\n        bookings_store[booking_id] = booking_data\n        \n        return {\n            \"status\": \"success\",\n            \"booking_id\": booking_id,\n            \"booking\": booking_data\n        }\n    except HTTPException:\n        raise\n    except Exception as e:\n        db.rollback()\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.get(\"/api/bookings\")\nasync def get_bookings(db: Session = Depends(get_db), status: Optional[str] = None):\n    \"\"\"Get all bookings, optionally filtered by status.\"\"\"\n    try:\n        query = db.query(Booking).order_by(Booking.created_at.desc())\n        \n        if status:\n            query = query.filter(Booking.status == status)\n        \n        bookings = query.all()\n        \n        result = []\n        for booking in bookings:\n            result.append({\n                \"id\": booking.booking_id,\n                \"booking_id\": booking.booking_id,\n                \"trip_id\": booking.trip_id,\n                \"trip_name\": booking.trip_name,\n                \"destination\": booking.destination,\n                \"start_date\": booking.start_date,\n                \"end_date\": booking.end_date,\n                \"base_price\": booking.base_price,\n                \"total_price\": booking.total_price,\n                \"passengers\": booking.passengers,\n                \"email\": booking.email,\n                \"flight_details\": booking.flight_details,\n                \"hotel_details\": booking.hotel_details,\n                \"special_requests\": booking.special_requests,\n                \"status\": booking.status,\n                \"payment_status\": booking.payment_status,\n                \"created_at\": booking.created_at.isoformat() if booking.created_at else None,\n                \"confirmed_at\": booking.confirmed_at.isoformat() if booking.confirmed_at else None,\n                \"cancelled_at\": booking.cancelled_at.isoformat() if booking.cancelled_at else None\n            })\n        \n        return {\n            \"status\": \"success\",\n            \"bookings\": result\n        }\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.get(\"/api/bookings/{booking_id}\")\nasync def get_booking(booking_id: str, db: Session = Depends(get_db)):\n    \"\"\"Get a specific booking by booking_id.\"\"\"\n    try:\n        booking = db.query(Booking).filter(Booking.booking_id == booking_id).first()\n        \n        if not booking:\n            # Fallback to in-memory store for backward compatibility\n            if booking_id in bookings_store:\n                return {\n                    \"status\": \"success\",\n                    \"booking\": bookings_store[booking_id]\n                }\n            raise HTTPException(status_code=404, detail=\"Booking not found\")\n        \n        booking_data = {\n            \"id\": booking.booking_id,\n            \"booking_id\": booking.booking_id,\n            \"trip_id\": booking.trip_id,\n            \"trip_name\": booking.trip_name,\n            \"destination\": booking.destination,\n            \"start_date\": booking.start_date,\n            \"end_date\": booking.end_date,\n            \"base_price\": booking.base_price,\n            \"total_price\": booking.total_price,\n            \"passengers\": booking.passengers,\n            \"email\": booking.email,\n            \"flight_details\": booking.flight_details,\n            \"hotel_details\": booking.hotel_details,\n            \"special_requests\": booking.special_requests,\n            \"status\": booking.status,\n            \"payment_status\": booking.payment_status,\n            \"stripe_session_id\": booking.stripe_session_id,\n            \"created_at\": booking.created_at.isoformat() if booking.created_at else None,\n            \"confirmed_at\": booking.confirmed_at.isoformat() if booking.confirmed_at else None,\n            \"cancelled_at\": booking.cancelled_at.isoformat() if booking.cancelled_at else None,\n            \"updated_at\": booking.updated_at.isoformat() if booking.updated_at else None\n        }\n        \n        return {\n            \"status\": \"success\",\n            \"booking\": booking_data\n        }\n    except HTTPException:\n        raise\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.post(\"/api/create-checkout-session\")\nasync def create_checkout_session(payment: PaymentRequest, db: Session = Depends(get_db)):\n    \"\"\"Create a Stripe checkout session for payment.\"\"\"\n    try:\n        if not stripe.api_key:\n            raise HTTPException(\n                status_code=400, \n                detail=\"Stripe is not configured. Please set STRIPE_SECRET_KEY.\"\n            )\n        \n        booking = db.query(Booking).filter(Booking.booking_id == payment.booking_id).first()\n        \n        if not booking:\n            # Fallback to in-memory store\n            if payment.booking_id not in bookings_store:\n                raise HTTPException(status_code=404, detail=\"Booking not found\")\n            booking_dict = bookings_store[payment.booking_id]\n            actual_amount = booking_dict['total_price']\n            \n            # Validate booking is in a payable state (in-memory)\n            if booking_dict.get('status') == 'confirmed':\n                raise HTTPException(status_code=400, detail=\"Booking is already confirmed\")\n            if booking_dict.get('status') == 'cancelled':\n                raise HTTPException(status_code=400, detail=\"Booking is cancelled\")\n            if booking_dict.get('payment_status') == 'paid':\n                raise HTTPException(status_code=400, detail=\"Booking is already paid\")\n            \n            # Use in-memory booking data for Stripe\n            booking_destination = booking_dict.get('destination', 'Unknown')\n            booking_trip_name = booking_dict.get('trip_name', 'Trip')\n            booking_start_date = booking_dict.get('start_date', '')\n            booking_end_date = booking_dict.get('end_date', '')\n            booking_passengers = booking_dict.get('passengers', 1)\n            booking_email = booking_dict.get('email')\n        else:\n            actual_amount = booking.total_price\n            \n            # Validate booking is in a payable state\n            if booking.status == 'confirmed':\n                raise HTTPException(status_code=400, detail=\"Booking is already confirmed\")\n            if booking.status == 'cancelled':\n                raise HTTPException(status_code=400, detail=\"Booking is cancelled\")\n            if booking.payment_status == 'paid':\n                raise HTTPException(status_code=400, detail=\"Booking is already paid\")\n            \n            # Use database booking data for Stripe\n            booking_destination = booking.destination\n            booking_trip_name = booking.trip_name\n            booking_start_date = booking.start_date\n            booking_end_date = booking.end_date\n            booking_passengers = booking.passengers\n            booking_email = booking.email\n        \n        # Optional: Log if client-provided amount differs from booking total\n        if abs(payment.amount - actual_amount) > 0.01:\n            print(f\"Warning: Client amount ({payment.amount}) differs from booking total ({actual_amount})\")\n        \n        # Get the domain for success/cancel URLs\n        domain = os.environ.get('REPLIT_DEV_DOMAIN', 'localhost:5000')\n        if os.environ.get('REPLIT_DEPLOYMENT'):\n            protocol = 'https://'\n        else:\n            domains = os.environ.get('REPLIT_DOMAINS', '').split(',')\n            domain = domains[0] if domains and domains[0] else 'localhost:5000'\n            # Use http:// for localhost, https:// for other domains\n            protocol = 'https://' if not domain.startswith('localhost') else 'http://'\n        \n        # Create Stripe checkout session using TRUSTED server-side amount\n        checkout_session = stripe.checkout.Session.create(\n            payment_method_types=['card'],\n            line_items=[\n                {\n                    'price_data': {\n                        'currency': 'usd',\n                        'unit_amount': int(actual_amount * 100),  # Use booking total, not client amount\n                        'product_data': {\n                            'name': f\"Trip to {booking_destination}\",\n                            'description': f\"{booking_trip_name} - {booking_start_date} to {booking_end_date} ({booking_passengers} passenger(s))\",\n                        },\n                    },\n                    'quantity': 1,\n                },\n            ],\n            mode='payment',\n            success_url=f'{protocol}{domain}/?payment=success&booking_id={payment.booking_id}',\n            cancel_url=f'{protocol}{domain}/?payment=cancelled&booking_id={payment.booking_id}',\n            customer_email=booking_email,\n            metadata={\n                'booking_id': payment.booking_id,\n                'expected_amount': str(actual_amount)\n            }\n        )\n        \n        # Update booking with Stripe session ID (only if using database)\n        if booking:\n            booking.stripe_session_id = checkout_session.id\n            db.commit()\n        \n        return {\n            \"status\": \"success\",\n            \"checkout_url\": checkout_session.url,\n            \"session_id\": checkout_session.id\n        }\n    except StripeError as e:\n        raise HTTPException(status_code=400, detail=f\"Stripe error: {str(e)}\")\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.post(\"/api/bookings/{booking_id}/confirm\")\nasync def confirm_booking(booking_id: str, db: Session = Depends(get_db)):\n    \"\"\"Confirm a booking after successful payment.\"\"\"\n    try:\n        booking = db.query(Booking).filter(Booking.booking_id == booking_id).first()\n        \n        if not booking:\n            # Fallback to in-memory store\n            if booking_id not in bookings_store:\n                raise HTTPException(status_code=404, detail=\"Booking not found\")\n            bookings_store[booking_id][\"status\"] = \"confirmed\"\n            bookings_store[booking_id][\"payment_status\"] = \"paid\"\n            bookings_store[booking_id][\"confirmed_at\"] = datetime.now().isoformat()\n            return {\n                \"status\": \"success\",\n                \"booking\": bookings_store[booking_id]\n            }\n        \n        booking.status = \"confirmed\"\n        booking.payment_status = \"paid\"\n        booking.confirmed_at = datetime.utcnow()\n        db.commit()\n        db.refresh(booking)\n        \n        # Also update in-memory store\n        if booking_id in bookings_store:\n            bookings_store[booking_id][\"status\"] = \"confirmed\"\n            bookings_store[booking_id][\"payment_status\"] = \"paid\"\n            bookings_store[booking_id][\"confirmed_at\"] = booking.confirmed_at.isoformat()\n        \n        booking_data = {\n            \"id\": booking.booking_id,\n            \"booking_id\": booking.booking_id,\n            \"trip_id\": booking.trip_id,\n            \"trip_name\": booking.trip_name,\n            \"destination\": booking.destination,\n            \"start_date\": booking.start_date,\n            \"end_date\": booking.end_date,\n            \"base_price\": booking.base_price,\n            \"total_price\": booking.total_price,\n            \"passengers\": booking.passengers,\n            \"email\": booking.email,\n            \"status\": booking.status,\n            \"payment_status\": booking.payment_status,\n            \"confirmed_at\": booking.confirmed_at.isoformat() if booking.confirmed_at else None\n        }\n        \n        return {\n            \"status\": \"success\",\n            \"booking\": booking_data\n        }\n    except HTTPException:\n        raise\n    except Exception as e:\n        db.rollback()\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.delete(\"/api/bookings/{booking_id}\")\nasync def cancel_booking(booking_id: str, db: Session = Depends(get_db)):\n    \"\"\"Cancel a booking.\"\"\"\n    try:\n        booking = db.query(Booking).filter(Booking.booking_id == booking_id).first()\n        \n        if not booking:\n            # Fallback to in-memory store\n            if booking_id not in bookings_store:\n                raise HTTPException(status_code=404, detail=\"Booking not found\")\n            bookings_store[booking_id][\"status\"] = \"cancelled\"\n            bookings_store[booking_id][\"cancelled_at\"] = datetime.now().isoformat()\n            return {\n                \"status\": \"success\",\n                \"message\": \"Booking cancelled successfully\"\n            }\n        \n        if booking.status == \"cancelled\":\n            raise HTTPException(status_code=400, detail=\"Booking is already cancelled\")\n        \n        booking.status = \"cancelled\"\n        booking.cancelled_at = datetime.utcnow()\n        db.commit()\n        \n        # Also update in-memory store\n        if booking_id in bookings_store:\n            bookings_store[booking_id][\"status\"] = \"cancelled\"\n            bookings_store[booking_id][\"cancelled_at\"] = booking.cancelled_at.isoformat()\n        \n        return {\n            \"status\": \"success\",\n            \"message\": \"Booking cancelled successfully\"\n        }\n    except HTTPException:\n        raise\n    except Exception as e:\n        db.rollback()\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.post(\"/api/itineraries\")\nasync def save_itinerary(request: ItineraryRequest, db: Session = Depends(get_db)):\n    \"\"\"Save a planned itinerary to the calendar.\"\"\"\n    try:\n        itinerary = Itinerary(\n            trip_name=request.trip_name,\n            destination=request.destination,\n            start_date=request.start_date,\n            end_date=request.end_date,\n            duration_days=request.duration_days,\n            budget=request.budget,\n            description=request.description,\n            itinerary_data=request.itinerary_data or {}\n        )\n        db.add(itinerary)\n        db.commit()\n        db.refresh(itinerary)\n        \n        return {\n            \"status\": \"success\",\n            \"itinerary_id\": itinerary.id,\n            \"message\": \"Itinerary saved successfully\"\n        }\n    except Exception as e:\n        db.rollback()\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.get(\"/api/itineraries\")\nasync def get_itineraries(db: Session = Depends(get_db)):\n    \"\"\"Get all itineraries for the calendar.\"\"\"\n    try:\n        itineraries = db.query(Itinerary).order_by(Itinerary.created_at.desc()).all()\n        \n        result = []\n        for itin in itineraries:\n            result.append({\n                \"id\": itin.id,\n                \"trip_name\": itin.trip_name,\n                \"destination\": itin.destination,\n                \"start_date\": itin.start_date,\n                \"end_date\": itin.end_date,\n                \"duration_days\": itin.duration_days,\n                \"budget\": itin.budget,\n                \"description\": itin.description,\n                \"itinerary_data\": itin.itinerary_data,\n                \"created_at\": itin.created_at.isoformat() if itin.created_at else None\n            })\n        \n        return {\n            \"status\": \"success\",\n            \"itineraries\": result\n        }\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.get(\"/api/itineraries/{itinerary_id}\")\nasync def get_itinerary(itinerary_id: int, db: Session = Depends(get_db)):\n    \"\"\"Get a specific itinerary by ID.\"\"\"\n    try:\n        itinerary = db.query(Itinerary).filter(Itinerary.id == itinerary_id).first()\n        \n        if not itinerary:\n            raise HTTPException(status_code=404, detail=\"Itinerary not found\")\n        \n        return {\n            \"status\": \"success\",\n            \"itinerary\": {\n                \"id\": itinerary.id,\n                \"trip_name\": itinerary.trip_name,\n                \"destination\": itinerary.destination,\n                \"start_date\": itinerary.start_date,\n                \"end_date\": itinerary.end_date,\n                \"duration_days\": itinerary.duration_days,\n                \"budget\": itinerary.budget,\n                \"description\": itinerary.description,\n                \"itinerary_data\": itinerary.itinerary_data,\n                \"created_at\": itinerary.created_at.isoformat() if itinerary.created_at else None\n            }\n        }\n    except HTTPException:\n        raise\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.delete(\"/api/itineraries/{itinerary_id}\")\nasync def delete_itinerary(itinerary_id: int, db: Session = Depends(get_db)):\n    \"\"\"Delete an itinerary from the calendar.\"\"\"\n    try:\n        itinerary = db.query(Itinerary).filter(Itinerary.id == itinerary_id).first()\n        \n        if not itinerary:\n            raise HTTPException(status_code=404, detail=\"Itinerary not found\")\n        \n        db.delete(itinerary)\n        db.commit()\n        \n        return {\n            \"status\": \"success\",\n            \"message\": \"Itinerary deleted successfully\"\n        }\n    except HTTPException:\n        raise\n    except Exception as e:\n        db.rollback()\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.post(\"/api/bookings/from-itinerary/{itinerary_id}\")\nasync def create_booking_from_itinerary(itinerary_id: int, passengers: int = 1, db: Session = Depends(get_db)):\n    \"\"\"Create a booking from a saved itinerary.\"\"\"\n    try:\n        itinerary = db.query(Itinerary).filter(Itinerary.id == itinerary_id).first()\n        \n        if not itinerary:\n            raise HTTPException(status_code=404, detail=\"Itinerary not found\")\n        \n        # Validate passenger count\n        if passengers < 1 or passengers > 10:\n            raise HTTPException(\n                status_code=400,\n                detail=\"Passenger count must be between 1 and 10\"\n            )\n        \n        # Generate a trip_id from itinerary (or use a default)\n        trip_id = f\"itinerary-{itinerary_id}\"\n        \n        # Calculate price based on itinerary budget or use default\n        if itinerary.budget:\n            base_price = itinerary.budget / (itinerary.duration_days or 1)\n        else:\n            # Default pricing if no budget specified\n            base_price = 200.0\n        \n        calculated_total = base_price * passengers\n        \n        booking_id = f\"BK{datetime.now().strftime('%Y%m%d%H%M%S')}\"\n        \n        db_booking = Booking(\n            booking_id=booking_id,\n            trip_id=trip_id,\n            trip_name=itinerary.trip_name,\n            destination=itinerary.destination,\n            start_date=itinerary.start_date,\n            end_date=itinerary.end_date,\n            base_price=base_price,\n            total_price=calculated_total,\n            passengers=passengers,\n            flight_details={},\n            hotel_details={},\n            status=\"pending\",\n            payment_status=\"unpaid\"\n        )\n        \n        db.add(db_booking)\n        db.commit()\n        db.refresh(db_booking)\n        \n        booking_data = {\n            \"id\": booking_id,\n            \"booking_id\": booking_id,\n            \"trip_id\": trip_id,\n            \"trip_name\": itinerary.trip_name,\n            \"destination\": itinerary.destination,\n            \"start_date\": itinerary.start_date,\n            \"end_date\": itinerary.end_date,\n            \"base_price\": base_price,\n            \"total_price\": calculated_total,\n            \"passengers\": passengers,\n            \"status\": \"pending\",\n            \"payment_status\": \"unpaid\",\n            \"created_at\": db_booking.created_at.isoformat() if db_booking.created_at else datetime.now().isoformat()\n        }\n        \n        return {\n            \"status\": \"success\",\n            \"booking_id\": booking_id,\n            \"booking\": booking_data\n        }\n    except HTTPException:\n        raise\n    except Exception as e:\n        db.rollback()\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.get(\"/health\")\nasync def health_check():\n    \"\"\"Health check endpoint.\"\"\"\n    return {\"status\": \"healthy\", \"service\": \"Travel Planner AI Agent\"}\n\n# Calendar Events API Endpoints\n@app.get(\"/api/calendar/events\")\nasync def get_calendar_events(start: Optional[str] = None, end: Optional[str] = None, db: Session = Depends(get_db)):\n    \"\"\"Get all calendar events, optionally filtered by date range.\"\"\"\n    try:\n        # Get all calendar events\n        all_events = db.query(CalendarEvent).all()\n        \n        # Also get bookings and convert them to calendar events\n        bookings = db.query(Booking).filter(Booking.status.in_([\"pending\", \"confirmed\"])).all()\n        \n        events = []\n        \n        # Add manual calendar events\n        for event in all_events:\n            # Determine color based on event type\n            color = event.color\n            if not color:\n                if event.event_type == \"booking\":\n                    color = \"#3b82f6\"  # Blue for bookings\n                elif event.event_type == \"trip\":\n                    color = \"#10b981\"  # Green for trips\n                elif event.event_type == \"reminder\":\n                    color = \"#f59e0b\"  # Yellow for reminders\n                else:\n                    color = \"#6366f1\"  # Purple for personal\n            \n            # Format start and end dates properly\n            start_str = event.start_date\n            end_str = event.end_date\n            \n            # Add time if not all-day and time is provided\n            if event.start_time and event.all_day != \"true\":\n                start_str = f\"{event.start_date}T{event.start_time}:00\"\n            if event.end_time and event.all_day != \"true\":\n                end_str = f\"{event.end_date}T{event.end_time}:00\"\n            \n            events.append({\n                \"id\": f\"event_{event.id}\",\n                \"title\": event.title or \"Untitled Event\",\n                \"description\": event.description or \"\",\n                \"start\": start_str,\n                \"end\": end_str,\n                \"allDay\": event.all_day == \"true\",\n                \"backgroundColor\": color,\n                \"borderColor\": color,\n                \"textColor\": \"#ffffff\",\n                \"extendedProps\": {\n                    \"event_type\": event.event_type or \"personal\",\n                    \"tags\": event.tags if event.tags else [],\n                    \"booking_id\": event.booking_id,\n                    \"reminder_enabled\": event.reminder_enabled == \"true\",\n                    \"reminder_time\": event.reminder_time,\n                    \"database_id\": event.id\n                }\n            })\n        \n        # Add booking events\n        for booking in bookings:\n            status_color = {\n                \"pending\": \"#f59e0b\",  # Yellow\n                \"confirmed\": \"#10b981\",  # Green\n                \"cancelled\": \"#ef4444\",  # Red\n                \"completed\": \"#6b7280\"  # Gray\n            }.get(booking.status, \"#6366f1\")\n            \n            events.append({\n                \"id\": f\"booking_{booking.booking_id}\",\n                \"title\": f\"✈️ {booking.trip_name}\",\n                \"description\": f\"Destination: {booking.destination}\\nPassengers: {booking.passengers}\\nStatus: {booking.status.title()}\",\n                \"start\": booking.start_date,\n                \"end\": booking.end_date,\n                \"allDay\": True,\n                \"backgroundColor\": status_color,\n                \"borderColor\": status_color,\n                \"textColor\": \"#ffffff\",\n                \"extendedProps\": {\n                    \"event_type\": \"booking\",\n                    \"booking_id\": booking.booking_id,\n                    \"status\": booking.status,\n                    \"destination\": booking.destination,\n                    \"is_booking\": True\n                }\n            })\n        \n        return {\n            \"status\": \"success\",\n            \"events\": events\n        }\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.post(\"/api/calendar/events\")\nasync def create_calendar_event(event: CalendarEventRequest, db: Session = Depends(get_db)):\n    \"\"\"Create a new calendar event.\"\"\"\n    try:\n        # Validate required fields\n        if not event.title or not event.title.strip():\n            return {\n                \"status\": \"error\",\n                \"error\": \"Event title is required\"\n            }\n        \n        if not event.start_date or not event.end_date:\n            return {\n                \"status\": \"error\",\n                \"error\": \"Start date and end date are required\"\n            }\n        \n        # Validate date format\n        try:\n            from datetime import datetime\n            datetime.strptime(event.start_date, \"%Y-%m-%d\")\n            datetime.strptime(event.end_date, \"%Y-%m-%d\")\n        except ValueError:\n            return {\n                \"status\": \"error\",\n                \"error\": \"Invalid date format. Please use YYYY-MM-DD format\"\n            }\n        \n        # Determine color based on event type if not provided\n        color = event.color\n        if not color:\n            if event.event_type == \"booking\":\n                color = \"#3b82f6\"\n            elif event.event_type == \"trip\":\n                color = \"#10b981\"\n            elif event.event_type == \"reminder\":\n                color = \"#f59e0b\"\n            else:\n                color = \"#6366f1\"\n        \n        db_event = CalendarEvent(\n            title=event.title.strip(),\n            description=event.description,\n            start_date=event.start_date,\n            end_date=event.end_date,\n            start_time=event.start_time,\n            end_time=event.end_time,\n            all_day=event.all_day or \"true\",\n            event_type=event.event_type or \"personal\",\n            tags=event.tags or [],\n            color=color,\n            booking_id=event.booking_id,\n            reminder_enabled=event.reminder_enabled or \"false\",\n            reminder_time=event.reminder_time\n        )\n        \n        db.add(db_event)\n        db.commit()\n        db.refresh(db_event)\n        \n        return {\n            \"status\": \"success\",\n            \"event_id\": db_event.id,\n            \"message\": \"Event created successfully\"\n        }\n    except Exception as e:\n        db.rollback()\n        import traceback\n        error_msg = str(e)\n        print(f\"Error creating calendar event: {error_msg}\")\n        print(traceback.format_exc())\n        return {\n            \"status\": \"error\",\n            \"error\": f\"Failed to create event: {error_msg}\"\n        }\n\n@app.put(\"/api/calendar/events/{event_id}\")\nasync def update_calendar_event(event_id: int, event: CalendarEventRequest, db: Session = Depends(get_db)):\n    \"\"\"Update an existing calendar event.\"\"\"\n    try:\n        db_event = db.query(CalendarEvent).filter(CalendarEvent.id == event_id).first()\n        if not db_event:\n            return {\n                \"status\": \"error\",\n                \"error\": \"Event not found\"\n            }\n        \n        # Validate required fields\n        if not event.title or not event.title.strip():\n            return {\n                \"status\": \"error\",\n                \"error\": \"Event title is required\"\n            }\n        \n        db_event.title = event.title.strip()\n        db_event.description = event.description\n        db_event.start_date = event.start_date\n        db_event.end_date = event.end_date\n        db_event.start_time = event.start_time\n        db_event.end_time = event.end_time\n        db_event.all_day = event.all_day or \"true\"\n        db_event.event_type = event.event_type or db_event.event_type\n        db_event.tags = event.tags or db_event.tags\n        if event.color:\n            db_event.color = event.color\n        db_event.reminder_enabled = event.reminder_enabled or db_event.reminder_enabled\n        db_event.reminder_time = event.reminder_time\n        db_event.updated_at = datetime.utcnow()\n        \n        db.commit()\n        db.refresh(db_event)\n        \n        return {\n            \"status\": \"success\",\n            \"message\": \"Event updated successfully\"\n        }\n    except Exception as e:\n        db.rollback()\n        import traceback\n        error_msg = str(e)\n        print(f\"Error updating calendar event: {error_msg}\")\n        print(traceback.format_exc())\n        return {\n            \"status\": \"error\",\n            \"error\": f\"Failed to update event: {error_msg}\"\n        }\n\n@app.delete(\"/api/calendar/events/{event_id}\")\nasync def delete_calendar_event(event_id: int, db: Session = Depends(get_db)):\n    \"\"\"Delete a calendar event.\"\"\"\n    try:\n        db_event = db.query(CalendarEvent).filter(CalendarEvent.id == event_id).first()\n        if not db_event:\n            return {\n                \"status\": \"error\",\n                \"error\": \"Event not found\"\n            }\n        \n        db.delete(db_event)\n        db.commit()\n        \n        return {\n            \"status\": \"success\",\n            \"message\": \"Event deleted successfully\"\n        }\n    except Exception as e:\n        db.rollback()\n        import traceback\n        error_msg = str(e)\n        print(f\"Error deleting calendar event: {error_msg}\")\n        print(traceback.format_exc())\n        return {\n            \"status\": \"error\",\n            \"error\": f\"Failed to delete event: {error_msg}\"\n        }\n\nif __name__ == \"__main__\":\n    # Run the server on 0.0.0.0:5000 for Replit\n    uvicorn.run(app, host=\"0.0.0.0\", port=5000)\n","size_bytes":45122},"static/calendar-styles.css":{"content":"/* FullCalendar Custom Styling */\n#calendar-container {\n    width: 100%;\n    min-height: 600px;\n}\n\n.fc {\n    font-family: inherit;\n    background: transparent;\n}\n\n.fc-header-toolbar {\n    margin-bottom: 1.5rem;\n    padding: 1.5rem;\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.12) 0%, rgba(168, 85, 247, 0.1) 50%, rgba(236, 72, 153, 0.1) 100%);\n    border-radius: 18px;\n    border: 1px solid rgba(99, 102, 241, 0.15);\n    box-shadow: \n        0 4px 16px rgba(99, 102, 241, 0.1),\n        inset 0 1px 1px rgba(255, 255, 255, 0.5);\n    backdrop-filter: blur(10px);\n}\n\n.fc-button {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;\n    border: none !important;\n    padding: 0.7rem 1.3rem !important;\n    border-radius: 12px !important;\n    font-weight: 700 !important;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;\n    text-transform: capitalize !important;\n    box-shadow: \n        0 4px 12px rgba(99, 102, 241, 0.3),\n        inset 0 1px 1px rgba(255, 255, 255, 0.2) !important;\n    color: white !important;\n    position: relative;\n    overflow: hidden;\n}\n\n.fc-button::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);\n    transition: left 0.5s;\n}\n\n.fc-button:hover::before {\n    left: 100%;\n}\n\n.fc-button:hover {\n    background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%) !important;\n    transform: translateY(-3px) scale(1.05) !important;\n    box-shadow: \n        0 6px 20px rgba(99, 102, 241, 0.5),\n        0 0 30px rgba(99, 102, 241, 0.3),\n        inset 0 1px 1px rgba(255, 255, 255, 0.3) !important;\n}\n\n.fc-button:active {\n    transform: translateY(0) !important;\n}\n\n.fc-button-primary:not(:disabled):active,\n.fc-button-primary:not(:disabled).fc-button-active {\n    background: var(--primary-dark) !important;\n    box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3) !important;\n}\n\n.fc-button:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n}\n\n.fc-toolbar-title {\n    font-size: 1.75rem !important;\n    font-weight: 800 !important;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    -webkit-background-clip: text !important;\n    -webkit-text-fill-color: transparent !important;\n    background-clip: text !important;\n    filter: drop-shadow(0 2px 4px rgba(99, 102, 241, 0.2));\n}\n\n.fc-daygrid-day {\n    background: white;\n    border: 1px solid #e2e8f0;\n    transition: all 0.2s ease;\n}\n\n.fc-daygrid-day:hover {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.12) 0%, rgba(168, 85, 247, 0.08) 100%) !important;\n    transform: scale(1.02);\n    box-shadow: 0 2px 8px rgba(99, 102, 241, 0.15);\n}\n\n.fc-day-today {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.18) 0%, rgba(168, 85, 247, 0.12) 50%, rgba(236, 72, 153, 0.1) 100%) !important;\n    border: 2px solid var(--primary) !important;\n    box-shadow: \n        inset 0 0 20px rgba(99, 102, 241, 0.15),\n        0 0 20px rgba(99, 102, 241, 0.1);\n    position: relative;\n}\n\n.fc-day-today::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: linear-gradient(135deg, transparent 0%, rgba(99, 102, 241, 0.05) 100%);\n    animation: todayPulse 3s ease-in-out infinite;\n}\n\n@keyframes todayPulse {\n    0%, 100% { opacity: 0.5; }\n    50% { opacity: 1; }\n}\n\n.fc-daygrid-day-number {\n    padding: 0.5rem;\n    font-weight: 700;\n    color: var(--dark);\n    transition: all 0.3s;\n}\n\n.fc-day-today .fc-daygrid-day-number {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    border-radius: 50%;\n    width: 2.5rem;\n    height: 2.5rem;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: 800;\n    box-shadow: \n        0 4px 12px rgba(99, 102, 241, 0.4),\n        0 0 20px rgba(99, 102, 241, 0.3);\n    animation: todayNumberPulse 2s ease-in-out infinite;\n}\n\n@keyframes todayNumberPulse {\n    0%, 100% { transform: scale(1); box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4), 0 0 20px rgba(99, 102, 241, 0.3); }\n    50% { transform: scale(1.1); box-shadow: 0 6px 16px rgba(99, 102, 241, 0.6), 0 0 30px rgba(99, 102, 241, 0.5); }\n}\n\n.fc-event {\n    border-radius: 10px !important;\n    padding: 8px 12px !important;\n    cursor: pointer !important;\n    border: none !important;\n    font-size: 0.9rem !important;\n    font-weight: 700 !important;\n    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) !important;\n    box-shadow: \n        0 4px 12px rgba(0, 0, 0, 0.25),\n        0 2px 4px rgba(0, 0, 0, 0.15),\n        inset 0 1px 1px rgba(255, 255, 255, 0.3) !important;\n    margin: 4px 3px !important;\n    backdrop-filter: blur(8px);\n    position: relative;\n    overflow: hidden;\n    background-image: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, transparent 100%) !important;\n}\n\n.fc-event::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, transparent 50%);\n    opacity: 0;\n    transition: opacity 0.3s;\n}\n\n.fc-event::after {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);\n    transition: left 0.6s;\n}\n\n.fc-event:hover {\n    transform: translateY(-4px) scale(1.05) !important;\n    box-shadow: \n        0 12px 28px rgba(0, 0, 0, 0.35),\n        0 4px 8px rgba(0, 0, 0, 0.2),\n        0 0 40px rgba(99, 102, 241, 0.3),\n        inset 0 1px 1px rgba(255, 255, 255, 0.5) !important;\n    z-index: 10 !important;\n}\n\n.fc-event:hover::before {\n    opacity: 1;\n}\n\n.fc-event:hover::after {\n    left: 100%;\n}\n\n.fc-event:active {\n    transform: translateY(-1px) scale(1.01) !important;\n}\n\n.fc-event-title {\n    font-weight: 600;\n    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);\n}\n\n.fc-event-title {\n    font-weight: 600;\n}\n\n.fc-daygrid-event {\n    margin: 2px 4px !important;\n}\n\n.fc-timegrid-slot {\n    border-color: #e2e8f0;\n}\n\n.fc-timegrid-col {\n    border-color: #e2e8f0;\n}\n\n.fc-col-header-cell {\n    background: rgba(99, 102, 241, 0.05);\n    padding: 0.75rem 0;\n    font-weight: 600;\n    color: var(--dark);\n    border-color: #e2e8f0;\n}\n\n.fc-scrollgrid {\n    border-radius: 10px;\n    overflow: hidden;\n}\n\n.fc-daygrid-event-dot {\n    display: none;\n}\n\n/* Dark mode support */\n[data-theme=\"dark\"] .fc {\n    color: #f8fafc;\n}\n\n[data-theme=\"dark\"] .fc-daygrid-day {\n    background: #1e293b !important;\n    border-color: #334155 !important;\n}\n\n[data-theme=\"dark\"] .fc-daygrid-day:hover {\n    background: rgba(99, 102, 241, 0.15) !important;\n}\n\n[data-theme=\"dark\"] .fc-day-today {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.25) 0%, rgba(236, 72, 153, 0.15) 100%) !important;\n    border: 2px solid var(--primary) !important;\n}\n\n[data-theme=\"dark\"] .fc-day-today .fc-daygrid-day-number {\n    background: var(--primary) !important;\n    color: white !important;\n}\n\n[data-theme=\"dark\"] .fc-daygrid-day-number {\n    color: #f8fafc !important;\n}\n\n[data-theme=\"dark\"] .fc-toolbar-title {\n    color: #f8fafc !important;\n}\n\n[data-theme=\"dark\"] .fc-col-header-cell {\n    background: #334155 !important;\n    color: #f8fafc !important;\n    border-color: #475569 !important;\n}\n\n[data-theme=\"dark\"] .fc-header-toolbar {\n    background: rgba(99, 102, 241, 0.15) !important;\n    border-color: rgba(99, 102, 241, 0.3) !important;\n}\n\n[data-theme=\"dark\"] .fc-timegrid-slot,\n[data-theme=\"dark\"] .fc-timegrid-col {\n    border-color: #475569 !important;\n}\n\n[data-theme=\"dark\"] .fc-timegrid-slot-label {\n    color: #cbd5e1 !important;\n}\n\n[data-theme=\"dark\"] .fc-timegrid-axis {\n    color: #cbd5e1 !important;\n    border-color: #475569 !important;\n}\n\n[data-theme=\"dark\"] .fc-list-day-cushion {\n    background: #334155 !important;\n    color: #f8fafc !important;\n}\n\n[data-theme=\"dark\"] .fc-list-event {\n    background: #1e293b !important;\n    border-color: #334155 !important;\n}\n\n[data-theme=\"dark\"] .fc-list-event:hover {\n    background: rgba(99, 102, 241, 0.1) !important;\n}\n\n[data-theme=\"dark\"] .fc-scrollgrid {\n    border-color: #475569 !important;\n}\n\n/* Calendar wrapper dark mode */\n[data-theme=\"dark\"] #calendar-wrapper {\n    background: #1e293b !important;\n    border: 1px solid #334155;\n}\n\n/* Mobile responsive */\n@media (max-width: 768px) {\n    .fc-header-toolbar {\n        flex-direction: column;\n        gap: 1rem;\n        padding: 1rem !important;\n    }\n    \n    .fc-toolbar-chunk {\n        display: flex;\n        justify-content: center;\n        width: 100%;\n        flex-wrap: wrap;\n    }\n    \n    .fc-button {\n        padding: 0.4rem 0.8rem !important;\n        font-size: 0.85rem !important;\n    }\n    \n    .fc-toolbar-title {\n        font-size: 1.2rem !important;\n    }\n    \n    #calendar-wrapper {\n        padding: 1rem !important;\n    }\n}\n\n/* Additional smooth transitions */\n.fc-scrollgrid-section {\n    transition: background-color 0.3s ease;\n}\n\n.fc-daygrid-day-frame {\n    transition: all 0.2s ease;\n}\n\n/* Loading state */\n.fc-loading {\n    opacity: 0.6;\n}\n\n","size_bytes":9180},"replit.md":{"content":"# Travel Planner AI Agent\n\n## Overview\n\nAn autonomous AI-powered travel planning application that processes natural language queries to create complete travel itineraries. The system uses LangGraph's ReAct (Reasoning + Acting) agent framework to orchestrate multiple specialized tools, enabling the AI to autonomously chain actions like searching flights, finding hotels, checking weather, and generating day-by-day itineraries. Built with FastAPI for the backend and vanilla JavaScript for the frontend, it provides a simple yet powerful interface for intelligent travel planning.\n\n**NEW: Complete Booking System** - Now includes secure Stripe payment integration, allowing users to book and pay for trips directly through the platform with full booking management and payment confirmation.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## Recent Updates (November 8, 2025)\n\n### Major UI Enhancements\n- **Multi-page Design**: Transformed single-page app into modern multi-page experience (Home, Plan Trip, My Trips, Preferences)\n- **Stunning Animations**: Added pulse, bounce, shimmer, floating, and modal animations\n- **Eye-catching Gradients**: Beautiful gradient backgrounds throughout the app\n- **Responsive Modals**: Backdrop blur, smooth transitions, and mobile-optimized designs\n\n### Booking System Implementation\n- **Secure Payment Processing**: Full Stripe Checkout integration\n- **Server-side Pricing**: All prices validated server-side to prevent manipulation\n- **Booking Management**: Create, view, confirm, and cancel bookings\n- **Payment Flow**: Complete checkout → payment → confirmation flow\n- **Real-time Updates**: Dynamic booking status and payment tracking\n\n## System Architecture\n\n### Application Architecture\n**Pattern**: Monolithic backend with embedded static frontend\n\n**Backend**: FastAPI REST API server\n- Exposes `/api/plan` endpoint for travel query processing\n- Serves static files directly (no separate frontend server)\n- Async request handling for better concurrency\n- Automatic API documentation via FastAPI\n\n**Frontend**: Vanilla JavaScript single-page application\n- No framework dependencies (React, Vue, etc.)\n- Direct DOM manipulation for UI updates\n- Simple HTTP requests to backend API\n- Eliminates build tooling and transpilation\n\n**Rationale**: This architecture minimizes deployment complexity by bundling everything into a single Python application. FastAPI provides modern async capabilities while vanilla JS keeps the frontend lightweight and eliminates the need for Node.js, webpack, or other build tools.\n\n### AI Agent Architecture\n**Framework**: LangGraph with ReAct pattern\n\n**Core Components**:\n- **Agent Type**: `create_react_agent` - autonomous planning agent that reasons about which actions to take\n- **LLM Provider**: OpenAI GPT-4o (referenced in code comments, though implementation may support multiple providers)\n- **Reasoning Loop**: LLM analyzes user query → decides which tool to invoke → executes tool → evaluates result → repeats until complete\n- **Memory**: ChatMessageHistory maintains conversation context across multiple interactions within a session\n\n**Rationale**: The ReAct pattern enables true autonomous behavior where the LLM doesn't just respond but actively decides which tools to use and in what sequence. This allows complex multi-step planning like \"search flights, then find hotels near the airport, then check weather, then create a daily itinerary\" from a single user query. LangGraph provides the state machine to orchestrate this reasoning loop reliably.\n\n### Tool System\n**Pattern**: Decorator-based tool registry with Pydantic type validation\n\n**Architecture**:\n- **Registration**: LangChain `@tool` decorator converts Python functions into agent-callable tools\n- **Type Safety**: Pydantic models validate all tool parameters\n- **Modularity**: Each tool has single responsibility and clear input/output contract\n\n**Available Tools** (8 total):\n1. `search_flights` - Flight search with pricing, schedules, and airline information\n2. `search_hotels` - Accommodation discovery with ratings and amenities\n3. `get_weather_forecast` - Weather data retrieval for trip planning\n4. `search_activities` - Local attractions, experiences, and points of interest\n5. `calculate_trip_budget` - Cost estimation across all travel components\n6. `save_user_preferences` - Persist user preferences (budget, interests, travel style)\n7. `get_user_preferences` - Retrieve stored user preferences\n8. `create_day_by_day_itinerary` - Generate structured daily schedules\n\n**Rationale**: Modular tool design allows the agent to compose complex travel plans from simple, testable building blocks. Each tool handles one aspect of travel planning, making the system maintainable and extensible. The decorator pattern provides clean separation between business logic and agent integration.\n\n### State Management\n**Pattern**: Hybrid storage - ephemeral conversation memory + global preference store\n\n**Conversation State**:\n- **Storage**: ChatMessageHistory (in-memory, per-session)\n- **Lifecycle**: Persists only during active user session\n- **Contents**: User queries and AI responses for context-aware conversations\n\n**User Preferences**:\n- **Storage**: Global dictionary `user_preferences_store` (in-memory)\n- **Persistence**: Survives across sessions but resets on server restart\n- **Access**: Via `save_user_preferences` and `get_user_preferences` tools\n\n**Rationale**: Conversation memory is intentionally ephemeral since each planning session is typically independent. User preferences use a simple global store to demonstrate the concept without database complexity. In production, this would be replaced with persistent storage (database).\n\n**Production Consideration**: The current in-memory preference store will lose data on server restart. For production deployment, this should be replaced with a database (PostgreSQL, MongoDB, etc.) or file-based persistence.\n\n### Data Flow\n**Request Lifecycle**:\n1. User submits natural language query via frontend\n2. POST request to `/api/plan` endpoint\n3. TravelPlannerAgent receives query and initializes ReAct loop\n4. Agent invokes tools autonomously based on LLM reasoning\n5. Tools return mock or real data (depending on integration)\n6. Agent synthesizes final travel plan\n7. Response returned to frontend for display\n\n**Tool Invocation Pattern**:\n- LLM analyzes query and generates tool calls with parameters\n- LangGraph executor runs tool functions\n- Tool results fed back to LLM for next reasoning step\n- Process continues until agent determines plan is complete\n\n## External Dependencies\n\n### AI/ML Services\n**LangChain & LangGraph**:\n- Core framework for agent orchestration and tool management\n- Provides ReAct agent implementation and state machine\n- Handles LLM provider abstraction\n\n**Groq API**:\n- Primary LLM provider (Llama 3.3 70B Versatile model)\n- Ultra-fast inference speed on Groq's LPU architecture\n- Used for natural language understanding and reasoning\n- Generates tool invocations and synthesizes final responses\n- Configured via GROQ_API_KEY environment variable\n\n### Backend Framework\n**FastAPI**:\n- REST API server with automatic OpenAPI documentation\n- Async request handling\n- Static file serving\n- Pydantic integration for request/response validation\n\n**Uvicorn**:\n- ASGI server for running FastAPI application\n- Production-ready HTTP server\n\n### Data Validation\n**Pydantic**:\n- Request/response model validation\n- Tool parameter type checking\n- Data serialization/deserialization\n\n### External APIs (Mocked)\n**Current Status**: All tools return mock data\n\n**Production Integration Points**:\n- Flight search APIs (e.g., Amadeus, Skyscanner)\n- Hotel booking APIs (e.g., Booking.com, Expedia)\n- Weather services (e.g., OpenWeatherMap, Weather.com)\n- Activity/attraction databases (e.g., Google Places, TripAdvisor)\n\n**Rationale**: Mock data allows development and testing without API costs or rate limits. The tool interface is designed to easily swap mock implementations for real API integrations.\n\n### Database (Future)\n**Current**: In-memory dictionaries for user preferences\n**Recommended**: PostgreSQL or MongoDB for production\n- User preference persistence\n- Conversation history archival\n- Trip plan storage","size_bytes":8296},"static/app.js":{"content":"let currentPage = 'home';\nlet selectedFlight = null;\nlet selectedHotel = null;\nlet bookingTripDetails = null;\n\n// ========== THEME MANAGEMENT ==========\nfunction initTheme() {\n    const savedTheme = localStorage.getItem('theme') || 'light';\n    applyTheme(savedTheme);\n}\n\nfunction toggleTheme() {\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';\n    const newTheme = currentTheme === 'light' ? 'dark' : 'light';\n    applyTheme(newTheme);\n}\n\nfunction applyTheme(theme) {\n    document.documentElement.setAttribute('data-theme', theme);\n    localStorage.setItem('theme', theme);\n    \n    const themeIcon = document.getElementById('theme-icon');\n    if (themeIcon) {\n        themeIcon.textContent = theme === 'dark' ? '☀️' : '🌙';\n    }\n    \n    // Add smooth transition\n    document.body.style.transition = 'background-color 0.3s ease, color 0.3s ease';\n}\n\nfunction navigateTo(page) {\n    // Add fade out animation\n    const currentActivePage = document.querySelector('.page.active');\n    if (currentActivePage) {\n        currentActivePage.style.animation = 'fadeOut 0.3s ease-out';\n        setTimeout(() => {\n            currentActivePage.classList.remove('active');\n            currentActivePage.style.animation = '';\n        }, 300);\n    }\n    \n    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));\n    \n    const pageElement = document.getElementById(`${page}-page`);\n    if (pageElement) {\n        setTimeout(() => {\n            pageElement.classList.add('active');\n            currentPage = page;\n            \n            const navLink = document.querySelector(`[data-page=\"${page}\"]`);\n            if (navLink) {\n                navLink.classList.add('active');\n            }\n            \n            window.scrollTo({ top: 0, behavior: 'smooth' });\n            \n            if (page === 'preferences') {\n                loadPreferences();\n            } else if (page === 'trips') {\n                loadMyTrips();\n            } else if (page === 'calendar') {\n                loadCalendar();\n            } else if (page === 'plan') {\n                // Show welcome message if chat is empty\n                setTimeout(() => showWelcomeMessage(), 100);\n            } else if (page === 'booking') {\n                // Show price summary footer on booking page\n                const footer = document.getElementById(\"price-summary-footer\");\n                if (footer) {\n                    footer.style.display = \"block\";\n                }\n                if (!bookingTripDetails) {\n                    // If booking page opened without trip details, try to load from chat\n                    openBookingPageFromChat();\n                }\n            } else {\n                // Hide price summary footer on other pages\n                const footer = document.getElementById(\"price-summary-footer\");\n                if (footer) {\n                    footer.style.display = \"none\";\n                }\n            }\n        }, currentActivePage ? 300 : 0);\n    }\n}\n\n// Add fadeOut animation\nconst style = document.createElement('style');\nstyle.textContent = `\n    @keyframes fadeOut {\n        from {\n            opacity: 1;\n            transform: translateY(0);\n        }\n        to {\n            opacity: 0;\n            transform: translateY(-20px);\n        }\n    }\n`;\ndocument.head.appendChild(style);\n\nwindow.addEventListener('scroll', () => {\n    const navbar = document.querySelector('.navbar');\n    if (window.scrollY > 50) {\n        navbar.classList.add('scrolled');\n    } else {\n        navbar.classList.remove('scrolled');\n    }\n});\n\nfunction showWelcomeMessage() {\n    const messagesDiv = document.getElementById('chat-messages');\n    if (!messagesDiv || messagesDiv.children.length > 0) return;\n    \n    messagesDiv.innerHTML = `\n        <div class=\"welcome-message\">\n            <svg width=\"80\" height=\"80\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" style=\"margin-bottom: 1.5rem;\">\n                <path d=\"M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z\" fill=\"url(#gradient)\"/>\n                <defs>\n                    <linearGradient id=\"gradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n                        <stop offset=\"0%\" style=\"stop-color:#667eea;stop-opacity:1\" />\n                        <stop offset=\"50%\" style=\"stop-color:#764ba2;stop-opacity:1\" />\n                        <stop offset=\"100%\" style=\"stop-color:#f093fb;stop-opacity:1\" />\n                    </linearGradient>\n                </defs>\n            </svg>\n            <h2>Ready to Plan Your Dream Trip?</h2>\n            <p>Tell me where you want to go, your budget, and dates. I'll handle everything from flights to accommodations to daily activities!</p>\n            <div style=\"display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; margin-top: 2rem;\">\n                <div style=\"text-align: center; padding: 1rem; background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(168, 85, 247, 0.1) 100%); border-radius: 12px; max-width: 200px;\">\n                    <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path d=\"M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z\" fill=\"url(#icon-grad)\"/>\n                        <defs><linearGradient id=\"icon-grad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\"><stop offset=\"0%\" style=\"stop-color:#667eea\" /><stop offset=\"100%\" style=\"stop-color:#764ba2\" /></linearGradient></defs>\n                    </svg>\n                    <div style=\"margin-top: 0.5rem; font-weight: 600; color: var(--primary);\">Smart Scheduling</div>\n                </div>\n                <div style=\"text-align: center; padding: 1rem; background: linear-gradient(135deg, rgba(168, 85, 247, 0.1) 0%, rgba(236, 72, 153, 0.1) 100%); border-radius: 12px; max-width: 200px;\">\n                    <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path d=\"M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z\" fill=\"url(#budget-grad)\"/>\n                        <defs><linearGradient id=\"budget-grad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\"><stop offset=\"0%\" style=\"stop-color:#764ba2\" /><stop offset=\"100%\" style=\"stop-color:#f093fb\" /></linearGradient></defs>\n                    </svg>\n                    <div style=\"margin-top: 0.5rem; font-weight: 600; color: #a855f7;\">Budget Friendly</div>\n                </div>\n                <div style=\"text-align: center; padding: 1rem; background: linear-gradient(135deg, rgba(236, 72, 153, 0.1) 0%, rgba(99, 102, 241, 0.1) 100%); border-radius: 12px; max-width: 200px;\">\n                    <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path d=\"M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20v6z\" fill=\"url(#activity-grad)\"/>\n                        <defs><linearGradient id=\"activity-grad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\"><stop offset=\"0%\" style=\"stop-color:#ec4899\" /><stop offset=\"100%\" style=\"stop-color:#667eea\" /></linearGradient></defs>\n                    </svg>\n                    <div style=\"margin-top: 0.5rem; font-weight: 600; color: #ec4899;\">Personalized</div>\n                </div>\n            </div>\n        </div>\n    `;\n}\n\nfunction addMessage(role, content, isTyping = false, animate = true) {\n    const messagesDiv = document.getElementById('chat-messages');\n    const messageDiv = document.createElement('div');\n    messageDiv.className = `message ${role}`;\n    messageDiv.style.opacity = '0';\n    messageDiv.style.transform = 'translateY(20px) scale(0.95)';\n    \n    if (isTyping) {\n        messageDiv.innerHTML = `\n            <div class=\"message-content typing-indicator\">\n                <span></span>\n                <span></span>\n                <span></span>\n            </div>\n        `;\n    } else {\n        messageDiv.innerHTML = `\n            <div class=\"message-content\">\n                ${formatMessage(content)}\n            </div>\n        `;\n    }\n    \n    messagesDiv.appendChild(messageDiv);\n    messagesDiv.scrollTop = messagesDiv.scrollHeight;\n    \n    // Enhanced entrance animation with spring effect\n    if (animate) {\n        setTimeout(() => {\n            messageDiv.style.transition = 'all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)';\n            messageDiv.style.opacity = '1';\n            messageDiv.style.transform = 'translateY(0) scale(1)';\n        }, 10);\n    } else {\n        messageDiv.style.opacity = '1';\n        messageDiv.style.transform = 'translateY(0) scale(1)';\n    }\n    \n    // Add shimmer effect for AI messages\n    if (role === 'assistant' && !isTyping) {\n        setTimeout(() => {\n            messageDiv.classList.add('message-highlight');\n            setTimeout(() => {\n                messageDiv.classList.remove('message-highlight');\n            }, 1000);\n        }, 200);\n    }\n}\n\nfunction formatMessage(content) {\n    // Convert markdown-style formatting\n    content = content.replace(/\\n/g, '<br>');\n    content = content.replace(/```json\\n([\\s\\S]*?)\\n```/g, '<pre><code>$1</code></pre>');\n    content = content.replace(/```([\\s\\S]*?)```/g, '<pre><code>$1</code></pre>');\n    content = content.replace(/(https?:\\/\\/[^\\s]+)/g, '<a href=\"$1\" target=\"_blank\">$1</a>');\n    \n    // Handle inline buttons\n    content = content.replace(/<button class=\"btn-inline\"/g, '<button class=\"btn-inline\" style=\"margin: 0.5rem 0; padding: 0.5rem 1rem; background: var(--primary); color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 0.9rem;\"');\n    \n    // Format code blocks\n    content = content.replace(/<code>([^<]+)<\\/code>/g, '<code style=\"background: rgba(0,0,0,0.1); padding: 0.2rem 0.4rem; border-radius: 4px; font-family: monospace;\">$1</code>');\n    \n    return content;\n}\n\nasync function sendMessage() {\n    const input = document.getElementById('chat-input');\n    const sendBtn = document.getElementById('send-btn');\n    const message = input.value.trim();\n    \n    if (!message) return;\n    \n    addMessage('user', message);\n    input.value = '';\n    \n    // Add typing indicator\n    const typingId = Date.now();\n    addMessage('assistant', '', true);\n    \n    sendBtn.disabled = true;\n    sendBtn.classList.add('spinning');\n    sendBtn.innerHTML = '<span class=\"loading-spinner\"></span> Planning...';\n    \n    try {\n        const response = await fetch('/api/plan', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({ query: message })\n        });\n        \n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        \n        const data = await response.json();\n        \n        if (data.status === 'success') {\n            let responseText = data.response || '';\n            \n            // Check if response contains booking information\n            const bookingMatch = responseText.match(/booking[_\\s]?id[:\\s]+([A-Z0-9]+)/i);\n            if (bookingMatch) {\n                const bookingId = bookingMatch[1];\n                responseText += `\\n\\n💳 <strong>Booking Created!</strong> Your booking ID is: <code>${bookingId}</code>\\n\\nWould you like to proceed to payment? <button class=\"btn-inline\" onclick=\"navigateTo('trips'); setTimeout(() => loadMyTrips(), 500);\">View My Bookings</button>`;\n            }\n            \n            // Check for booking data in JSON format\n            try {\n                const jsonMatch = responseText.match(/\\{[\\s\\S]*\"booking_id\"[\\s\\S]*\\}/);\n                if (jsonMatch) {\n                    const bookingInfo = JSON.parse(jsonMatch[0]);\n                    if (bookingInfo.booking_id) {\n                        responseText = responseText.replace(jsonMatch[0], '');\n                        responseText += `\\n\\n💳 <strong>Booking Created!</strong> Your booking ID is: <code>${bookingInfo.booking_id}</code>\\n\\n<button class=\"btn-inline\" onclick=\"navigateTo('trips'); setTimeout(() => loadMyTrips(), 500);\">View My Bookings</button>`;\n                    }\n                }\n            } catch (e) {\n                // Not JSON, continue\n            }\n            \n            // Remove typing indicator\n            const messagesDiv = document.getElementById('chat-messages');\n            const typingIndicator = messagesDiv.querySelector('.typing-indicator');\n            if (typingIndicator) {\n                typingIndicator.closest('.message').remove();\n            }\n            \n            addMessage('assistant', responseText);\n            \n            // Auto-extract and create booking if user wants to book\n            const lowerMessage = message.toLowerCase();\n            if (lowerMessage.includes('book') || lowerMessage.includes('reserve') || lowerMessage.includes('i want to book')) {\n                setTimeout(() => {\n                    extractAndCreateBooking(responseText, message);\n                }, 500);\n            }\n        } else {\n            // Remove typing indicator\n            const messagesDiv = document.getElementById('chat-messages');\n            const typingIndicator = messagesDiv.querySelector('.typing-indicator');\n            if (typingIndicator) {\n                typingIndicator.closest('.message').remove();\n            }\n            \n            const errorMsg = data.error || 'Something went wrong';\n            addMessage('assistant', '❌ Error: ' + errorMsg);\n        }\n    } catch (error) {\n        console.error('Chat error:', error);\n        \n        // Remove typing indicator\n        const messagesDiv = document.getElementById('chat-messages');\n        const typingIndicator = messagesDiv.querySelector('.typing-indicator');\n        if (typingIndicator) {\n            typingIndicator.closest('.message').remove();\n        }\n        \n        addMessage('assistant', '❌ Error connecting to server: ' + error.message + '\\n\\nPlease check if the server is running and try again.');\n    } finally {\n        sendBtn.disabled = false;\n        sendBtn.classList.remove('spinning');\n        sendBtn.innerHTML = '✈️ Send';\n    }\n}\n\nasync function extractAndCreateBooking(aiResponse, userMessage) {\n    // Try to extract booking details from AI response\n    try {\n        // Look for structured data in the response\n        const destinationMatch = aiResponse.match(/destination[:\\s]+([^\\n,]+)/i) || \n                                 userMessage.match(/(?:to|in|visit|going to)\\s+([A-Z][a-z]+(?:\\s+[A-Z][a-z]+)*)/i) ||\n                                 aiResponse.match(/(?:trip to|visit|going to)\\s+([A-Z][a-z]+(?:\\s+[A-Z][a-z]+)*)/i);\n        const dateMatch = aiResponse.match(/(\\d{4}-\\d{2}-\\d{2})/g) || userMessage.match(/(\\d{4}-\\d{2}-\\d{2})/g);\n        const passengerMatch = aiResponse.match(/(\\d+)\\s*(?:passenger|person|people|guest)/i) || \n                              userMessage.match(/(\\d+)\\s*(?:passenger|person|people|guest)/i) ||\n                              userMessage.match(/(?:for|with)\\s+(\\d+)/i);\n        const priceMatch = aiResponse.match(/\\$(\\d+(?:\\.\\d{2})?)/g);\n        \n        if (destinationMatch) {\n            const destination = destinationMatch[1].trim().replace(/[^\\w\\s-]/g, '');\n            const startDate = dateMatch && dateMatch.length >= 1 ? dateMatch[0] : new Date().toISOString().split('T')[0];\n            const endDate = dateMatch && dateMatch.length >= 2 ? dateMatch[1] : \n                           dateMatch && dateMatch.length >= 1 ? dateMatch[0] : \n                           new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];\n            const passengers = passengerMatch ? parseInt(passengerMatch[1]) : 1;\n            const basePrice = priceMatch && priceMatch.length > 0 ? \n                            parseFloat(priceMatch[priceMatch.length - 1].replace('$', '')) / passengers : 200.0;\n            \n            // Show booking option\n            setTimeout(() => {\n                const bookingPrompt = `Would you like me to create a booking for:\\n\\n📍 Destination: ${destination}\\n📅 Dates: ${startDate} to ${endDate}\\n👥 Passengers: ${passengers}\\n💰 Estimated Price: $${(basePrice * passengers).toFixed(2)}\\n\\n<button class=\"btn-inline\" onclick=\"createBookingFromChat('${destination}', '${startDate}', '${endDate}', ${passengers}, ${basePrice})\">Yes, Create Booking</button>`;\n                addMessage('assistant', bookingPrompt);\n            }, 1000);\n        }\n    } catch (error) {\n        console.error('Error extracting booking details:', error);\n    }\n}\n\nasync function createBookingFromChat(destination, startDate, endDate, passengers, basePrice) {\n    try {\n        const tripName = `Trip to ${destination}`;\n        const tripId = `chat-booking-${destination.toLowerCase().replace(/\\s+/g, '-')}`;\n        \n        const response = await fetch('/api/bookings', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n                trip_id: tripId,\n                trip_name: tripName,\n                destination: destination,\n                start_date: startDate,\n                end_date: endDate,\n                total_price: basePrice * passengers,\n                passengers: passengers,\n                flight_details: {},\n                hotel_details: {}\n            })\n        });\n        \n        const data = await response.json();\n        \n        if (data.status === 'success') {\n            addMessage('assistant', `✅ Booking created successfully! Booking ID: <strong>${data.booking_id}</strong>\\n\\nYou can now proceed to payment from the \"My Trips\" page.`);\n            setTimeout(() => {\n                navigateTo('trips');\n                loadMyTrips();\n            }, 2000);\n        } else {\n            addMessage('assistant', '❌ Error creating booking: ' + (data.error || 'Unknown error'));\n        }\n    } catch (error) {\n        addMessage('assistant', '❌ Error creating booking: ' + error.message);\n    }\n}\n\nasync function clearChat() {\n    if (confirm('Clear conversation history?')) {\n        const messagesDiv = document.getElementById('chat-messages');\n        messagesDiv.innerHTML = '';\n        \n        try {\n            await fetch('/api/reset', { method: 'POST' });\n        } catch (error) {\n            console.error('Error resetting memory:', error);\n        }\n        \n        addMessage('assistant', \n            '👋 Chat cleared! Ready to help you plan your next adventure. Where would you like to go? 🌍'\n        );\n    }\n}\n\nfunction setQuickExample(text) {\n    document.getElementById('chat-input').value = text;\n    navigateTo('plan');\n    setTimeout(() => {\n        document.getElementById('chat-input').focus();\n    }, 100);\n}\n\nasync function loadPreferences() {\n    try {\n        const response = await fetch('/api/preferences');\n        const data = await response.json();\n        \n        const prefsDiv = document.getElementById('saved-preferences');\n        if (data.preferences && Object.keys(data.preferences).length > 0) {\n            let html = '<div class=\"preferences-card\"><h3>Your Saved Preferences</h3>';\n            for (const [key, value] of Object.entries(data.preferences)) {\n                html += `<p><strong>${key}:</strong> ${JSON.stringify(value)}</p>`;\n            }\n            html += '</div>';\n            prefsDiv.innerHTML = html;\n        } else {\n            prefsDiv.innerHTML = '<div class=\"preferences-card\"><p>No preferences saved yet. Chat with the AI to save your preferences!</p></div>';\n        }\n    } catch (error) {\n        console.error('Error loading preferences:', error);\n    }\n}\n\nasync function savePreferencesForm() {\n    const budget = document.getElementById('pref-budget').value;\n    const style = document.getElementById('pref-style').value;\n    const activities = document.getElementById('pref-activities').value;\n    \n    const message = `Save my preferences: budget style is ${budget}, I prefer ${style} accommodations, and I enjoy ${activities}`;\n    \n    navigateTo('plan');\n    document.getElementById('chat-input').value = message;\n    await sendMessage();\n}\n\nasync function openBookingModal(tripId, tripName, destination, startDate, endDate, price) {\n    const modal = document.getElementById('booking-modal');\n    const modalBody = document.querySelector('#booking-modal .modal-body');\n    \n    const tripImages = {\n        'goa-beach': '🏖️',\n        'paris-family': '🗼',\n        'manali-adventure': '⛰️'\n    };\n    \n    const tripIcon = tripImages[tripId] || '✈️';\n    \n    modalBody.innerHTML = `\n        <div class=\"booking-hero\">\n            <div class=\"booking-hero-icon\">${tripIcon}</div>\n            <div class=\"booking-hero-content\">\n                <h3 class=\"booking-destination\">${destination}</h3>\n                <p class=\"booking-subtitle\">${tripName}</p>\n            </div>\n        </div>\n        \n        <div class=\"booking-summary-card\">\n            <div class=\"booking-row\">\n                <div class=\"booking-detail\">\n                    <div class=\"booking-icon\">📅</div>\n                    <div>\n                        <div class=\"detail-label\">Travel Dates</div>\n                        <div class=\"detail-value\">${startDate} to ${endDate}</div>\n                    </div>\n                </div>\n            </div>\n            \n            <div class=\"booking-row\">\n                <div class=\"booking-detail\">\n                    <div class=\"booking-icon\">👥</div>\n                    <div>\n                        <div class=\"detail-label\">Passengers</div>\n                        <div class=\"passenger-controls\">\n                            <button class=\"passenger-btn\" onclick=\"updatePassengers(-1, ${price})\" type=\"button\">\n                                <span>−</span>\n                            </button>\n                            <input type=\"number\" id=\"passengers\" min=\"1\" max=\"10\" value=\"1\" readonly>\n                            <button class=\"passenger-btn\" onclick=\"updatePassengers(1, ${price})\" type=\"button\">\n                                <span>+</span>\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"price-breakdown-card\">\n            <h4 style=\"margin-bottom: 1rem; color: var(--dark); font-size: 1.1rem;\">💰 Price Breakdown</h4>\n            <div class=\"price-row\">\n                <span>Base price per person</span>\n                <span id=\"base-price\">$${price.toFixed(2)}</span>\n            </div>\n            <div class=\"price-row\">\n                <span>Number of passengers</span>\n                <span id=\"passenger-count\">1</span>\n            </div>\n            <div class=\"price-divider\"></div>\n            <div class=\"price-row total-row\">\n                <span><strong>Total Amount</strong></span>\n                <span id=\"total-price\" class=\"total-price\">$${price.toFixed(2)}</span>\n            </div>\n        </div>\n        \n        <div class=\"trust-badges\">\n            <div class=\"trust-badge\">\n                <span>🔒</span>\n                <span>Secure Payment</span>\n            </div>\n            <div class=\"trust-badge\">\n                <span>✓</span>\n                <span>Instant Confirmation</span>\n            </div>\n            <div class=\"trust-badge\">\n                <span>🛡️</span>\n                <span>Protected Booking</span>\n            </div>\n        </div>\n        \n        <div class=\"booking-form\">\n            <div class=\"form-group-modern\">\n                <label class=\"form-label-modern\">\n                    <span class=\"label-icon\">✉️</span>\n                    <span>Contact Email</span>\n                </label>\n                <input type=\"email\" id=\"booking-email\" class=\"form-input-modern\" placeholder=\"your@email.com\" required>\n            </div>\n            \n            <div class=\"form-group-modern\">\n                <label class=\"form-label-modern\">\n                    <span class=\"label-icon\">📝</span>\n                    <span>Special Requests (Optional)</span>\n                </label>\n                <textarea id=\"special-requests\" class=\"form-input-modern\" rows=\"3\" placeholder=\"Dietary restrictions, accessibility needs, room preferences...\"></textarea>\n            </div>\n        </div>\n        \n        <button class=\"btn-booking-cta\" onclick=\"processBooking('${tripId}', '${tripName}', '${destination}', '${startDate}', '${endDate}', ${price})\">\n            <span class=\"cta-text\">Proceed to Secure Payment</span>\n            <span class=\"cta-icon\">💳</span>\n        </button>\n        \n        <div class=\"booking-footer-note\">\n            <p>🔐 Your payment is processed securely through Stripe. You'll be redirected to complete your booking.</p>\n        </div>\n    `;\n    \n    modal.classList.add('active');\n}\n\nfunction updatePassengers(change, basePrice) {\n    const input = document.getElementById('passengers');\n    let current = parseInt(input.value) || 1;\n    current = Math.max(1, Math.min(10, current + change));\n    input.value = current;\n    \n    const total = basePrice * current;\n    document.getElementById('total-price').textContent = `$${total.toFixed(2)}`;\n    document.getElementById('passenger-count').textContent = current;\n    \n    const totalElement = document.getElementById('total-price');\n    totalElement.style.transform = 'scale(1.1)';\n    setTimeout(() => {\n        totalElement.style.transform = 'scale(1)';\n    }, 200);\n}\n\nasync function processBooking(tripId, tripName, destination, startDate, endDate, basePrice) {\n    const email = document.getElementById('booking-email').value;\n    const passengers = parseInt(document.getElementById('passengers').value) || 1;\n    const specialRequests = document.getElementById('special-requests').value;\n    const totalPrice = basePrice * passengers;\n    \n    if (!email) {\n        alert('Please enter your email address');\n        return;\n    }\n    \n    try {\n        const bookingResponse = await fetch('/api/bookings', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n                trip_id: tripId,\n                trip_name: tripName,\n                destination: destination,\n                start_date: startDate,\n                end_date: endDate,\n                total_price: totalPrice,\n                passengers: passengers,\n                flight_details: { email, special_requests: specialRequests },\n                hotel_details: {}\n            })\n        });\n        \n        const bookingData = await bookingResponse.json();\n        \n        if (bookingData.status === 'success') {\n            const paymentResponse = await fetch('/api/create-checkout-session', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                    booking_id: bookingData.booking_id,\n                    amount: totalPrice\n                })\n            });\n            \n            const paymentData = await paymentResponse.json();\n            \n            if (paymentData.status === 'success') {\n                window.location.href = paymentData.checkout_url;\n            } else {\n                alert('Error creating payment session: ' + (paymentData.error || 'Unknown error'));\n            }\n        }\n    } catch (error) {\n        alert('Error processing booking: ' + error.message);\n    }\n}\n\nfunction closeModal(modalId) {\n    const modal = document.getElementById(modalId);\n    modal.classList.remove('active');\n}\n\nlet calendar = null;\nlet currentEditingEvent = null;\n\nasync function loadCalendar() {\n    const calendarEl = document.getElementById('calendar-container');\n    if (!calendarEl) return;\n    \n    // Initialize FullCalendar if not already done\n    if (!calendar) {\n        calendar = new FullCalendar.Calendar(calendarEl, {\n            initialView: 'dayGridMonth',\n            headerToolbar: {\n                left: 'prev,next today',\n                center: 'title',\n                right: ''\n            },\n            editable: true,\n            droppable: false,\n            selectable: true,\n            selectMirror: true,\n            dayMaxEvents: true,\n            weekends: true,\n            navLinks: true,\n            eventClick: function(info) {\n                openEventModalForEdit(info.event);\n            },\n            dateClick: function(info) {\n                openEventModalForDate(info.dateStr);\n            },\n            eventDrop: function(info) {\n                updateEventDates(info.event);\n            },\n            eventResize: function(info) {\n                updateEventDates(info.event);\n            },\n            events: async function(fetchInfo, successCallback, failureCallback) {\n                try {\n                    const response = await fetch(`/api/calendar/events?start=${fetchInfo.startStr}&end=${fetchInfo.endStr}`);\n                    if (!response.ok) {\n                        console.error('HTTP error loading events:', response.status, response.statusText);\n                        failureCallback();\n                        return;\n                    }\n                    const data = await response.json();\n                    console.log('Events loaded:', data);\n                    if (data.status === 'success' && Array.isArray(data.events)) {\n                        console.log(`Loaded ${data.events.length} events`);\n                        successCallback(data.events);\n                    } else {\n                        console.error('Invalid response format:', data);\n                        failureCallback();\n                    }\n                } catch (error) {\n                    console.error('Error loading events:', error);\n                    failureCallback();\n                }\n            },\n            eventContent: function(info) {\n                const event = info.event;\n                const props = event.extendedProps || {};\n                const title = event.title || 'Untitled Event';\n                \n                let icon = '';\n                if (props.is_booking) {\n                    icon = '✈️';\n                } else if (props.event_type === 'reminder') {\n                    icon = '🔔';\n                } else if (props.event_type === 'trip') {\n                    icon = '🗺️';\n                } else if (props.event_type === 'personal') {\n                    icon = '📌';\n                } else {\n                    icon = '📅';\n                }\n                \n                const html = `\n                    <div style=\"\n                        padding: 4px 6px;\n                        font-size: 0.85rem;\n                        font-weight: 600;\n                        white-space: nowrap;\n                        overflow: hidden;\n                        text-overflow: ellipsis;\n                        display: flex;\n                        align-items: center;\n                        gap: 4px;\n                    \">\n                        <span>${icon}</span>\n                        <span>${title}</span>\n                    </div>\n                `;\n                \n                return { html: html };\n            },\n            eventDidMount: function(info) {\n                // Add hover tooltip with description\n                if (info.event.extendedProps && info.event.extendedProps.description) {\n                    info.el.setAttribute('title', info.event.extendedProps.description);\n                }\n            },\n            height: 'auto',\n            contentHeight: 'auto',\n            aspectRatio: 1.8,\n            loading: function(isLoading) {\n                if (isLoading) {\n                    calendarEl.classList.add('loading');\n                } else {\n                    calendarEl.classList.remove('loading');\n                    updateCalendarStats();\n                }\n            }\n        });\n        \n        calendar.render();\n        \n        // Hide loading state after render\n        setTimeout(() => {\n            calendarEl.classList.remove('loading');\n            updateCalendarStats();\n        }, 500);\n    } else {\n        // Refresh events\n        calendar.refetchEvents();\n        setTimeout(() => {\n            calendarEl.classList.remove('loading');\n            updateCalendarStats();\n        }, 500);\n    }\n}\n\n// Switch calendar view\nfunction switchCalendarView(viewName) {\n    if (calendar) {\n        calendar.changeView(viewName);\n        // Update active button\n        document.querySelectorAll('.view-btn').forEach(btn => {\n            btn.classList.remove('active');\n        });\n        const viewMap = {\n            'dayGridMonth': 'month',\n            'timeGridWeek': 'week',\n            'timeGridDay': 'day',\n            'listWeek': 'list'\n        };\n        const activeBtn = document.querySelector(`.view-btn[data-view=\"${viewMap[viewName]}\"]`);\n        if (activeBtn) {\n            activeBtn.classList.add('active');\n        }\n    }\n}\n\n// Go to today\nfunction goToToday() {\n    if (calendar) {\n        calendar.today();\n        calendar.refetchEvents();\n    }\n}\n\n// Update calendar statistics\nasync function updateCalendarStats() {\n    try {\n        const response = await fetch('/api/calendar/events');\n        if (!response.ok) return;\n        \n        const data = await response.json();\n        if (data.status === 'success' && Array.isArray(data.events)) {\n            const events = data.events;\n            const now = new Date();\n            \n            // Total events\n            const totalEl = document.getElementById('total-events-count');\n            if (totalEl) {\n                animateValue(totalEl, 0, events.length, 500);\n            }\n            \n            // Booking events\n            const bookingCount = events.filter(e => e.extendedProps?.is_booking).length;\n            const bookingEl = document.getElementById('booking-events-count');\n            if (bookingEl) {\n                animateValue(bookingEl, 0, bookingCount, 500);\n            }\n            \n            // Upcoming events (within next 7 days)\n            const upcomingCount = events.filter(e => {\n                const startDate = new Date(e.start);\n                return startDate >= now && startDate <= new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000);\n            }).length;\n            const upcomingEl = document.getElementById('upcoming-events-count');\n            if (upcomingEl) {\n                animateValue(upcomingEl, 0, upcomingCount, 500);\n            }\n        }\n    } catch (error) {\n        console.error('Error updating calendar stats:', error);\n    }\n}\n\n// Animate number counter\nfunction animateValue(element, start, end, duration) {\n    let startTimestamp = null;\n    const step = (timestamp) => {\n        if (!startTimestamp) startTimestamp = timestamp;\n        const progress = Math.min((timestamp - startTimestamp) / duration, 1);\n        const current = Math.floor(progress * (end - start) + start);\n        element.textContent = current;\n        if (progress < 1) {\n            window.requestAnimationFrame(step);\n        } else {\n            element.textContent = end;\n        }\n    };\n    window.requestAnimationFrame(step);\n}\n\nfunction openEventModal() {\n    currentEditingEvent = null;\n    document.getElementById('event-modal-title').textContent = '➕ Create New Event';\n    document.getElementById('event-form').reset();\n    document.getElementById('event-all-day').checked = true;\n    document.getElementById('event-time-fields').style.display = 'none';\n    document.getElementById('event-reminder').checked = false;\n    document.getElementById('reminder-options').style.display = 'none';\n    document.getElementById('event-delete-btn').style.display = 'none';\n    document.getElementById('event-color').value = '#6366f1';\n    document.getElementById('event-color-text').value = '#6366f1';\n    \n    // Set default dates to today\n    const today = new Date().toISOString().split('T')[0];\n    document.getElementById('event-start-date').value = today;\n    document.getElementById('event-end-date').value = today;\n    \n    document.getElementById('event-modal').classList.add('active');\n}\n\nfunction openEventModalForDate(dateStr) {\n    openEventModal();\n    document.getElementById('event-start-date').value = dateStr;\n    document.getElementById('event-end-date').value = dateStr;\n}\n\nfunction openEventModalForEdit(event) {\n    currentEditingEvent = event;\n    const props = event.extendedProps;\n    \n    // Only allow editing of manual events, not bookings\n    if (props.is_booking) {\n        alert('This is a booking event. Please edit it from the \"My Trips\" page.');\n        return;\n    }\n    \n    document.getElementById('event-modal-title').textContent = '✏️ Edit Event';\n    document.getElementById('event-title').value = event.title;\n    document.getElementById('event-description').value = event.extendedProps.description || '';\n    \n    const startDate = event.start;\n    const endDate = event.end || event.start;\n    \n    document.getElementById('event-start-date').value = startDate.toISOString().split('T')[0];\n    document.getElementById('event-end-date').value = endDate.toISOString().split('T')[0];\n    \n    const allDay = event.allDay;\n    document.getElementById('event-all-day').checked = allDay;\n    toggleEventTime();\n    \n    if (!allDay && startDate instanceof Date) {\n        const startTime = startDate.toTimeString().slice(0, 5);\n        const endTime = endDate.toTimeString().slice(0, 5);\n        document.getElementById('event-start-time').value = startTime;\n        document.getElementById('event-end-time').value = endTime;\n    }\n    \n    document.getElementById('event-type').value = props.event_type || 'personal';\n    document.getElementById('event-tags').value = (props.tags || []).join(', ');\n    document.getElementById('event-color').value = event.backgroundColor || '#6366f1';\n    document.getElementById('event-color-text').value = event.backgroundColor || '#6366f1';\n    \n    const reminderEnabled = props.reminder_enabled === true || props.reminder_enabled === 'true';\n    document.getElementById('event-reminder').checked = reminderEnabled;\n    if (reminderEnabled) {\n        document.getElementById('reminder-options').style.display = 'block';\n        document.getElementById('event-reminder-time').value = props.reminder_time || '1 day before';\n    }\n    \n    document.getElementById('event-delete-btn').style.display = 'block';\n    document.getElementById('event-modal').classList.add('active');\n}\n\nfunction toggleEventTime() {\n    const allDay = document.getElementById('event-all-day').checked;\n    const timeFields = document.getElementById('event-time-fields');\n    timeFields.style.display = allDay ? 'none' : 'grid';\n}\n\nfunction updateEventColor() {\n    const eventType = document.getElementById('event-type').value;\n    const colorMap = {\n        'personal': '#6366f1',\n        'trip': '#10b981',\n        'booking': '#3b82f6',\n        'reminder': '#f59e0b'\n    };\n    const color = colorMap[eventType] || '#6366f1';\n    document.getElementById('event-color').value = color;\n    document.getElementById('event-color-text').value = color;\n}\n\nasync function saveEvent(e) {\n    e.preventDefault();\n    \n    const title = document.getElementById('event-title').value;\n    const description = document.getElementById('event-description').value;\n    const startDate = document.getElementById('event-start-date').value;\n    const endDate = document.getElementById('event-end-date').value;\n    const allDay = document.getElementById('event-all-day').checked;\n    const startTime = allDay ? null : document.getElementById('event-start-time').value;\n    const endTime = allDay ? null : document.getElementById('event-end-time').value;\n    const eventType = document.getElementById('event-type').value;\n    const tags = document.getElementById('event-tags').value.split(',').map(t => t.trim()).filter(t => t);\n    const color = document.getElementById('event-color-text').value;\n    const reminderEnabled = document.getElementById('event-reminder').checked;\n    const reminderTime = reminderEnabled ? document.getElementById('event-reminder-time').value : null;\n    \n    // Add loading state to save button\n    const saveBtn = document.querySelector('#event-form button[type=\"submit\"]');\n    if (saveBtn) {\n        saveBtn.disabled = true;\n        saveBtn.innerHTML = '⏳ Saving...';\n    }\n    \n    const eventData = {\n        title: title,\n        description: description,\n        start_date: startDate,\n        end_date: endDate,\n        start_time: startTime,\n        end_time: endTime,\n        all_day: allDay ? \"true\" : \"false\",\n        event_type: eventType,\n        tags: tags,\n        color: color,\n        reminder_enabled: reminderEnabled ? \"true\" : \"false\",\n        reminder_time: reminderTime\n    };\n    \n    try {\n        let response;\n        if (currentEditingEvent && currentEditingEvent.extendedProps.database_id) {\n            // Update existing event\n            response = await fetch(`/api/calendar/events/${currentEditingEvent.extendedProps.database_id}`, {\n                method: 'PUT',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify(eventData)\n            });\n        } else {\n            // Create new event\n            response = await fetch('/api/calendar/events', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify(eventData)\n            });\n        }\n        \n        if (!response.ok) {\n            const errorText = await response.text();\n            console.error('HTTP error saving event:', response.status, errorText);\n            let errorData;\n            try {\n                errorData = JSON.parse(errorText);\n            } catch {\n                errorData = { error: errorText || `HTTP ${response.status} error` };\n            }\n            alert('Error saving event: ' + (errorData.error || errorData.detail || `HTTP ${response.status} error`));\n            return;\n        }\n        \n        const data = await response.json();\n        console.log('Event save response:', data);\n        if (data.status === 'success') {\n            showSuccessMessage('✅ Event saved successfully!');\n            closeEventModal();\n            // Force calendar refresh with animation\n            if (calendar) {\n                setTimeout(() => {\n                    calendar.refetchEvents();\n                    updateCalendarStats();\n                    \n                    // Add a subtle flash animation to the calendar\n                    const calendarWrapper = document.querySelector('.calendar-wrapper');\n                    if (calendarWrapper) {\n                        calendarWrapper.style.animation = 'none';\n                        setTimeout(() => {\n                            calendarWrapper.style.animation = 'messageHighlight 0.8s ease-out';\n                        }, 10);\n                    }\n                }, 100);\n            }\n        } else {\n            const errorMsg = data.error || data.detail || 'Unknown error occurred';\n            console.error('Error saving event:', errorMsg, data);\n            alert('Error saving event: ' + errorMsg);\n        }\n    } catch (error) {\n        console.error('Error saving event:', error);\n        alert('Error saving event: ' + (error.message || 'Network error. Please check your connection.'));\n    } finally {\n        // Restore button state\n        const saveBtn = document.querySelector('#event-form button[type=\"submit\"]');\n        if (saveBtn) {\n            saveBtn.disabled = false;\n            saveBtn.innerHTML = '💾 Save Event';\n        }\n    }\n}\n\nasync function deleteEvent() {\n    if (!currentEditingEvent || !currentEditingEvent.extendedProps.database_id) {\n        alert('Cannot delete this event');\n        return;\n    }\n    \n    if (!confirm('Are you sure you want to delete this event?')) {\n        return;\n    }\n    \n    try {\n        const response = await fetch(`/api/calendar/events/${currentEditingEvent.extendedProps.database_id}`, {\n            method: 'DELETE'\n        });\n        \n        const data = await response.json();\n        if (data.status === 'success') {\n            showSuccessMessage('✅ Event deleted successfully!');\n            closeEventModal();\n            if (calendar) {\n                setTimeout(() => {\n                    calendar.refetchEvents();\n                    updateCalendarStats();\n                }, 100);\n            }\n        } else {\n            const errorMsg = data.error || data.detail || 'Unknown error occurred';\n            console.error('Error deleting event:', errorMsg, data);\n            alert('Error deleting event: ' + errorMsg);\n        }\n    } catch (error) {\n        console.error('Error deleting event:', error);\n        alert('Error deleting event: ' + (error.message || 'Network error. Please check your connection.'));\n    }\n}\n\nasync function updateEventDates(event) {\n    // Only update manual events, not bookings\n    if (event.extendedProps.is_booking || !event.extendedProps.database_id) {\n        calendar.refetchEvents(); // Revert the change\n        return;\n    }\n    \n    const start = event.start;\n    const end = event.end || event.start;\n    \n    const eventData = {\n        title: event.title,\n        description: event.extendedProps.description || '',\n        start_date: start.toISOString().split('T')[0],\n        end_date: end.toISOString().split('T')[0],\n        start_time: event.allDay ? null : start.toTimeString().slice(0, 5),\n        end_time: event.allDay ? null : (end.toTimeString().slice(0, 5)),\n        all_day: event.allDay ? \"true\" : \"false\",\n        event_type: event.extendedProps.event_type || 'personal',\n        tags: event.extendedProps.tags || [],\n        color: event.backgroundColor,\n        reminder_enabled: event.extendedProps.reminder_enabled ? \"true\" : \"false\",\n        reminder_time: event.extendedProps.reminder_time\n    };\n    \n    try {\n        const response = await fetch(`/api/calendar/events/${event.extendedProps.database_id}`, {\n            method: 'PUT',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(eventData)\n        });\n        \n        const data = await response.json();\n        if (data.status !== 'success') {\n            calendar.refetchEvents(); // Revert on error\n        }\n    } catch (error) {\n        console.error('Error updating event:', error);\n        calendar.refetchEvents(); // Revert on error\n    }\n}\n\nfunction closeEventModal() {\n    document.getElementById('event-modal').classList.remove('active');\n    currentEditingEvent = null;\n}\n\n// Moved to main DOMContentLoaded listener below\n\nasync function viewItinerary(id) {\n    try {\n        const response = await fetch(`/api/itineraries/${id}`);\n        const data = await response.json();\n        \n        if (data.status === 'success') {\n            const itin = data.itinerary;\n            const passengers = prompt(`Trip: ${itin.trip_name}\\nDestination: ${itin.destination}\\nDates: ${itin.start_date} to ${itin.end_date}\\nDuration: ${itin.duration_days} days\\nBudget: $${itin.budget || 'N/A'}\\n\\n${itin.description || ''}\\n\\nWould you like to book this trip? Enter number of passengers (1-10):`, '1');\n            \n            if (passengers && !isNaN(passengers) && parseInt(passengers) >= 1 && parseInt(passengers) <= 10) {\n                const bookingResponse = await fetch(`/api/bookings/from-itinerary/${id}?passengers=${parseInt(passengers)}`, {\n                    method: 'POST'\n                });\n                \n                const bookingData = await bookingResponse.json();\n                \n                if (bookingData.status === 'success') {\n                    showSuccessMessage(`✅ Booking created! Booking ID: ${bookingData.booking_id}. Redirecting to payment...`);\n                    setTimeout(() => {\n                        navigateTo('trips');\n                        loadMyTrips();\n                    }, 2000);\n                } else {\n                    alert('Error creating booking: ' + (bookingData.error || 'Unknown error'));\n                }\n            }\n        }\n    } catch (error) {\n        alert('Error loading itinerary: ' + error.message);\n    }\n}\n\nasync function bookFromItinerary(id) {\n    const passengers = prompt('Enter number of passengers (1-10):', '1');\n    \n    if (!passengers || isNaN(passengers) || parseInt(passengers) < 1 || parseInt(passengers) > 10) {\n        alert('Please enter a valid number of passengers between 1 and 10');\n        return;\n    }\n    \n    try {\n        const response = await fetch(`/api/bookings/from-itinerary/${id}?passengers=${parseInt(passengers)}`, {\n            method: 'POST'\n        });\n        \n        const data = await response.json();\n        \n        if (data.status === 'success') {\n            showSuccessMessage(`✅ Booking created! Booking ID: ${data.booking_id}`);\n            navigateTo('trips');\n            setTimeout(() => {\n                loadMyTrips();\n            }, 500);\n        } else {\n            alert('Error creating booking: ' + (data.error || 'Unknown error'));\n        }\n    } catch (error) {\n        alert('Error creating booking: ' + error.message);\n    }\n}\n\nasync function deleteItinerary(id) {\n    if (!confirm('Are you sure you want to delete this itinerary?')) return;\n    \n    try {\n        const response = await fetch(`/api/itineraries/${id}`, {\n            method: 'DELETE'\n        });\n        \n        const data = await response.json();\n        \n        if (data.status === 'success') {\n            showSuccessMessage('✅ Itinerary deleted successfully!');\n            loadCalendar();\n        } else {\n            alert('Error deleting itinerary');\n        }\n    } catch (error) {\n        alert('Error deleting itinerary: ' + error.message);\n    }\n}\n\nasync function loadMyTrips() {\n    const tripsGrid = document.querySelector('#trips-page .trips-grid');\n    \n    if (!tripsGrid) {\n        console.error('Trips grid element not found');\n        return;\n    }\n    \n    tripsGrid.innerHTML = '<div class=\"loading-container\"><div class=\"loading-spinner-large\"></div><p>Loading your trips...</p></div>';\n    \n    try {\n        const response = await fetch('/api/bookings');\n        \n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        \n        const data = await response.json();\n        \n        if (data.status === 'success' && data.bookings && data.bookings.length > 0) {\n            let html = '';\n            \n            data.bookings.forEach(booking => {\n                const statusBadge = booking.status === 'confirmed' \n                    ? '<span class=\"badge badge-success\">✓ Confirmed</span>'\n                    : booking.status === 'cancelled'\n                    ? '<span class=\"badge\" style=\"background: rgba(239, 68, 68, 0.1); color: #ef4444;\">Cancelled</span>'\n                    : '<span class=\"badge badge-primary\">Pending</span>';\n                \n                html += `\n                    <div class=\"trip-card\">\n                        <div class=\"trip-image\">✈️</div>\n                        <div class=\"trip-content\">\n                            <h3 class=\"trip-title\">${booking.trip_name}</h3>\n                            <div class=\"trip-meta\">📅 ${booking.start_date} to ${booking.end_date} • 💰 $${(booking.total_price || 0).toFixed(2)} • 👥 ${booking.passengers || 1} passenger(s)</div>\n                            <p class=\"feature-desc\">${booking.destination}</p>\n                            <div style=\"margin-top: 1rem;\">\n                                ${statusBadge}\n                                ${booking.payment_status === 'paid' ? '<span class=\"badge badge-success\">💳 Paid</span>' : '<span class=\"badge badge-warning\">💳 Unpaid</span>'}\n                            </div>\n                            <div style=\"margin-top: 1rem;\">\n                                <small style=\"color: var(--gray);\">Booking ID: ${booking.id}</small>\n                            </div>\n                            <div style=\"margin-top: 0.5rem;\">\n                                <button class=\"btn-small btn-view\" onclick=\"viewBookingDetails('${booking.id}')\" style=\"margin-right: 0.5rem;\">📋 View Details</button>\n                                ${booking.status !== 'cancelled' && booking.payment_status !== 'paid' ? \n                                    `<button class=\"btn-small btn-delete\" onclick=\"cancelBooking('${booking.id}')\">❌ Cancel</button>` : \n                                    ''}\n                            </div>\n                        </div>\n                    </div>\n                `;\n            });\n            \n            html += `\n                <div class=\"trip-card\" style=\"border: 2px dashed var(--primary); background: rgba(99, 102, 241, 0.05);\">\n                    <div class=\"trip-image\" style=\"background: rgba(99, 102, 241, 0.1); color: var(--primary);\">➕</div>\n                    <div class=\"trip-content\" style=\"text-align: center;\">\n                        <h3 class=\"trip-title\" style=\"color: var(--primary);\">Plan New Trip</h3>\n                        <p class=\"feature-desc\" style=\"margin: 1rem 0;\">Ready for your next adventure? Let our AI help you plan the perfect trip!</p>\n                        <button class=\"btn btn-primary\" onclick=\"navigateTo('plan')\">🚀 Start Planning</button>\n                    </div>\n                </div>\n            `;\n            \n            tripsGrid.innerHTML = html;\n        } else {\n            // Show empty state when no bookings\n            tripsGrid.innerHTML = `\n                <div class=\"empty-state\">\n                    <div class=\"empty-icon\">✈️</div>\n                    <h3>No trips booked yet</h3>\n                    <p>Start planning your next adventure and your bookings will appear here!</p>\n                    <button class=\"btn btn-primary\" onclick=\"navigateTo('plan')\">🚀 Plan Your First Trip</button>\n                </div>\n            `;\n        }\n    } catch (error) {\n        console.error('Error loading trips:', error);\n        tripsGrid.innerHTML = `\n            <div class=\"empty-state\">\n                <div class=\"empty-icon\">❌</div>\n                <h3>Error loading trips</h3>\n                <p>${error.message}</p>\n                <button class=\"btn btn-primary\" onclick=\"loadMyTrips()\">🔄 Try Again</button>\n            </div>\n        `;\n    }\n}\n\nfunction checkPaymentStatus() {\n    const urlParams = new URLSearchParams(window.location.search);\n    const paymentStatus = urlParams.get('payment');\n    const bookingId = urlParams.get('booking_id');\n    \n    if (paymentStatus === 'success' && bookingId) {\n        fetch(`/api/bookings/${bookingId}/confirm`, { method: 'POST' })\n            .then(response => {\n                if (!response.ok) {\n                    throw new Error(`HTTP error! status: ${response.status}`);\n                }\n                return response.json();\n            })\n            .then(() => {\n                navigateTo('trips');\n                setTimeout(() => {\n                    showSuccessMessage('🎉 Payment Successful! Your trip is confirmed!');\n                    loadMyTrips();\n                }, 500);\n            })\n            .catch(error => {\n                console.error('Error confirming booking:', error);\n                showSuccessMessage('⚠️ Payment was successful but there was an error confirming your booking. Please contact support.', 'warning');\n            });\n        \n        window.history.replaceState({}, document.title, '/');\n    } else if (paymentStatus === 'cancelled') {\n        showSuccessMessage('❌ Payment was cancelled. You can try again from My Trips.', 'warning');\n        window.history.replaceState({}, document.title, '/');\n    }\n}\n\nasync function viewBookingDetails(bookingId) {\n    try {\n        const response = await fetch(`/api/bookings/${bookingId}`);\n        const data = await response.json();\n        \n        if (data.status === 'success') {\n            const booking = data.booking;\n            const details = `\nBooking Details:\n\nBooking ID: ${booking.booking_id}\nTrip: ${booking.trip_name}\nDestination: ${booking.destination}\nDates: ${booking.start_date} to ${booking.end_date}\nPassengers: ${booking.passengers}\nBase Price: $${booking.base_price?.toFixed(2) || '0.00'}\nTotal Price: $${booking.total_price?.toFixed(2) || '0.00'}\nStatus: ${booking.status}\nPayment Status: ${booking.payment_status}\n${booking.email ? `Email: ${booking.email}` : ''}\n${booking.special_requests ? `Special Requests: ${booking.special_requests}` : ''}\nCreated: ${booking.created_at ? new Date(booking.created_at).toLocaleString() : 'N/A'}\n${booking.confirmed_at ? `Confirmed: ${new Date(booking.confirmed_at).toLocaleString()}` : ''}\n${booking.cancelled_at ? `Cancelled: ${new Date(booking.cancelled_at).toLocaleString()}` : ''}\n            `.trim();\n            \n            alert(details);\n        }\n    } catch (error) {\n        alert('Error loading booking details: ' + error.message);\n    }\n}\n\nasync function cancelBooking(bookingId) {\n    if (!confirm('Are you sure you want to cancel this booking?')) return;\n    \n    try {\n        const response = await fetch(`/api/bookings/${bookingId}`, {\n            method: 'DELETE'\n        });\n        \n        const data = await response.json();\n        \n        if (data.status === 'success') {\n            showSuccessMessage('✅ Booking cancelled successfully!');\n            loadMyTrips();\n        } else {\n            alert('Error cancelling booking: ' + (data.error || 'Unknown error'));\n        }\n    } catch (error) {\n        alert('Error cancelling booking: ' + error.message);\n    }\n}\n\nfunction showSuccessMessage(message, type = 'success') {\n    const alertClass = type === 'success' ? 'alert-success' : 'alert-warning';\n    const alert = document.createElement('div');\n    alert.className = `alert ${alertClass} success-toast`;\n    alert.style.position = 'fixed';\n    alert.style.top = '100px';\n    alert.style.right = '20px';\n    alert.style.zIndex = '3000';\n    alert.style.minWidth = '300px';\n    alert.innerHTML = message;\n    \n    document.body.appendChild(alert);\n    \n    setTimeout(() => {\n        alert.style.transition = 'opacity 0.3s';\n        alert.style.opacity = '0';\n        setTimeout(() => alert.remove(), 300);\n    }, 5000);\n}\n\n\nasync function openBookingPageFromChat() {\n    try {\n        const response = await fetch(\"/api/booking-options\", {\n            method: \"POST\",\n            headers: { \"Content-Type\": \"application/json\" },\n            body: JSON.stringify({})\n        });\n        const data = await response.json();\n        if (data.status === \"success\") {\n            bookingTripDetails = data.trip_details;\n            selectedFlight = null;\n            selectedHotel = null;\n            navigateTo(\"booking\");\n            setTimeout(() => loadBookingOptions(data), 300);\n        } else {\n            alert(\"Unable to extract trip details. Please plan a trip in the chat first!\");\n        }\n    } catch (error) {\n        alert(\"Error: \" + error.message);\n    }\n}\n\nfunction loadBookingOptions(data) {\n    const summaryCard = document.getElementById(\"booking-details-card\");\n    const summaryContent = document.getElementById(\"booking-summary-content\");\n    const summaryText = document.getElementById(\"booking-summary\");\n    if (data.trip_details) {\n        const trip = data.trip_details;\n        summaryContent.innerHTML = `<div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;\"><div><strong>📍 Destination:</strong> ${trip.destination}</div><div><strong>✈️ Origin:</strong> ${trip.origin}</div><div><strong>📅 Dates:</strong> ${trip.start_date} to ${trip.end_date}</div><div><strong>💰 Budget:</strong> $${trip.budget.toFixed(2)}</div><div><strong>👥 Passengers:</strong> ${trip.passengers}</div></div>`;\n        summaryCard.style.display = \"block\";\n        summaryText.textContent = `Select flights and hotel for ${trip.destination}`;\n        \n        // Set default nights and passengers from trip details\n        const numNights = Math.ceil((new Date(trip.end_date) - new Date(trip.start_date)) / (1000 * 60 * 60 * 24));\n        const nightsSelect = document.getElementById(\"nights-select\");\n        const passengersSelect = document.getElementById(\"passengers-select\");\n        if (nightsSelect) nightsSelect.value = numNights || 1;\n        if (passengersSelect) passengersSelect.value = trip.passengers || 1;\n    }\n    \n    // Populate flight dropdown\n    const flightSelect = document.getElementById(\"flight-select\");\n    if (flightSelect && data.flights?.length > 0) {\n        flightSelect.innerHTML = '<option value=\"\">Select Flight</option>' + \n            data.flights.map((flight, index) => \n                `<option value=\"${index}\" data-price=\"${flight.price}\">${flight.airline} ${flight.flight_number} - $${flight.price.toFixed(2)} (${flight.departure_time} - ${flight.arrival_time})</option>`\n            ).join(\"\");\n    }\n    \n    // Populate hotel dropdown\n    const hotelSelect = document.getElementById(\"hotel-select\");\n    if (hotelSelect && data.hotels?.length > 0) {\n        hotelSelect.innerHTML = '<option value=\"\">Select Hotel</option>' + \n            data.hotels.map((hotel, index) => \n                `<option value=\"${index}\" data-price=\"${hotel.price_per_night}\">${hotel.name} - $${hotel.price_per_night.toFixed(2)}/night (${hotel.rating.toFixed(1)}⭐)</option>`\n            ).join(\"\");\n    }\n    \n    // Store flights and hotels data globally for later use\n    window.bookingFlights = data.flights || [];\n    window.bookingHotels = data.hotels || [];\n    \n    const flightsContainer = document.getElementById(\"flights-container\");\n    if (data.flights?.length > 0) {\n        flightsContainer.innerHTML = data.flights.map((flight, index) => `<div class=\"flight-option ${selectedFlight === index ? \"selected\" : \"\"}\" onclick=\"selectFlight(${index}, ${flight.price})\"><div class=\"flight-header\"><div class=\"flight-airline\"><strong>${flight.airline}</strong><span class=\"flight-number\">${flight.flight_number}</span></div><div class=\"flight-price\">$${flight.price.toFixed(2)}</div></div><div class=\"flight-details\"><div class=\"flight-time\"><div><strong>${flight.departure_time}</strong><span class=\"flight-city\">${data.trip_details?.origin || \"Mumbai\"}</span></div><div class=\"flight-duration\">${flight.duration}</div><div><strong>${flight.arrival_time}</strong><span class=\"flight-city\">${data.trip_details?.destination || \"Destination\"}</span></div></div><div class=\"flight-info\"><span class=\"badge badge-primary\">${flight.class}</span><span class=\"badge badge-secondary\">${flight.stops === 0 ? \"Non-stop\" : flight.stops + \" stop(s)\"}</span></div></div></div>`).join(\"\");\n    } else {\n        flightsContainer.innerHTML = \"<p style=\\\"text-align: center; color: var(--gray); padding: 2rem;\\\">No flights available.</p>\";\n    }\n    const hotelsContainer = document.getElementById(\"hotels-container\");\n    if (data.hotels?.length > 0) {\n        const numNights = data.trip_details ? Math.ceil((new Date(data.trip_details.end_date) - new Date(data.trip_details.start_date)) / (1000 * 60 * 60 * 24)) : 1;\n        hotelsContainer.innerHTML = data.hotels.map((hotel, index) => { const totalPrice = hotel.price_per_night * numNights; return `<div class=\"hotel-option ${selectedHotel === index ? \"selected\" : \"\"}\" onclick=\"selectHotel(${index}, ${hotel.price_per_night}, ${numNights})\"><div class=\"hotel-header\"><div><h4 class=\"hotel-name\">${hotel.name}</h4><div class=\"hotel-rating\">${\"⭐\".repeat(Math.floor(hotel.rating))} ${hotel.rating.toFixed(1)} <span class=\"hotel-reviews\">(${hotel.reviews} reviews)</span></div></div><div class=\"hotel-price\"><div class=\"price-per-night\">$${hotel.price_per_night.toFixed(2)}/night</div><div class=\"price-total\">$${totalPrice.toFixed(2)} total</div></div></div><div class=\"hotel-details\"><div class=\"hotel-location\">📍 ${hotel.location}</div><div class=\"hotel-amenities\">${hotel.amenities.map(a => `<span class=\"amenity-badge\">${a}</span>`).join(\"\")}</div><div class=\"hotel-style\"><span class=\"badge badge-${hotel.style === \"luxury\" ? \"primary\" : hotel.style === \"mid-range\" ? \"success\" : \"warning\"}\">${hotel.style}</span></div></div></div>`; }).join(\"\");\n    } else {\n        hotelsContainer.innerHTML = \"<p style=\\\"text-align: center; color: var(--gray); padding: 2rem;\\\">No hotels available.</p>\";\n    }\n    updateTotalPrice();\n}\n\nfunction updateFlightPrice() {\n    const flightSelect = document.getElementById(\"flight-select\");\n    if (flightSelect && flightSelect.value !== \"\") {\n        const index = parseInt(flightSelect.value);\n        const price = parseFloat(flightSelect.options[flightSelect.selectedIndex].dataset.price);\n        selectedFlight = index;\n        document.getElementById(\"flight-price\").textContent = `$${price.toFixed(2)}`;\n        // Update visual selection\n        document.querySelectorAll(\".flight-option\").forEach((f, i) => f.classList.toggle(\"selected\", i === index));\n    } else {\n        selectedFlight = null;\n        document.getElementById(\"flight-price\").textContent = \"$0.00\";\n        document.querySelectorAll(\".flight-option\").forEach(f => f.classList.remove(\"selected\"));\n    }\n    updateTotalPrice();\n}\n\nfunction updateHotelPrice() {\n    const hotelSelect = document.getElementById(\"hotel-select\");\n    if (hotelSelect && hotelSelect.value !== \"\") {\n        const index = parseInt(hotelSelect.value);\n        const price = parseFloat(hotelSelect.options[hotelSelect.selectedIndex].dataset.price);\n        selectedHotel = index;\n        document.getElementById(\"hotel-price\").textContent = `$${price.toFixed(2)}`;\n        // Update visual selection\n        document.querySelectorAll(\".hotel-option\").forEach((h, i) => h.classList.toggle(\"selected\", i === index));\n    } else {\n        selectedHotel = null;\n        document.getElementById(\"hotel-price\").textContent = \"$0.00\";\n        document.querySelectorAll(\".hotel-option\").forEach(h => h.classList.remove(\"selected\"));\n    }\n    updateTotalPrice();\n}\n\nfunction selectFlight(index, price) {\n    selectedFlight = index;\n    document.querySelectorAll(\".flight-option\").forEach((f, i) => f.classList.toggle(\"selected\", i === index));\n    const flightSelect = document.getElementById(\"flight-select\");\n    if (flightSelect) flightSelect.value = index;\n    updateTotalPrice();\n}\n\nfunction selectHotel(index, pricePerNight, nights) {\n    selectedHotel = index;\n    document.querySelectorAll(\".hotel-option\").forEach((h, i) => h.classList.toggle(\"selected\", i === index));\n    const hotelSelect = document.getElementById(\"hotel-select\");\n    if (hotelSelect) hotelSelect.value = index;\n    updateTotalPrice();\n}\nfunction togglePriceSummary() {\n    const footer = document.getElementById(\"price-summary-footer\");\n    if (footer) {\n        footer.classList.toggle(\"expanded\");\n    }\n}\n\nfunction updateTotalPrice() {\n    const flightPriceEl = document.getElementById(\"flight-price\");\n    const hotelPriceEl = document.getElementById(\"hotel-price\");\n    const nightsCountEl = document.getElementById(\"nights-count\");\n    const passengersCountEl = document.getElementById(\"passengers-count\");\n    const totalPriceEl = document.getElementById(\"total-price\");\n    const footerTotalEl = document.getElementById(\"footer-total-price\");\n    const proceedBtn = document.getElementById(\"proceed-booking-btn\");\n    \n    if (!flightPriceEl || !hotelPriceEl || !totalPriceEl) return;\n    \n    let flightPrice = 0, hotelPricePerNight = 0, nights = 1, passengers = 1;\n    \n    // Get flight price from dropdown or selection\n    const flightSelect = document.getElementById(\"flight-select\");\n    if (flightSelect && flightSelect.value !== \"\") {\n        flightPrice = parseFloat(flightSelect.options[flightSelect.selectedIndex].dataset.price || 0);\n    } else if (selectedFlight !== null && window.bookingFlights) {\n        flightPrice = window.bookingFlights[selectedFlight]?.price || 0;\n    }\n    \n    // Get hotel price from dropdown or selection\n    const hotelSelect = document.getElementById(\"hotel-select\");\n    if (hotelSelect && hotelSelect.value !== \"\") {\n        hotelPricePerNight = parseFloat(hotelSelect.options[hotelSelect.selectedIndex].dataset.price || 0);\n    } else if (selectedHotel !== null && window.bookingHotels) {\n        hotelPricePerNight = window.bookingHotels[selectedHotel]?.price_per_night || 0;\n    }\n    \n    // Get nights from dropdown\n    const nightsSelect = document.getElementById(\"nights-select\");\n    if (nightsSelect) {\n        nights = parseInt(nightsSelect.value || 1);\n    } else if (bookingTripDetails) {\n        nights = Math.ceil((new Date(bookingTripDetails.end_date) - new Date(bookingTripDetails.start_date)) / (1000 * 60 * 60 * 24));\n    }\n    \n    // Get passengers from dropdown\n    const passengersSelect = document.getElementById(\"passengers-select\");\n    if (passengersSelect) {\n        passengers = parseInt(passengersSelect.value || 1);\n    } else {\n        const passengerInput = document.getElementById(\"passenger-count\");\n        if (passengerInput) passengers = parseInt(passengerInput.value || 1);\n    }\n    \n    const total = (flightPrice * passengers) + (hotelPricePerNight * nights);\n    \n    flightPriceEl.textContent = `$${flightPrice.toFixed(2)}`;\n    hotelPriceEl.textContent = `$${hotelPricePerNight.toFixed(2)}`;\n    if (nightsCountEl) nightsCountEl.textContent = nights;\n    if (passengersCountEl) passengersCountEl.textContent = passengers;\n    totalPriceEl.innerHTML = `<strong>$${total.toFixed(2)}</strong>`;\n    \n    // Update footer total\n    if (footerTotalEl) {\n        footerTotalEl.textContent = `Total: $${total.toFixed(2)}`;\n    }\n    \n    // Enable proceed button only if both flight and hotel are selected\n    if (proceedBtn) {\n        const hasFlight = (flightSelect && flightSelect.value !== \"\") || selectedFlight !== null;\n        const hasHotel = (hotelSelect && hotelSelect.value !== \"\") || selectedHotel !== null;\n        proceedBtn.disabled = !(hasFlight && hasHotel);\n    }\n}\nasync function proceedToBooking() {\n    if (selectedFlight === null || selectedHotel === null) { alert(\"Please select both flight and hotel.\"); return; }\n    try {\n        const flights = document.querySelectorAll(\".flight-option\"); const hotels = document.querySelectorAll(\".hotel-option\");\n        const flightText = flights[selectedFlight].textContent; const flightMatch = flightText.match(/([A-Za-z\\s]+)\\s+([A-Z0-9]+)/);\n        const flightDetails = { airline: flightMatch?.[1].trim() || \"Unknown\", flight_number: flightMatch?.[2] || \"N/A\", price: parseFloat(flightText.match(/\\$([\\d.]+)/)?.[1] || 0) };\n        const hotelName = hotels[selectedHotel].querySelector(\".hotel-name\")?.textContent || \"Unknown\"; const hotelPriceMatch = hotels[selectedHotel].textContent.match(/\\$([\\d.]+)\\/night/);\n        const hotelDetails = { name: hotelName, price_per_night: parseFloat(hotelPriceMatch?.[1] || 0) };\n        const passengersSelect = document.getElementById(\"passengers-select\");\n        const passengers = passengersSelect ? parseInt(passengersSelect.value) : parseInt(document.getElementById(\"passenger-count\")?.value || 1);\n        const email = document.getElementById(\"passenger-email\")?.value;\n        const specialRequests = document.getElementById(\"special-requests\")?.value;\n        const nightsSelect = document.getElementById(\"nights-select\");\n        const nights = nightsSelect ? parseInt(nightsSelect.value) : Math.ceil((new Date(bookingTripDetails.end_date) - new Date(bookingTripDetails.start_date)) / (1000 * 60 * 60 * 24));\n        const totalPrice = (flightDetails.price * passengers) + (hotelDetails.price_per_night * nights);\n        const response = await fetch(\"/api/bookings\", { method: \"POST\", headers: { \"Content-Type\": \"application/json\" }, body: JSON.stringify({ trip_id: `booking-${Date.now()}`, trip_name: `Trip to ${bookingTripDetails.destination}`, destination: bookingTripDetails.destination, start_date: bookingTripDetails.start_date, end_date: bookingTripDetails.end_date, total_price: totalPrice, passengers: passengers, email: email || undefined, flight_details: flightDetails, hotel_details: hotelDetails, special_requests: specialRequests || undefined }) });\n        const data = await response.json();\n        if (data.status === \"success\") { showSuccessMessage(`✅ Booking created! ID: ${data.booking_id}`); setTimeout(() => { navigateTo(\"trips\"); loadMyTrips(); }, 2000); } else { alert(\"Error: \" + (data.error || \"Unknown error\")); }\n    } catch (error) { alert(\"Error: \" + error.message); }\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    // Initialize theme FIRST before any visual elements\n    initTheme();\n    \n    // Initialize reminder checkbox\n    const reminderCheckbox = document.getElementById('event-reminder');\n    if (reminderCheckbox) {\n        reminderCheckbox.addEventListener('change', function() {\n            document.getElementById('reminder-options').style.display = this.checked ? 'block' : 'none';\n        });\n    }\n    \n    // Sync color picker with text input\n    const colorPicker = document.getElementById('event-color');\n    const colorText = document.getElementById('event-color-text');\n    if (colorPicker && colorText) {\n        colorPicker.addEventListener('input', function() {\n            colorText.value = this.value;\n        });\n        colorText.addEventListener('input', function() {\n            if (/^#[0-9A-F]{6}$/i.test(this.value)) {\n                colorPicker.value = this.value;\n            }\n        });\n    }\n    \n    // Initialize price summary footer - hidden by default\n    const footer = document.getElementById(\"price-summary-footer\");\n    if (footer) {\n        footer.style.display = \"none\";\n    }\n    \n    navigateTo('home');\n    checkPaymentStatus();\n    \n    const chatInput = document.getElementById('chat-input');\n    if (chatInput) {\n        chatInput.addEventListener('keypress', (e) => {\n            if (e.key === 'Enter' && !e.shiftKey) {\n                e.preventDefault();\n                sendMessage();\n            }\n        });\n    }\n    \n    // Add welcome message with animation\n    setTimeout(() => {\n        addMessage('assistant', \n            '👋 Hello! I\\'m your AI travel planning assistant. I can help you plan complete trips, find flights & hotels, create itineraries, manage budgets, and remember your preferences. I can also create bookings for you! Just tell me where you\\'d like to go or say \"I want to book a trip\" to get started! 🚀'\n        );\n    }, 500);\n    \n    // Add parallax effect on scroll\n    let lastScroll = 0;\n    window.addEventListener('scroll', () => {\n        const currentScroll = window.pageYOffset;\n        const hero = document.querySelector('.hero');\n        if (hero) {\n            hero.style.transform = `translateY(${currentScroll * 0.5}px)`;\n        }\n        lastScroll = currentScroll;\n    });\n});\n","size_bytes":76229},"agent/travel_agent.py":{"content":"import os\nimport json\nimport requests\nfrom typing import List, Dict, Any, Optional\nfrom datetime import datetime, timedelta\nfrom langchain_groq import ChatGroq\nfrom langchain_core.tools import tool\nfrom langchain_core.prompts import ChatPromptTemplate, MessagesPlaceholder\nfrom langchain_community.chat_message_histories import ChatMessageHistory\nfrom langchain_core.messages import AIMessage, HumanMessage, SystemMessage\nfrom langgraph.prebuilt import create_react_agent\n\n# Using Groq API with llama-3.3-70b-versatile model for fast travel planning\n\n# Global user preferences storage (in production would use a database)\nuser_preferences_store = {}\n\n@tool\ndef search_flights(origin: str, destination: str, date: str, max_budget: float = 1000.0) -> str:\n    \"\"\"\n    Search for available flights between two cities.\n    \n    Args:\n        origin: Departure city\n        destination: Arrival city\n        date: Travel date in YYYY-MM-DD format\n        max_budget: Maximum budget per person for the flight\n        \n    Returns:\n        JSON string with flight options including prices, times, airlines\n    \"\"\"\n    flights = [\n        {\n            \"airline\": \"Air India\",\n            \"flight_number\": \"AI202\",\n            \"departure_time\": \"08:00\",\n            \"arrival_time\": \"10:30\",\n            \"duration\": \"2h 30m\",\n            \"price\": min(max_budget * 0.6, 450),\n            \"stops\": 0,\n            \"class\": \"Economy\"\n        },\n        {\n            \"airline\": \"IndiGo\",\n            \"flight_number\": \"6E345\",\n            \"departure_time\": \"14:00\",\n            \"arrival_time\": \"16:45\",\n            \"duration\": \"2h 45m\",\n            \"price\": min(max_budget * 0.4, 350),\n            \"stops\": 0,\n            \"class\": \"Economy\"\n        },\n        {\n            \"airline\": \"SpiceJet\",\n            \"flight_number\": \"SG890\",\n            \"departure_time\": \"18:30\",\n            \"arrival_time\": \"21:15\",\n            \"duration\": \"2h 45m\",\n            \"price\": min(max_budget * 0.35, 320),\n            \"stops\": 0,\n            \"class\": \"Economy\"\n        }\n    ]\n    \n    result = {\n        \"origin\": origin,\n        \"destination\": destination,\n        \"date\": date,\n        \"flights_found\": len(flights),\n        \"flights\": flights\n    }\n    \n    return json.dumps(result, indent=2)\n\n@tool\ndef search_hotels(city: str, check_in: str, check_out: str, max_price_per_night: float = 150.0, accommodation_style: str = \"any\") -> str:\n    \"\"\"\n    Search for hotels in a destination city.\n    \n    Args:\n        city: Destination city\n        check_in: Check-in date in YYYY-MM-DD format\n        check_out: Check-out date in YYYY-MM-DD format\n        max_price_per_night: Maximum budget per night\n        accommodation_style: Preference like 'luxury', 'budget-friendly', 'mid-range', or 'any'\n        \n    Returns:\n        JSON string with hotel options including prices, ratings, amenities\n    \"\"\"\n    all_hotels = [\n        {\n            \"name\": \"Beach Paradise Resort\",\n            \"rating\": 4.5,\n            \"price_per_night\": min(max_price_per_night * 0.8, 120),\n            \"location\": \"Beachfront\",\n            \"amenities\": [\"Pool\", \"WiFi\", \"Breakfast\", \"Spa\", \"Beach Access\"],\n            \"reviews\": 1250,\n            \"style\": \"luxury\"\n        },\n        {\n            \"name\": \"Cozy Inn & Suites\",\n            \"rating\": 4.2,\n            \"price_per_night\": min(max_price_per_night * 0.5, 80),\n            \"location\": \"City Center\",\n            \"amenities\": [\"WiFi\", \"Breakfast\", \"Parking\", \"Gym\"],\n            \"reviews\": 890,\n            \"style\": \"mid-range\"\n        },\n        {\n            \"name\": \"Budget Stay Hotel\",\n            \"rating\": 3.8,\n            \"price_per_night\": min(max_price_per_night * 0.3, 50),\n            \"location\": \"Near Beach\",\n            \"amenities\": [\"WiFi\", \"AC\", \"24/7 Reception\"],\n            \"reviews\": 456,\n            \"style\": \"budget-friendly\"\n        }\n    ]\n    \n    # Filter by style preference\n    if accommodation_style != \"any\":\n        filtered_hotels = [h for h in all_hotels if h[\"style\"] == accommodation_style]\n        if filtered_hotels:\n            all_hotels = filtered_hotels\n    \n    result = {\n        \"city\": city,\n        \"check_in\": check_in,\n        \"check_out\": check_out,\n        \"hotels_found\": len(all_hotels),\n        \"hotels\": all_hotels\n    }\n    \n    return json.dumps(result, indent=2)\n\n@tool\ndef get_weather_forecast(city: str, date: str) -> str:\n    \"\"\"\n    Get weather forecast for a destination.\n    \n    Args:\n        city: Destination city\n        date: Date for weather forecast in YYYY-MM-DD format\n        \n    Returns:\n        JSON string with weather information\n    \"\"\"\n    # Simulate different weather based on month\n    try:\n        # Parse date in YYYY-MM-DD format\n        date_parts = date.split(\"-\")\n        if len(date_parts) < 2:\n            # Fallback: try to extract month from date string\n            month = 6  # Default to monsoon/fall season\n        else:\n            month = int(date_parts[1])\n    except (ValueError, IndexError):\n        # If date parsing fails, default to monsoon/fall season\n        month = 6\n    \n    if month in [12, 1, 2]:  # Winter\n        weather = {\n            \"city\": city,\n            \"date\": date,\n            \"temperature_high\": \"25°C\",\n            \"temperature_low\": \"18°C\",\n            \"condition\": \"Sunny and pleasant\",\n            \"humidity\": \"55%\",\n            \"precipitation_chance\": \"5%\",\n            \"recommendation\": \"Perfect weather for outdoor activities! Light jacket for evenings.\"\n        }\n    elif month in [3, 4, 5]:  # Summer\n        weather = {\n            \"city\": city,\n            \"date\": date,\n            \"temperature_high\": \"32°C\",\n            \"temperature_low\": \"26°C\",\n            \"condition\": \"Hot and sunny\",\n            \"humidity\": \"70%\",\n            \"precipitation_chance\": \"15%\",\n            \"recommendation\": \"Hot weather - stay hydrated and use sunscreen. Beach time recommended!\"\n        }\n    else:  # Monsoon/Fall\n        weather = {\n            \"city\": city,\n            \"date\": date,\n            \"temperature_high\": \"28°C\",\n            \"temperature_low\": \"22°C\",\n            \"condition\": \"Partly cloudy with occasional showers\",\n            \"humidity\": \"80%\",\n            \"precipitation_chance\": \"60%\",\n            \"recommendation\": \"Pack an umbrella and rain jacket. Great for indoor activities.\"\n        }\n    \n    return json.dumps(weather, indent=2)\n\n@tool\ndef search_activities(city: str, categories: Optional[List[str]] = None) -> str:\n    \"\"\"\n    Search for activities and attractions in a destination.\n    \n    Args:\n        city: Destination city\n        categories: List of interest categories like ['adventure', 'culture', 'food', 'beach', 'nightlife']\n        \n    Returns:\n        JSON string with activity options\n    \"\"\"\n    all_activities = [\n        {\n            \"name\": \"Scuba Diving Adventure\",\n            \"category\": \"adventure\",\n            \"duration\": \"3 hours\",\n            \"price\": 75,\n            \"rating\": 4.7,\n            \"description\": \"Explore vibrant coral reefs and marine life with expert instructors\"\n        },\n        {\n            \"name\": \"Beach Sunset Cruise\",\n            \"category\": \"beach\",\n            \"duration\": \"2 hours\",\n            \"price\": 50,\n            \"rating\": 4.6,\n            \"description\": \"Romantic sunset cruise along the coast with dinner included\"\n        },\n        {\n            \"name\": \"Local Food & Spice Tour\",\n            \"category\": \"food\",\n            \"duration\": \"4 hours\",\n            \"price\": 40,\n            \"rating\": 4.8,\n            \"description\": \"Taste authentic local cuisine and visit spice plantations\"\n        },\n        {\n            \"name\": \"Historical Fort & Museum Visit\",\n            \"category\": \"culture\",\n            \"duration\": \"3 hours\",\n            \"price\": 15,\n            \"rating\": 4.4,\n            \"description\": \"Explore centuries-old Portuguese architecture and local history\"\n        },\n        {\n            \"name\": \"Parasailing Experience\",\n            \"category\": \"adventure\",\n            \"duration\": \"1 hour\",\n            \"price\": 60,\n            \"rating\": 4.9,\n            \"description\": \"Soar 300 feet above the beach with breathtaking aerial views\"\n        },\n        {\n            \"name\": \"Yoga & Meditation Retreat\",\n            \"category\": \"wellness\",\n            \"duration\": \"2 hours\",\n            \"price\": 30,\n            \"rating\": 4.5,\n            \"description\": \"Beachside morning yoga and meditation session\"\n        },\n        {\n            \"name\": \"Night Market & Street Food\",\n            \"category\": \"nightlife\",\n            \"duration\": \"3 hours\",\n            \"price\": 25,\n            \"rating\": 4.7,\n            \"description\": \"Explore bustling night markets and taste local street food\"\n        }\n    ]\n    \n    # Filter by categories if specified\n    if categories:\n        filtered = [a for a in all_activities if a[\"category\"] in categories]\n        if filtered:\n            all_activities = filtered\n    \n    result = {\n        \"city\": city,\n        \"activities_found\": len(all_activities),\n        \"activities\": all_activities\n    }\n    \n    return json.dumps(result, indent=2)\n\n@tool\ndef calculate_trip_budget(flight_cost: float, hotel_cost_per_night: float, num_nights: int, \n                         activity_costs: List[float], daily_meal_budget: float = 30.0) -> str:\n    \"\"\"\n    Calculate total trip budget breakdown.\n    \n    Args:\n        flight_cost: Cost of round-trip flights\n        hotel_cost_per_night: Hotel cost per night\n        num_nights: Number of nights staying\n        activity_costs: List of activity costs to include\n        daily_meal_budget: Estimated daily budget for meals\n        \n    Returns:\n        JSON string with detailed budget breakdown\n    \"\"\"\n    hotel_total = hotel_cost_per_night * num_nights\n    meals_total = daily_meal_budget * num_nights\n    activities_total = sum(activity_costs)\n    transportation_total = 50  # Local transportation estimate\n    \n    total = flight_cost + hotel_total + meals_total + activities_total + transportation_total\n    \n    breakdown = {\n        \"flights\": {\n            \"amount\": flight_cost,\n            \"percentage\": round((flight_cost / total * 100), 1)\n        },\n        \"accommodation\": {\n            \"amount\": hotel_total,\n            \"nights\": num_nights,\n            \"per_night\": hotel_cost_per_night,\n            \"percentage\": round((hotel_total / total * 100), 1)\n        },\n        \"meals\": {\n            \"amount\": meals_total,\n            \"per_day\": daily_meal_budget,\n            \"percentage\": round((meals_total / total * 100), 1)\n        },\n        \"activities\": {\n            \"amount\": activities_total,\n            \"count\": len(activity_costs),\n            \"percentage\": round((activities_total / total * 100), 1)\n        },\n        \"local_transportation\": {\n            \"amount\": transportation_total,\n            \"percentage\": round((transportation_total / total * 100), 1)\n        },\n        \"total_cost\": total,\n        \"currency\": \"USD\"\n    }\n    \n    return json.dumps(breakdown, indent=2)\n\n@tool\ndef save_user_preferences(preferences: Dict[str, Any]) -> str:\n    \"\"\"\n    Save user travel preferences for future reference.\n    \n    Args:\n        preferences: Dictionary of preferences like {'accommodation_style': 'luxury', 'dietary': 'vegetarian', 'interests': ['culture', 'food']}\n        \n    Returns:\n        Confirmation message\n    \"\"\"\n    global user_preferences_store\n    user_preferences_store.update(preferences)\n    \n    return json.dumps({\n        \"status\": \"success\",\n        \"message\": f\"Saved {len(preferences)} preferences\",\n        \"current_preferences\": user_preferences_store\n    }, indent=2)\n\n@tool\ndef get_user_preferences() -> str:\n    \"\"\"\n    Retrieve all saved user preferences.\n    \n    Returns:\n        JSON string with all saved preferences\n    \"\"\"\n    global user_preferences_store\n    \n    if not user_preferences_store:\n        return json.dumps({\n            \"status\": \"empty\",\n            \"message\": \"No preferences saved yet\",\n            \"preferences\": {}\n        }, indent=2)\n    \n    return json.dumps({\n        \"status\": \"success\",\n        \"preferences\": user_preferences_store\n    }, indent=2)\n\n@tool\ndef create_booking(destination: str, trip_name: str, start_date: str, end_date: str, \n                  passengers: int, base_price: float = 200.0) -> str:\n    \"\"\"\n    Create a booking for a trip. This will save the booking and allow the user to proceed to payment.\n    \n    Args:\n        destination: Destination city/country\n        trip_name: Name of the trip\n        start_date: Start date in YYYY-MM-DD format\n        end_date: End date in YYYY-MM-DD format\n        passengers: Number of passengers (1-10)\n        base_price: Base price per person (default 200.0)\n        \n    Returns:\n        JSON string with booking confirmation and booking ID\n    \"\"\"\n    # Calculate total price\n    total_price = base_price * passengers\n    \n    # Generate a trip_id\n    trip_id = f\"ai-booking-{destination.lower().replace(' ', '-')}\"\n    \n    booking_data = {\n        \"trip_id\": trip_id,\n        \"trip_name\": trip_name,\n        \"destination\": destination,\n        \"start_date\": start_date,\n        \"end_date\": end_date,\n        \"total_price\": total_price,\n        \"passengers\": passengers,\n        \"flight_details\": {},\n        \"hotel_details\": {}\n    }\n    \n    try:\n        # Get the base URL from environment or use localhost\n        base_url = os.environ.get('BASE_URL', 'http://localhost:5000')\n        response = requests.post(\n            f\"{base_url}/api/bookings\",\n            json=booking_data,\n            timeout=5\n        )\n        \n        if response.status_code == 200:\n            result = response.json()\n            return json.dumps({\n                \"status\": \"success\",\n                \"message\": f\"Booking created successfully! Booking ID: {result.get('booking_id', 'N/A')}\",\n                \"booking_id\": result.get('booking_id'),\n                \"booking\": result.get('booking'),\n                \"next_step\": \"The user can now proceed to payment from the 'My Trips' page.\"\n            }, indent=2)\n        else:\n            return json.dumps({\n                \"status\": \"error\",\n                \"message\": f\"Failed to create booking: {response.text}\"\n            }, indent=2)\n    except Exception as e:\n        # If API call fails, return booking info for manual creation\n        return json.dumps({\n            \"status\": \"info\",\n            \"message\": f\"Booking details prepared: {trip_name} to {destination} for {passengers} passenger(s) from {start_date} to {end_date}. Total: ${total_price:.2f}\",\n            \"booking_data\": booking_data,\n            \"note\": \"Please visit the 'My Trips' page to complete the booking.\"\n        }, indent=2)\n\n@tool\ndef create_day_by_day_itinerary(destination: str, num_days: int, activities: List[str], \n                                hotel_name: str, special_interests: Optional[List[str]] = None) -> str:\n    \"\"\"\n    Create a detailed day-by-day travel itinerary.\n    \n    Args:\n        destination: Destination city\n        num_days: Number of days for the trip\n        activities: List of activity names to include\n        hotel_name: Name of the hotel\n        special_interests: Optional list of special interests to emphasize\n        \n    Returns:\n        JSON string with detailed daily itinerary\n    \"\"\"\n    itinerary = {\n        \"destination\": destination,\n        \"duration_days\": num_days,\n        \"hotel\": hotel_name,\n        \"days\": []\n    }\n    \n    for day in range(1, num_days + 1):\n        if day == 1:\n            day_plan = {\n                \"day\": day,\n                \"theme\": \"Arrival & Settling In\",\n                \"morning\": f\"Arrive at {destination}, hotel check-in at {hotel_name}\",\n                \"afternoon\": \"Light exploration of nearby area, beach/pool relaxation\",\n                \"evening\": \"Welcome dinner at hotel restaurant or nearby recommended spot\",\n                \"tips\": \"Rest and adjust to the new environment\"\n            }\n        elif day == num_days:\n            day_plan = {\n                \"day\": day,\n                \"theme\": \"Departure Day\",\n                \"morning\": \"Final breakfast, last-minute shopping or beach time\",\n                \"afternoon\": \"Hotel checkout, departure\",\n                \"evening\": \"Travel home\",\n                \"tips\": \"Pack souvenirs carefully, confirm flight times\"\n            }\n        else:\n            # Assign activities to middle days\n            activity_idx = (day - 2) % len(activities) if activities else 0\n            activity_name = activities[activity_idx] if activities else \"Local exploration\"\n            \n            day_plan = {\n                \"day\": day,\n                \"theme\": f\"Adventure Day - {activity_name}\",\n                \"morning\": f\"Scheduled activity: {activity_name}\",\n                \"afternoon\": \"Lunch at local restaurant, free time for beach or pool\",\n                \"evening\": \"Explore local markets, dinner at recommended restaurant\",\n                \"tips\": \"Stay hydrated, bring sunscreen and camera\"\n            }\n        \n        itinerary[\"days\"].append(day_plan)\n    \n    return json.dumps(itinerary, indent=2)\n\n\nclass TravelPlannerAgent:\n    \"\"\"Autonomous AI agent for travel planning with LangChain agent executor.\"\"\"\n    \n    def __init__(self):\n        # Use GROQ_API_KEY environment variable\n        self.llm = ChatGroq(\n            model=\"llama-3.3-70b-versatile\",\n            temperature=0.7\n        )\n        \n        # Chat history for conversation memory\n        self.chat_history = ChatMessageHistory()\n        \n        # System message for the agent\n        self.system_message = \"\"\"You are an autonomous AI travel planning agent with access to powerful tools.\n\nYour Mission:\n- Understand user travel requests through natural language\n- Autonomously use available tools to gather comprehensive information\n- Make intelligent recommendations based on preferences, budget, and context\n- Remember and apply user preferences across conversations\n- Create complete, well-reasoned travel plans\n\nAvailable Tools:\n- search_flights: Find flight options with prices and schedules\n- search_hotels: Discover hotels matching preferences and budget\n- get_weather_forecast: Check weather for travel dates\n- search_activities: Find attractions and activities\n- calculate_trip_budget: Compute detailed cost breakdowns\n- save_user_preferences: Store preferences for future trips\n- get_user_preferences: Retrieve saved preferences\n- create_day_by_day_itinerary: Generate detailed daily plans\n- create_booking: Create a booking for a planned trip (use when user wants to book)\n\nAgent Behavior:\n1. **Always start by checking saved preferences** using get_user_preferences\n2. **Extract key information** from user request (destination, budget, dates, interests)\n3. **Use tools autonomously** to gather flights, hotels, weather, activities\n4. **Make smart decisions** - select best options considering budget and preferences\n5. **Calculate budgets** to ensure plans fit constraints\n6. **Create itineraries** with day-by-day details\n7. **Save new preferences** when user mentions them\n8. **Be proactive** - if user mentions they \"love adventure\", save it and suggest adventure activities\n9. **Offer booking** - When user expresses interest in booking or says \"book this\", use create_booking tool\n10. **Extract booking details** - From the conversation, extract destination, dates, passengers, and price for booking\n\nResponse Format:\n- Use clear headings and sections\n- Present options with details (prices, ratings, times)\n- Explain your reasoning\n- Provide alternatives\n- Be enthusiastic and helpful!\n\nRemember: You have autonomy to use multiple tools in sequence to build complete travel plans!\"\"\"\n        \n        # Create tools list\n        self.tools = [\n            search_flights,\n            search_hotels,\n            get_weather_forecast,\n            search_activities,\n            calculate_trip_budget,\n            save_user_preferences,\n            get_user_preferences,\n            create_day_by_day_itinerary,\n            create_booking\n        ]\n        \n        # Create the agent\n        self.agent_executor = self._create_agent_executor()\n    \n    def _create_agent_executor(self):\n        \"\"\"Create the LangGraph agent with tools.\"\"\"\n        # Create the agent using LangGraph's create_react_agent\n        # Note: create_react_agent doesn't accept a prompt parameter\n        # System message will be included in messages when invoking\n        agent_executor = create_react_agent(\n            self.llm,\n            self.tools\n        )\n        \n        return agent_executor\n    \n    def plan_trip(self, user_request: str) -> Dict[str, Any]:\n        \"\"\"Process user travel request using the autonomous agent.\"\"\"\n        try:\n            # Prepare chat history for the agent\n            chat_history_messages = list(self.chat_history.messages)\n            \n            # Check if system message is already in history\n            has_system_message = any(isinstance(msg, SystemMessage) for msg in chat_history_messages)\n            \n            # Include system message at the beginning if not already in history\n            messages = []\n            if not has_system_message:\n                messages.append(SystemMessage(content=self.system_message))\n            messages.extend(chat_history_messages)\n            messages.append(HumanMessage(content=user_request))\n            \n            # Invoke the agent with LangGraph\n            result = self.agent_executor.invoke({\n                \"messages\": messages\n            })\n            \n            # Extract the final response - get the last AI message\n            final_message = None\n            for msg in reversed(result[\"messages\"]):\n                if isinstance(msg, AIMessage):\n                    final_message = msg\n                    break\n            \n            if not final_message:\n                # Fallback to last message\n                final_message = result[\"messages\"][-1]\n            \n            # Handle different response formats\n            if hasattr(final_message, 'content'):\n                content = final_message.content\n                # If content is a list (Gemini format), extract text from it\n                if isinstance(content, list):\n                    response_text = \"\"\n                    for item in content:\n                        if isinstance(item, dict) and 'text' in item:\n                            response_text += item['text']\n                        elif isinstance(item, str):\n                            response_text += item\n                else:\n                    response_text = str(content) if content else \"I'm processing your request...\"\n            else:\n                response_text = str(final_message) if final_message else \"I'm processing your request...\"\n            \n            # Clean up response text\n            if not response_text or response_text.strip() == \"\":\n                response_text = \"I've processed your request. How can I help you further?\"\n            \n            # Add to chat history\n            self.chat_history.add_user_message(user_request)\n            self.chat_history.add_ai_message(response_text)\n            \n            return {\n                \"status\": \"success\",\n                \"request\": user_request,\n                \"response\": response_text\n            }\n            \n        except Exception as e:\n            error_msg = f\"I encountered an error while planning: {str(e)}\\n\\nPlease try rephrasing your request or provide more details.\"\n            return {\n                \"status\": \"error\",\n                \"request\": user_request,\n                \"error\": str(e),\n                \"response\": error_msg\n            }\n    \n    def reset_memory(self):\n        \"\"\"Clear conversation history.\"\"\"\n        self.chat_history.clear()\n    \n    def get_conversation_history(self) -> List[Dict[str, str]]:\n        \"\"\"Get formatted conversation history.\"\"\"\n        messages = []\n        for msg in self.chat_history.messages:\n            messages.append({\n                \"role\": \"assistant\" if isinstance(msg, AIMessage) else \"user\",\n                \"content\": msg.content\n            })\n        return messages\n","size_bytes":24286},"README.md":{"content":"# Travel Planner AI Agent\n\n## Overview\n\nAn autonomous AI-powered travel planning application that uses natural language processing to create complete travel itineraries. The system leverages LangGraph's reactive agent framework to orchestrate multiple specialized tools, enabling multi-step reasoning and intelligent decision-making. Users interact through a conversational web interface where they can request travel plans in natural language, and the AI agent autonomously researches flights, hotels, activities, weather, and budgets to generate comprehensive itineraries.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Application Architecture\n**Pattern**: Monolithic backend with static frontend\n- **Backend**: FastAPI server exposing REST API endpoints\n- **Frontend**: Vanilla JavaScript single-page application (no framework)\n- **Deployment**: Self-contained Python application with embedded static file serving\n\n**Rationale**: Simplifies deployment and reduces complexity. FastAPI provides async capabilities and automatic API documentation. Vanilla JS keeps the frontend lightweight and eliminates build tooling requirements.\n\n### AI Agent Architecture\n**Framework**: LangGraph with ReAct (Reasoning + Acting) pattern\n- **Agent Type**: `create_react_agent` - autonomous multi-step planning agent\n- **LLM Provider**: Google Gemini AI (gemini-2.5-flash or gemini-2.5-pro models)\n- **Tool Orchestration**: LLM decides which tools to invoke and in what sequence\n- **Memory Management**: ChatMessageHistory maintains conversation context across interactions\n\n**Rationale**: LangGraph's ReAct agent enables true autonomous behavior where the LLM reasons about which actions to take. This allows the agent to chain multiple tools (e.g., search flights → check weather → find hotels → calculate budget) without hardcoded workflows. Google Gemini provides cost-effective, high-quality language understanding.\n\n### Tool System\n**Pattern**: Decorator-based tool registry with typed inputs\n- **Implementation**: LangChain `@tool` decorators for function-to-tool conversion\n- **Tool Count**: 8 specialized tools covering different travel planning domains\n- **Type Safety**: Pydantic validation for tool parameters\n\n**Tools**:\n1. `search_flights` - Flight search with pricing\n2. `search_hotels` - Accommodation discovery\n3. `get_weather_forecast` - Weather data retrieval\n4. `search_activities` - Local attractions/experiences\n5. `calculate_trip_budget` - Cost estimation\n6. `save_user_preferences` - Preference persistence\n7. `get_user_preferences` - Preference retrieval\n8. `create_day_by_day_itinerary` - Daily schedule generation\n\n**Rationale**: Modular tool design allows the agent to compose complex plans from simple building blocks. Each tool has a single responsibility, making them easier to test and maintain. The decorator pattern provides automatic schema generation for the LLM.\n\n### State Management\n**Pattern**: Hybrid - in-memory for conversations, global store for preferences\n- **Conversation Memory**: ChatMessageHistory (per-session, ephemeral)\n- **User Preferences**: Python dictionary (global, in-memory)\n- **No Database**: Current implementation uses in-process storage\n\n**Rationale**: For prototyping and demos, in-memory storage eliminates database setup complexity. Conversation history only needs to persist during active sessions. User preferences are stored globally to enable cross-session personalization.\n\n**Production Consideration**: The global `user_preferences_store` dictionary would need migration to persistent storage (database, Redis, etc.) for production deployments to handle multiple users and server restarts.\n\n### API Design\n**Pattern**: RESTful JSON API with single planning endpoint\n- **Endpoint**: `POST /api/plan` - accepts natural language queries\n- **Request Format**: JSON with `query` field\n- **Response Format**: Structured JSON with status, response, request echo, and error fields\n\n**Rationale**: Simple API surface reduces integration complexity. Single endpoint handles all travel planning queries since the agent's autonomous nature allows it to interpret diverse intents from natural language.\n\n### Frontend Architecture\n**Pattern**: Static file serving with client-side rendering\n- **No Build Process**: Direct HTML/CSS/JS files served via FastAPI StaticFiles\n- **Real-time Updates**: Fetch API for async backend communication\n- **Responsive Design**: CSS-based responsive layout without frameworks\n\n**Rationale**: Zero build complexity speeds development iteration. Modern browsers handle vanilla JS efficiently. Gradient-based UI design provides visual appeal without heavy CSS frameworks.\n\n## External Dependencies\n\n### AI/ML Services\n- **Google Gemini AI**: Primary LLM provider via `langchain_google_genai`\n  - Models: gemini-2.5-flash or gemini-2.5-pro\n  - Requires: `GEMINI_API_KEY` environment variable (passed as `google_api_key` parameter)\n  - Purpose: Natural language understanding, reasoning, tool selection\n  - Migration Note (Nov 2025): Migrated from OpenAI to Google Gemini for cost-effective AI credits\n\n### Python Frameworks\n- **FastAPI**: Web framework for REST API\n  - Provides async request handling and automatic OpenAPI documentation\n  \n- **Uvicorn**: ASGI server for running FastAPI application\n  - Production-ready async server\n\n- **LangGraph**: Agent orchestration framework\n  - Enables reactive agent pattern with multi-step reasoning\n  \n- **LangChain**: LLM application framework\n  - Provides tool abstraction, prompt templates, message history\n  - Components: `langchain_core`, `langchain_community`\n\n- **Pydantic**: Data validation and settings management\n  - Validates API request/response models\n  - Provides type safety for tool parameters\n\n### Data Storage\n**Current**: In-memory Python dictionaries\n- No external database configured\n- `user_preferences_store`: global dictionary for user preferences\n- `ChatMessageHistory`: per-session conversation storage\n\n**Future Consideration**: System is designed to swap in persistent storage (PostgreSQL, MongoDB, Redis) by replacing the global dictionary with database calls in the preference save/get tools.\n\n### Static Assets\n- **No CDN dependencies**: All CSS/JS is inline or self-hosted\n- **No frontend framework**: Pure HTML5/CSS3/JavaScript\n- **No external fonts or libraries**: Self-contained design\n\n## Installation & Setup\n\n### Prerequisites\n- Python 3.11 or higher\n- pip (Python package manager)\n- (Optional) Docker and Docker Compose for containerized deployment\n\n### Quick Start\n\n1. **Clone the repository**\n   ```bash\n   git clone <repository-url>\n   cd AI\n   ```\n\n2. **Install dependencies**\n   ```bash\n   # Using pip\n   pip install -r requirements.txt\n   \n   # Or use the build script\n   chmod +x build.sh\n   ./build.sh\n   \n   # Or use Make\n   make install\n   ```\n\n3. **Configure environment variables**\n   ```bash\n   cp .env.example .env\n   # Edit .env and add your API keys:\n   # - GROQ_API_KEY (required for AI features)\n   # - STRIPE_SECRET_KEY (required for payments)\n   # - DATABASE_URL (optional, defaults to SQLite)\n   ```\n\n4. **Run the application**\n   ```bash\n   python3 main.py\n   \n   # Or use Make\n   make run\n   ```\n\n5. **Access the application**\n   - Open your browser to `http://localhost:5000`\n   - API documentation available at `http://localhost:5000/docs`\n\n### Docker Deployment\n\n1. **Build and run with Docker Compose**\n   ```bash\n   docker-compose up --build\n   ```\n   \n   This will start:\n   - Web application on port 5000\n   - PostgreSQL database on port 5432\n\n2. **Or build Docker image manually**\n   ```bash\n   docker build -t travel-planner-ai .\n   docker run -p 5000:5000 --env-file .env travel-planner-ai\n   ```\n\n### Environment Variables\n\nCreate a `.env` file in the project root with the following variables:\n\n```env\n# Database (optional - defaults to SQLite)\nDATABASE_URL=postgresql://user:password@localhost:5432/traveldb\n\n# AI Agent (required for AI features)\nGROQ_API_KEY=your_groq_api_key_here\n\n# Stripe (required for payments)\nSTRIPE_SECRET_KEY=your_stripe_secret_key_here\nSTRIPE_PUBLISHABLE_KEY=your_stripe_publishable_key_here\n```\n\n## Build Commands\n\n### Using Make\n```bash\nmake install      # Install dependencies\nmake run          # Run the application\nmake build        # Build the application\nmake docker-build # Build Docker image\nmake docker-up    # Start Docker containers\nmake docker-down  # Stop Docker containers\nmake clean        # Clean build artifacts\n```\n\n### Using Build Script\n```bash\n./build.sh        # Automated build and setup\n```\n\n## Features\n\n### ✅ Implemented\n- 🤖 AI-powered travel planning with natural language queries\n- ✈️ Flight and hotel search simulation\n- 🌤️ Weather forecasting\n- 🎯 Activity recommendations\n- 💰 Budget calculation\n- 📅 Itinerary creation and calendar management\n- 💳 Complete booking system with Stripe integration\n- 🗄️ Database persistence for bookings and itineraries\n- 📋 User preference management\n- 🔒 Secure payment processing\n\n### 🚀 Production Ready\n- Database-backed storage (SQLite/PostgreSQL)\n- Docker containerization\n- Health check endpoints\n- Error handling and validation\n- Server-side price validation\n- Secure payment processing\n\n## API Endpoints\n\n- `GET /` - Main web interface\n- `POST /api/plan` - AI travel planning\n- `GET /api/bookings` - List all bookings\n- `POST /api/bookings` - Create new booking\n- `GET /api/bookings/{id}` - Get booking details\n- `POST /api/create-checkout-session` - Create Stripe payment session\n- `GET /api/itineraries` - List all itineraries\n- `POST /api/itineraries` - Save itinerary\n- `GET /health` - Health check\n\nFull API documentation available at `/docs` when server is running.\n\n## Development\n\n### Project Structure\n```\n.\n├── main.py              # FastAPI application\n├── database.py          # Database models and setup\n├── agent/\n│   └── travel_agent.py  # AI agent implementation\n├── static/\n│   ├── index.html       # Frontend HTML\n│   ├── app.js           # Frontend JavaScript\n│   └── styles.css       # Frontend styles\n├── requirements.txt     # Python dependencies\n├── Dockerfile           # Docker configuration\n├── docker-compose.yml   # Docker Compose setup\n└── .env.example         # Environment variables template\n```\n\n## License\n\nThis project is part of a hackathon submission.","size_bytes":10464},"build.sh":{"content":"#!/bin/bash\n\n# Build script for Travel Planner AI Agent\n\nset -e\n\necho \"🚀 Building Travel Planner AI Agent...\"\n\n# Check if Python is installed\nif ! command -v python3 &> /dev/null; then\n    echo \"❌ Python 3 is not installed. Please install Python 3.11 or higher.\"\n    exit 1\nfi\n\n# Check Python version\nPYTHON_VERSION=$(python3 --version | cut -d' ' -f2 | cut -d'.' -f1,2)\nREQUIRED_VERSION=\"3.11\"\n\nif [ \"$(printf '%s\\n' \"$REQUIRED_VERSION\" \"$PYTHON_VERSION\" | sort -V | head -n1)\" != \"$REQUIRED_VERSION\" ]; then\n    echo \"❌ Python 3.11 or higher is required. Current version: $PYTHON_VERSION\"\n    exit 1\nfi\n\n# Create virtual environment if it doesn't exist\nif [ ! -d \"venv\" ]; then\n    echo \"📦 Creating virtual environment...\"\n    python3 -m venv venv\nfi\n\n# Activate virtual environment\necho \"🔌 Activating virtual environment...\"\nsource venv/bin/activate\n\n# Upgrade pip\necho \"⬆️  Upgrading pip...\"\npip install --upgrade pip\n\n# Install dependencies\necho \"📥 Installing dependencies...\"\npip install -r requirements.txt\n\n# Create data directory\nmkdir -p data\n\n# Check for .env file\nif [ ! -f \".env\" ]; then\n    echo \"⚠️  Warning: .env file not found. Creating from .env.example...\"\n    if [ -f \".env.example\" ]; then\n        cp .env.example .env\n        echo \"✅ Created .env file. Please update it with your API keys.\"\n    else\n        echo \"⚠️  .env.example not found. Please create .env file manually.\"\n    fi\nfi\n\necho \"✅ Build complete!\"\necho \"\"\necho \"To run the application:\"\necho \"  source venv/bin/activate\"\necho \"  python3 main.py\"\necho \"\"\necho \"Or use Docker:\"\necho \"  docker-compose up --build\"\n\n","size_bytes":1631},"database.py":{"content":"import os\nfrom sqlalchemy import create_engine, Column, Integer, String, Float, DateTime, Text, JSON\nfrom sqlalchemy.ext.declarative import declarative_base\nfrom sqlalchemy.orm import sessionmaker\nfrom datetime import datetime\n\nDATABASE_URL = os.environ.get(\"DATABASE_URL\")\n\nif not DATABASE_URL:\n    DATABASE_URL = \"sqlite:///./travel_planner.db\"\n\n# Set connect_args based on database type\nconnect_args = {}\nif DATABASE_URL and DATABASE_URL.startswith(\"sqlite\"):\n    connect_args = {\"check_same_thread\": False}\n\nengine = create_engine(\n    DATABASE_URL,\n    pool_pre_ping=True,\n    pool_recycle=300,\n    connect_args=connect_args\n)\n\nSessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)\nBase = declarative_base()\n\nclass Itinerary(Base):\n    __tablename__ = \"itineraries\"\n    \n    id = Column(Integer, primary_key=True, index=True)\n    user_id = Column(String, default=\"default_user\", index=True)\n    trip_name = Column(String, nullable=False)\n    destination = Column(String, nullable=False)\n    start_date = Column(String, nullable=False)\n    end_date = Column(String, nullable=False)\n    duration_days = Column(Integer)\n    budget = Column(Float)\n    description = Column(Text)\n    itinerary_data = Column(JSON)\n    created_at = Column(DateTime, default=datetime.utcnow)\n    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)\n\nclass Booking(Base):\n    __tablename__ = \"bookings\"\n    \n    id = Column(Integer, primary_key=True, index=True)\n    booking_id = Column(String, unique=True, index=True, nullable=False)\n    user_id = Column(String, default=\"default_user\", index=True)\n    trip_id = Column(String, nullable=False)\n    trip_name = Column(String, nullable=False)\n    destination = Column(String, nullable=False)\n    start_date = Column(String, nullable=False)\n    end_date = Column(String, nullable=False)\n    base_price = Column(Float, nullable=False)\n    total_price = Column(Float, nullable=False)\n    passengers = Column(Integer, nullable=False)\n    email = Column(String)\n    flight_details = Column(JSON)\n    hotel_details = Column(JSON)\n    special_requests = Column(Text)\n    status = Column(String, default=\"pending\", index=True)  # pending, confirmed, cancelled, completed\n    payment_status = Column(String, default=\"unpaid\", index=True)  # unpaid, paid, refunded\n    stripe_session_id = Column(String)\n    created_at = Column(DateTime, default=datetime.utcnow)\n    confirmed_at = Column(DateTime)\n    cancelled_at = Column(DateTime)\n    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)\n\nclass CalendarEvent(Base):\n    __tablename__ = \"calendar_events\"\n    \n    id = Column(Integer, primary_key=True, index=True)\n    user_id = Column(String, default=\"default_user\", index=True)\n    title = Column(String, nullable=False)\n    description = Column(Text)\n    start_date = Column(String, nullable=False)\n    end_date = Column(String, nullable=False)\n    start_time = Column(String)  # Optional time in HH:MM format\n    end_time = Column(String)  # Optional time in HH:MM format\n    all_day = Column(String, default=\"true\")  # \"true\" or \"false\" as string\n    event_type = Column(String, default=\"personal\")  # personal, trip, booking, reminder\n    tags = Column(JSON)  # Array of tag strings\n    color = Column(String, default=\"#6366f1\")  # Hex color code\n    booking_id = Column(String)  # Link to booking if applicable\n    reminder_enabled = Column(String, default=\"false\")  # \"true\" or \"false\"\n    reminder_time = Column(String)  # e.g., \"1 day before\", \"1 hour before\"\n    created_at = Column(DateTime, default=datetime.utcnow)\n    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)\n\ndef init_db():\n    Base.metadata.create_all(bind=engine)\n\ndef get_db():\n    db = SessionLocal()\n    try:\n        yield db\n    finally:\n        db.close()\n","size_bytes":3870},"static/calendar-dynamic.css":{"content":"/* Dynamic Google Calendar-Style UI */\n\n/* Calendar Page Header */\n.calendar-page-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-start;\n    margin-bottom: 2rem;\n    padding: 2rem;\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.15) 0%, rgba(236, 72, 153, 0.15) 50%, rgba(168, 85, 247, 0.15) 100%);\n    border-radius: 24px;\n    border: 2px solid transparent;\n    background-clip: padding-box;\n    position: relative;\n    overflow: hidden;\n    animation: fadeInDown 0.5s ease-out;\n    box-shadow: 0 8px 32px rgba(99, 102, 241, 0.2), 0 0 0 1px rgba(99, 102, 241, 0.1);\n}\n\n.calendar-page-header::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);\n    opacity: 0.1;\n    z-index: -1;\n    animation: gradientFloat 8s ease-in-out infinite;\n}\n\n@keyframes gradientFloat {\n    0%, 100% { transform: translateY(0) scale(1); opacity: 0.1; }\n    50% { transform: translateY(-10px) scale(1.05); opacity: 0.15; }\n}\n\n.calendar-header-left {\n    flex: 1;\n}\n\n.calendar-main-title {\n    font-size: 3rem;\n    font-weight: 900;\n    margin: 0 0 0.5rem 0;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #ec4899 75%, #667eea 100%);\n    background-size: 200% auto;\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n    animation: gradientShift 4s linear infinite;\n    letter-spacing: -0.02em;\n    text-shadow: 0 4px 20px rgba(99, 102, 241, 0.3);\n    filter: drop-shadow(0 0 30px rgba(99, 102, 241, 0.4));\n}\n\n@keyframes gradientShift {\n    0% { background-position: 0% 50%; }\n    100% { background-position: 200% 50%; }\n}\n\n.calendar-subtitle {\n    font-size: 1.1rem;\n    color: var(--gray);\n    margin: 0;\n    font-weight: 500;\n}\n\n.calendar-header-actions {\n    display: flex;\n    gap: 1rem;\n    align-items: center;\n}\n\n.calendar-action-btn {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.75rem 1.5rem;\n    border: none;\n    border-radius: 12px;\n    font-weight: 600;\n    font-size: 1rem;\n    cursor: pointer;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.calendar-today-btn {\n    background: white;\n    color: var(--primary);\n    border: 2px solid var(--primary);\n}\n\n.calendar-today-btn:hover {\n    background: var(--primary);\n    color: white;\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);\n}\n\n.calendar-add-btn {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    position: relative;\n    overflow: hidden;\n}\n\n.calendar-add-btn::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);\n    transition: left 0.5s;\n}\n\n.calendar-add-btn:hover::before {\n    left: 100%;\n}\n\n.calendar-add-btn:hover {\n    transform: translateY(-3px) scale(1.05);\n    box-shadow: 0 8px 24px rgba(99, 102, 241, 0.5), 0 0 40px rgba(99, 102, 241, 0.3);\n}\n\n.calendar-add-btn:active {\n    transform: translateY(-1px) scale(1.02);\n}\n\n/* View Selector - Enhanced */\n.calendar-view-selector {\n    display: flex;\n    gap: 0.5rem;\n    margin-bottom: 1.5rem;\n    background: rgba(255, 255, 255, 0.9);\n    backdrop-filter: blur(10px);\n    padding: 0.6rem;\n    border-radius: 16px;\n    box-shadow: \n        0 4px 16px rgba(99, 102, 241, 0.12),\n        inset 0 1px 1px rgba(255, 255, 255, 0.8);\n    animation: fadeInUp 0.5s ease-out 0.1s both;\n    border: 1px solid rgba(99, 102, 241, 0.1);\n}\n\n.view-btn {\n    flex: 1;\n    padding: 0.75rem 1.5rem;\n    border: none;\n    background: transparent;\n    border-radius: 8px;\n    font-weight: 600;\n    font-size: 0.95rem;\n    color: var(--gray);\n    cursor: pointer;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    position: relative;\n    overflow: hidden;\n}\n\n.view-btn::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.1), transparent);\n    transition: left 0.5s;\n}\n\n.view-btn:hover::before {\n    left: 100%;\n}\n\n.view-btn:hover {\n    color: var(--primary);\n    background: rgba(99, 102, 241, 0.05);\n}\n\n.view-btn.active {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    box-shadow: \n        0 4px 12px rgba(99, 102, 241, 0.4),\n        0 0 20px rgba(99, 102, 241, 0.2),\n        inset 0 1px 1px rgba(255, 255, 255, 0.2);\n    transform: scale(1.05);\n}\n\n/* Calendar Wrapper - Glassmorphism */\n.calendar-wrapper {\n    background: rgba(255, 255, 255, 0.85);\n    backdrop-filter: blur(20px);\n    -webkit-backdrop-filter: blur(20px);\n    border-radius: 24px;\n    padding: 2.5rem;\n    box-shadow: \n        0 8px 32px rgba(99, 102, 241, 0.15),\n        0 0 0 1px rgba(255, 255, 255, 0.18),\n        inset 0 1px 1px rgba(255, 255, 255, 0.9);\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n    animation: fadeInUp 0.5s ease-out 0.2s both;\n    position: relative;\n    overflow: hidden;\n    border: 1px solid rgba(99, 102, 241, 0.1);\n}\n\n.calendar-wrapper::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 5px;\n    background: linear-gradient(90deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #ec4899 75%, #667eea 100%);\n    background-size: 200% auto;\n    animation: slideInLeft 0.6s ease-out 0.3s forwards, gradientShift 3s linear infinite;\n    border-radius: 24px 24px 0 0;\n}\n\n.calendar-wrapper:hover {\n    transform: translateY(-4px);\n    box-shadow: \n        0 12px 48px rgba(99, 102, 241, 0.25),\n        0 0 0 1px rgba(255, 255, 255, 0.2),\n        inset 0 1px 1px rgba(255, 255, 255, 1);\n}\n\n.calendar-container {\n    position: relative;\n    min-height: 600px;\n}\n\n/* Stats Cards */\n.calendar-stats {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 1.5rem;\n    margin-top: 2rem;\n    animation: fadeInUp 0.5s ease-out 0.4s both;\n}\n\n.stat-card {\n    display: flex;\n    align-items: center;\n    gap: 1.5rem;\n    padding: 2rem;\n    background: rgba(255, 255, 255, 0.9);\n    backdrop-filter: blur(10px);\n    border-radius: 20px;\n    box-shadow: \n        0 4px 20px rgba(99, 102, 241, 0.1),\n        inset 0 1px 1px rgba(255, 255, 255, 0.8);\n    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);\n    border: 2px solid rgba(99, 102, 241, 0.1);\n    position: relative;\n    overflow: hidden;\n}\n\n.stat-card::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 5px;\n    height: 100%;\n    background: linear-gradient(180deg, #667eea 0%, #764ba2 50%, #f093fb 100%);\n    transform: scaleY(0);\n    transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);\n}\n\n.stat-card::after {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 0;\n    height: 0;\n    border-radius: 50%;\n    background: radial-gradient(circle, rgba(99, 102, 241, 0.1) 0%, transparent 70%);\n    transform: translate(-50%, -50%);\n    transition: width 0.6s, height 0.6s;\n}\n\n.stat-card:hover {\n    transform: translateY(-6px) scale(1.02);\n    box-shadow: \n        0 12px 32px rgba(99, 102, 241, 0.2),\n        0 0 40px rgba(99, 102, 241, 0.15),\n        inset 0 1px 1px rgba(255, 255, 255, 1);\n    border-color: rgba(99, 102, 241, 0.3);\n}\n\n.stat-card:hover::before {\n    transform: scaleY(1);\n}\n\n.stat-card:hover::after {\n    width: 300px;\n    height: 300px;\n}\n\n.stat-icon {\n    font-size: 2.8rem;\n    width: 70px;\n    height: 70px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.15) 0%, rgba(168, 85, 247, 0.15) 50%, rgba(236, 72, 153, 0.15) 100%);\n    border-radius: 16px;\n    animation: float 3s ease-in-out infinite;\n    box-shadow: \n        0 4px 16px rgba(99, 102, 241, 0.15),\n        inset 0 1px 1px rgba(255, 255, 255, 0.5);\n    position: relative;\n    overflow: hidden;\n}\n\n.stat-icon::before {\n    content: '';\n    position: absolute;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.3) 50%, transparent 70%);\n    animation: iconShine 3s linear infinite;\n}\n\n@keyframes iconShine {\n    0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }\n    100% { transform: translateX(100%) translateY(100%) rotate(45deg); }\n}\n\n.stat-info {\n    flex: 1;\n}\n\n.stat-value {\n    font-size: 2.5rem;\n    font-weight: 900;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n    line-height: 1;\n    margin-bottom: 0.25rem;\n    filter: drop-shadow(0 2px 4px rgba(99, 102, 241, 0.2));\n}\n\n.stat-label {\n    font-size: 0.9rem;\n    color: var(--gray);\n    font-weight: 500;\n}\n\n/* Enhanced FullCalendar Styles */\n.fc-header-toolbar {\n    margin-bottom: 1.5rem;\n    padding: 1rem 0;\n    border-bottom: 2px solid rgba(99, 102, 241, 0.1);\n    animation: fadeIn 0.6s ease-out;\n}\n\n.fc-toolbar-title {\n    font-size: 1.75rem !important;\n    font-weight: 700 !important;\n    color: var(--dark) !important;\n    text-transform: capitalize;\n}\n\n.fc-button-group {\n    display: flex;\n    gap: 0.5rem;\n}\n\n.fc-button {\n    padding: 0.6rem 1.2rem !important;\n    border-radius: 10px !important;\n    font-weight: 600 !important;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;\n    box-shadow: 0 2px 8px rgba(99, 102, 241, 0.2) !important;\n}\n\n.fc-button:hover {\n    transform: translateY(-2px) !important;\n    box-shadow: 0 4px 16px rgba(99, 102, 241, 0.4) !important;\n}\n\n.fc-daygrid-day {\n    transition: all 0.2s ease;\n    position: relative;\n}\n\n.fc-daygrid-day:hover {\n    background: rgba(99, 102, 241, 0.05) !important;\n    transform: scale(1.02);\n    z-index: 1;\n}\n\n.fc-day-today {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.15) 0%, rgba(236, 72, 153, 0.1) 100%) !important;\n    border: 2px solid var(--primary) !important;\n    box-shadow: inset 0 0 15px rgba(99, 102, 241, 0.1);\n    animation: pulseToday 2s ease-in-out infinite;\n}\n\n.fc-day-today .fc-daygrid-day-number {\n    background: var(--primary) !important;\n    color: white !important;\n    border-radius: 50% !important;\n    width: 2.5rem !important;\n    height: 2.5rem !important;\n    display: flex !important;\n    align-items: center !important;\n    justify-content: center !important;\n    font-weight: 700 !important;\n    box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3);\n}\n\n.fc-event {\n    border-radius: 8px !important;\n    padding: 6px 10px !important;\n    border: 2px solid rgba(255, 255, 255, 0.3) !important;\n    font-weight: 600 !important;\n    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2) !important;\n    margin: 3px 2px !important;\n    backdrop-filter: blur(4px);\n    position: relative;\n    overflow: hidden;\n    animation: eventSlideIn 0.3s ease-out;\n}\n\n.fc-event::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 4px;\n    height: 100%;\n    background: rgba(255, 255, 255, 0.6);\n    animation: shimmer 2s infinite;\n}\n\n.fc-event:hover {\n    transform: translateY(-3px) scale(1.03) !important;\n    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3) !important;\n    z-index: 10 !important;\n    border-color: rgba(255, 255, 255, 0.7) !important;\n}\n\n/* Dark Mode */\n[data-theme=\"dark\"] .calendar-page-header {\n    background: rgba(99, 102, 241, 0.15);\n    border-color: rgba(99, 102, 241, 0.3);\n}\n\n[data-theme=\"dark\"] .calendar-view-selector {\n    background: #1e293b;\n}\n\n[data-theme=\"dark\"] .calendar-wrapper {\n    background: #1e293b;\n    border: 1px solid #334155;\n}\n\n[data-theme=\"dark\"] .stat-card {\n    background: #1e293b;\n    border-color: #334155;\n}\n\n[data-theme=\"dark\"] .stat-card:hover {\n    border-color: var(--primary);\n}\n\n[data-theme=\"dark\"] .calendar-today-btn {\n    background: #334155;\n    color: var(--dark);\n    border-color: var(--primary);\n}\n\n[data-theme=\"dark\"] .view-btn {\n    color: #cbd5e1;\n}\n\n[data-theme=\"dark\"] .view-btn:hover {\n    background: rgba(99, 102, 241, 0.1);\n    color: var(--dark);\n}\n\n/* Animations */\n@keyframes fadeInDown {\n    from {\n        opacity: 0;\n        transform: translateY(-20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n@keyframes fadeInUp {\n    from {\n        opacity: 0;\n        transform: translateY(20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n@keyframes fadeIn {\n    from {\n        opacity: 0;\n    }\n    to {\n        opacity: 1;\n    }\n}\n\n@keyframes slideInLeft {\n    from {\n        transform: scaleX(0);\n    }\n    to {\n        transform: scaleX(1);\n    }\n}\n\n@keyframes gradientShift {\n    0%, 100% {\n        background-position: 0% 50%;\n    }\n    50% {\n        background-position: 100% 50%;\n    }\n}\n\n@keyframes float {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(-10px);\n    }\n}\n\n@keyframes pulseToday {\n    0%, 100% {\n        box-shadow: inset 0 0 15px rgba(99, 102, 241, 0.1);\n    }\n    50% {\n        box-shadow: inset 0 0 20px rgba(99, 102, 241, 0.2);\n    }\n}\n\n@keyframes eventSlideIn {\n    from {\n        opacity: 0;\n        transform: translateX(-10px);\n    }\n    to {\n        opacity: 1;\n        transform: translateX(0);\n    }\n}\n\n@keyframes shimmer {\n    0% {\n        opacity: 0.6;\n    }\n    50% {\n        opacity: 1;\n    }\n    100% {\n        opacity: 0.6;\n    }\n}\n\n/* Mobile Responsive */\n@media (max-width: 768px) {\n    .calendar-page-header {\n        flex-direction: column;\n        gap: 1rem;\n    }\n    \n    .calendar-header-actions {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .calendar-action-btn {\n        flex: 1;\n        justify-content: center;\n    }\n    \n    .calendar-view-selector {\n        flex-wrap: wrap;\n    }\n    \n    .view-btn {\n        flex: 1 1 calc(50% - 0.25rem);\n        min-width: 80px;\n    }\n    \n    .calendar-stats {\n        grid-template-columns: 1fr;\n    }\n    \n    .calendar-main-title {\n        font-size: 2rem;\n    }\n}\n\n","size_bytes":14252},"static/plan-trip-styles.css":{"content":"/* Plan Trip Page - Enhanced Styling */\n\n/* Chat Container with Glassmorphism */\n.chat-container {\n    max-width: 1400px;\n    margin: 2rem auto;\n    padding: 2rem;\n    animation: fadeInUp 0.6s ease-out;\n}\n\n.chat-box {\n    background: rgba(255, 255, 255, 0.9);\n    backdrop-filter: blur(20px);\n    -webkit-backdrop-filter: blur(20px);\n    border-radius: 24px;\n    box-shadow: \n        0 8px 32px rgba(99, 102, 241, 0.15),\n        0 0 0 1px rgba(255, 255, 255, 0.18),\n        inset 0 1px 1px rgba(255, 255, 255, 0.9);\n    overflow: hidden;\n    border: 1px solid rgba(99, 102, 241, 0.1);\n    position: relative;\n}\n\n.chat-box::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 5px;\n    background: linear-gradient(90deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #ec4899 75%, #667eea 100%);\n    background-size: 200% auto;\n    animation: gradientShift 3s linear infinite;\n}\n\n@keyframes gradientShift {\n    0% { background-position: 0% 50%; }\n    100% { background-position: 200% 50%; }\n}\n\n/* Chat Header with Gradient */\n.chat-header {\n    padding: 2rem 2.5rem;\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.12) 0%, rgba(168, 85, 247, 0.1) 50%, rgba(236, 72, 153, 0.1) 100%);\n    border-bottom: 1px solid rgba(99, 102, 241, 0.15);\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    gap: 1rem;\n    flex-wrap: wrap;\n    position: relative;\n    overflow: hidden;\n}\n\n.chat-header::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: linear-gradient(135deg, transparent 0%, rgba(99, 102, 241, 0.05) 100%);\n    animation: headerFloat 8s ease-in-out infinite;\n}\n\n@keyframes headerFloat {\n    0%, 100% { transform: translateY(0); opacity: 0.5; }\n    50% { transform: translateY(-10px); opacity: 1; }\n}\n\n.chat-header > div {\n    position: relative;\n    z-index: 1;\n}\n\n.chat-header span {\n    font-size: 1.5rem;\n    font-weight: 800;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n    display: inline-flex;\n    align-items: center;\n    gap: 0.75rem;\n    vertical-align: middle;\n}\n\n.chat-header > div:first-child {\n    flex: 1;\n    min-width: 200px;\n}\n\n/* SVG Icon Container */\n.icon-svg {\n    width: 28px;\n    height: 28px;\n    display: inline-block;\n    vertical-align: middle;\n    animation: iconFloat 3s ease-in-out infinite;\n}\n\n@keyframes iconFloat {\n    0%, 100% { transform: translateY(0); }\n    50% { transform: translateY(-5px); }\n}\n\n/* Chat Messages Area */\n.chat-messages {\n    min-height: 500px;\n    max-height: 600px;\n    overflow-y: auto;\n    padding: 2.5rem;\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.02) 0%, rgba(236, 72, 153, 0.02) 100%);\n    position: relative;\n}\n\n.chat-messages::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: \n        radial-gradient(circle at 20% 50%, rgba(99, 102, 241, 0.05) 0%, transparent 50%),\n        radial-gradient(circle at 80% 50%, rgba(236, 72, 153, 0.05) 0%, transparent 50%);\n    pointer-events: none;\n}\n\n/* Custom Scrollbar */\n.chat-messages::-webkit-scrollbar {\n    width: 10px;\n}\n\n.chat-messages::-webkit-scrollbar-track {\n    background: rgba(99, 102, 241, 0.05);\n    border-radius: 10px;\n}\n\n.chat-messages::-webkit-scrollbar-thumb {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    border-radius: 10px;\n    box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);\n}\n\n.chat-messages::-webkit-scrollbar-thumb:hover {\n    background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);\n}\n\n/* Message Bubbles - Enhanced */\n.message {\n    margin-bottom: 1.5rem;\n    animation: messageSlideIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);\n    opacity: 0;\n    animation-fill-mode: forwards;\n}\n\n@keyframes messageSlideIn {\n    from {\n        opacity: 0;\n        transform: translateY(20px) scale(0.95);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0) scale(1);\n    }\n}\n\n.message.user {\n    display: flex;\n    justify-content: flex-end;\n}\n\n.message.ai {\n    display: flex;\n    justify-content: flex-start;\n}\n\n.message-content {\n    max-width: 70%;\n    padding: 1.5rem 2rem;\n    border-radius: 20px;\n    position: relative;\n    overflow: hidden;\n    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.message-content::before {\n    content: '';\n    position: absolute;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%);\n    animation: messageShine 3s linear infinite;\n}\n\n@keyframes messageShine {\n    0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }\n    100% { transform: translateX(100%) translateY(100%) rotate(45deg); }\n}\n\n.message.user .message-content {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    border-bottom-right-radius: 6px;\n    box-shadow: \n        0 4px 16px rgba(99, 102, 241, 0.3),\n        inset 0 1px 1px rgba(255, 255, 255, 0.2);\n}\n\n.message.user .message-content:hover {\n    transform: translateY(-2px);\n    box-shadow: \n        0 8px 24px rgba(99, 102, 241, 0.4),\n        inset 0 1px 1px rgba(255, 255, 255, 0.3);\n}\n\n.message.ai .message-content {\n    background: rgba(255, 255, 255, 0.95);\n    backdrop-filter: blur(10px);\n    color: var(--dark);\n    border-bottom-left-radius: 6px;\n    border: 1px solid rgba(99, 102, 241, 0.1);\n    box-shadow: \n        0 4px 16px rgba(99, 102, 241, 0.12),\n        inset 0 1px 1px rgba(255, 255, 255, 0.8);\n}\n\n.message.ai .message-content:hover {\n    transform: translateY(-2px);\n    box-shadow: \n        0 8px 24px rgba(99, 102, 241, 0.2),\n        inset 0 1px 1px rgba(255, 255, 255, 1);\n}\n\n/* Typing Indicator - Enhanced */\n.typing-indicator {\n    display: flex;\n    gap: 0.4rem;\n    padding: 1rem 1.5rem;\n    background: rgba(255, 255, 255, 0.95);\n    backdrop-filter: blur(10px);\n    border-radius: 20px;\n    width: fit-content;\n    box-shadow: \n        0 4px 16px rgba(99, 102, 241, 0.12),\n        inset 0 1px 1px rgba(255, 255, 255, 0.8);\n    border: 1px solid rgba(99, 102, 241, 0.1);\n}\n\n.typing-indicator span {\n    width: 10px;\n    height: 10px;\n    border-radius: 50%;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    animation: typingBounce 1.4s infinite ease-in-out;\n}\n\n.typing-indicator span:nth-child(2) {\n    animation-delay: 0.2s;\n}\n\n.typing-indicator span:nth-child(3) {\n    animation-delay: 0.4s;\n}\n\n@keyframes typingBounce {\n    0%, 60%, 100% {\n        transform: translateY(0);\n        box-shadow: 0 0 0 rgba(99, 102, 241, 0);\n    }\n    30% {\n        transform: translateY(-10px);\n        box-shadow: 0 6px 12px rgba(99, 102, 241, 0.3);\n    }\n}\n\n/* Chat Input Area - Enhanced */\n.chat-input-area {\n    padding: 2rem 2.5rem;\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(236, 72, 153, 0.05) 100%);\n    border-top: 1px solid rgba(99, 102, 241, 0.1);\n}\n\n.chat-input-container {\n    display: flex;\n    align-items: stretch;\n    gap: 1rem;\n    margin-bottom: 1rem;\n}\n\n.chat-input {\n    flex: 1;\n    padding: 1.2rem 2rem;\n    border: 2px solid rgba(99, 102, 241, 0.2);\n    border-radius: 16px;\n    font-size: 1rem;\n    background: rgba(255, 255, 255, 0.95);\n    backdrop-filter: blur(10px);\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    box-shadow: \n        0 2px 8px rgba(99, 102, 241, 0.08),\n        inset 0 1px 1px rgba(255, 255, 255, 0.8);\n}\n\n.chat-input:focus {\n    outline: none;\n    border-color: var(--primary);\n    box-shadow: \n        0 0 0 4px rgba(99, 102, 241, 0.15),\n        0 4px 16px rgba(99, 102, 241, 0.2),\n        inset 0 1px 1px rgba(255, 255, 255, 1);\n    transform: translateY(-2px);\n}\n\n.chat-input::placeholder {\n    color: var(--gray);\n    opacity: 0.7;\n}\n\n/* Send Button - Enhanced */\n#send-btn {\n    padding: 1.2rem 2.5rem;\n    border-radius: 16px;\n    font-weight: 700;\n    font-size: 1rem;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    border: none;\n    cursor: pointer;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    box-shadow: \n        0 4px 12px rgba(99, 102, 241, 0.3),\n        inset 0 1px 1px rgba(255, 255, 255, 0.2);\n    position: relative;\n    overflow: hidden;\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    gap: 0.5rem;\n    white-space: nowrap;\n}\n\n#send-btn::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);\n    transition: left 0.5s;\n}\n\n#send-btn:hover::before {\n    left: 100%;\n}\n\n#send-btn:hover {\n    transform: translateY(-3px) scale(1.05);\n    box-shadow: \n        0 8px 24px rgba(99, 102, 241, 0.5),\n        0 0 40px rgba(99, 102, 241, 0.3),\n        inset 0 1px 1px rgba(255, 255, 255, 0.3);\n}\n\n#send-btn:active {\n    transform: translateY(-1px) scale(1.02);\n}\n\n/* Quick Action Badges - Enhanced */\n.badge {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.8rem 1.5rem;\n    border-radius: 12px;\n    font-size: 0.9rem;\n    font-weight: 600;\n    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n}\n\n.badge::before {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 0;\n    height: 0;\n    border-radius: 50%;\n    background: radial-gradient(circle, rgba(255, 255, 255, 0.3) 0%, transparent 70%);\n    transform: translate(-50%, -50%);\n    transition: width 0.6s, height 0.6s;\n}\n\n.badge:hover::before {\n    width: 300px;\n    height: 300px;\n}\n\n.badge-primary {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.15) 0%, rgba(168, 85, 247, 0.15) 100%);\n    color: var(--primary);\n    border: 2px solid rgba(99, 102, 241, 0.3);\n    box-shadow: 0 2px 8px rgba(99, 102, 241, 0.1);\n}\n\n.badge-primary:hover {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    transform: translateY(-3px) scale(1.05);\n    box-shadow: \n        0 6px 16px rgba(99, 102, 241, 0.3),\n        0 0 30px rgba(99, 102, 241, 0.2);\n}\n\n.badge-success {\n    background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(5, 150, 105, 0.15) 100%);\n    color: #10b981;\n    border: 2px solid rgba(16, 185, 129, 0.3);\n    box-shadow: 0 2px 8px rgba(16, 185, 129, 0.1);\n}\n\n.badge-success:hover {\n    background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n    color: white;\n    transform: translateY(-3px) scale(1.05);\n    box-shadow: \n        0 6px 16px rgba(16, 185, 129, 0.3),\n        0 0 30px rgba(16, 185, 129, 0.2);\n}\n\n/* Welcome Message */\n.welcome-message {\n    text-align: center;\n    padding: 3rem 2rem;\n    animation: fadeInUp 0.8s ease-out;\n}\n\n.welcome-message h2 {\n    font-size: 2.5rem;\n    font-weight: 800;\n    margin-bottom: 1rem;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n    animation: gradientText 3s ease infinite;\n}\n\n@keyframes gradientText {\n    0%, 100% { filter: hue-rotate(0deg); }\n    50% { filter: hue-rotate(30deg); }\n}\n\n.welcome-message p {\n    font-size: 1.2rem;\n    color: var(--gray);\n    max-width: 600px;\n    margin: 0 auto 2rem;\n    line-height: 1.6;\n}\n\n/* Dark Mode Support - Comprehensive */\n[data-theme=\"dark\"] .chat-box {\n    background: rgba(30, 30, 40, 0.95);\n    border-color: rgba(99, 102, 241, 0.25);\n    box-shadow: \n        0 8px 32px rgba(0, 0, 0, 0.4),\n        0 0 0 1px rgba(99, 102, 241, 0.15),\n        inset 0 1px 1px rgba(255, 255, 255, 0.05);\n}\n\n[data-theme=\"dark\"] .chat-header {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.18) 0%, rgba(168, 85, 247, 0.15) 50%, rgba(236, 72, 153, 0.15) 100%);\n    border-bottom-color: rgba(99, 102, 241, 0.25);\n}\n\n[data-theme=\"dark\"] .chat-header > div > div {\n    color: rgba(255, 255, 255, 0.8);\n}\n\n[data-theme=\"dark\"] .chat-messages {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.08) 0%, rgba(236, 72, 153, 0.08) 100%);\n}\n\n[data-theme=\"dark\"] .chat-messages::before {\n    background: \n        radial-gradient(circle at 20% 50%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),\n        radial-gradient(circle at 80% 50%, rgba(236, 72, 153, 0.1) 0%, transparent 50%);\n}\n\n[data-theme=\"dark\"] .message.ai .message-content {\n    background: rgba(45, 45, 60, 0.95);\n    backdrop-filter: blur(10px);\n    color: rgba(255, 255, 255, 0.95);\n    border-color: rgba(99, 102, 241, 0.25);\n    box-shadow: \n        0 4px 16px rgba(0, 0, 0, 0.3),\n        inset 0 1px 1px rgba(255, 255, 255, 0.05);\n}\n\n[data-theme=\"dark\"] .message.user .message-content {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    box-shadow: \n        0 4px 16px rgba(99, 102, 241, 0.4),\n        inset 0 1px 1px rgba(255, 255, 255, 0.25);\n}\n\n[data-theme=\"dark\"] .chat-input {\n    background: rgba(45, 45, 60, 0.95);\n    border-color: rgba(99, 102, 241, 0.35);\n    color: rgba(255, 255, 255, 0.95);\n    box-shadow: \n        0 2px 8px rgba(0, 0, 0, 0.2),\n        inset 0 1px 1px rgba(255, 255, 255, 0.05);\n}\n\n[data-theme=\"dark\"] .chat-input:focus {\n    border-color: #667eea;\n    box-shadow: \n        0 0 0 4px rgba(99, 102, 241, 0.25),\n        0 4px 16px rgba(99, 102, 241, 0.3),\n        inset 0 1px 1px rgba(255, 255, 255, 0.08);\n}\n\n[data-theme=\"dark\"] .chat-input::placeholder {\n    color: rgba(255, 255, 255, 0.45);\n}\n\n[data-theme=\"dark\"] .chat-input-area {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.12) 0%, rgba(236, 72, 153, 0.12) 100%);\n    border-top-color: rgba(99, 102, 241, 0.25);\n}\n\n[data-theme=\"dark\"] .typing-indicator {\n    background: rgba(45, 45, 60, 0.95);\n    border-color: rgba(99, 102, 241, 0.25);\n    box-shadow: \n        0 4px 16px rgba(0, 0, 0, 0.3),\n        inset 0 1px 1px rgba(255, 255, 255, 0.05);\n}\n\n[data-theme=\"dark\"] .welcome-message h2 {\n    color: rgba(255, 255, 255, 0.95);\n}\n\n[data-theme=\"dark\"] .welcome-message p {\n    color: rgba(255, 255, 255, 0.7);\n}\n\n[data-theme=\"dark\"] .welcome-message > div > div {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.15) 0%, rgba(168, 85, 247, 0.15) 100%);\n    border: 1px solid rgba(99, 102, 241, 0.25);\n}\n\n[data-theme=\"dark\"] .welcome-message > div > div > div {\n    color: rgba(255, 255, 255, 0.9);\n}\n\n[data-theme=\"dark\"] .badge-primary {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.2) 0%, rgba(168, 85, 247, 0.2) 100%);\n    color: #a5b4fc;\n    border-color: rgba(99, 102, 241, 0.4);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\n}\n\n[data-theme=\"dark\"] .badge-primary:hover {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    border-color: #667eea;\n}\n\n[data-theme=\"dark\"] .badge-success {\n    background: linear-gradient(135deg, rgba(16, 185, 129, 0.2) 0%, rgba(5, 150, 105, 0.2) 100%);\n    color: #6ee7b7;\n    border-color: rgba(16, 185, 129, 0.4);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\n}\n\n[data-theme=\"dark\"] .badge-success:hover {\n    background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n    color: white;\n    border-color: #10b981;\n}\n\n[data-theme=\"dark\"] .chat-messages::-webkit-scrollbar-track {\n    background: rgba(99, 102, 241, 0.1);\n}\n\n[data-theme=\"dark\"] .chat-messages::-webkit-scrollbar-thumb {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n}\n\n[data-theme=\"dark\"] .chat-messages::-webkit-scrollbar-thumb:hover {\n    background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);\n}\n\n/* Animations */\n@keyframes fadeInUp {\n    from {\n        opacity: 0;\n        transform: translateY(30px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n/* Message Highlight Animation */\n.message-highlight {\n    animation: messageHighlight 0.6s ease-out;\n}\n\n@keyframes messageHighlight {\n    0% {\n        background: rgba(99, 102, 241, 0.3);\n        transform: scale(1.02);\n    }\n    100% {\n        background: transparent;\n        transform: scale(1);\n    }\n}\n\n/* Responsive Design */\n@media (max-width: 768px) {\n    .chat-container {\n        padding: 1rem;\n        margin: 1rem auto;\n    }\n    \n    .chat-header {\n        padding: 1.5rem;\n        flex-direction: column;\n        align-items: flex-start;\n        gap: 1rem;\n    }\n    \n    .chat-header span {\n        font-size: 1.25rem;\n    }\n    \n    .chat-messages {\n        padding: 1.5rem;\n        min-height: 400px;\n    }\n    \n    .chat-input-area {\n        padding: 1.5rem;\n    }\n    \n    .chat-input-container {\n        flex-direction: column;\n    }\n    \n    #send-btn {\n        width: 100%;\n        justify-content: center;\n    }\n    \n    .message-content {\n        max-width: 85%;\n    }\n    \n    .welcome-message h2 {\n        font-size: 2rem;\n    }\n    \n    .welcome-message > div {\n        flex-direction: column;\n        align-items: center;\n    }\n    \n    .welcome-message > div > div {\n        max-width: 100%;\n    }\n}\n","size_bytes":17220},"static/booking-styles.css":{"content":"/* Booking Page Styles - MakeMyTrip-like design */\n\n/* Price Dropdown Styles */\n.price-dropdown {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n}\n\n.price-select {\n    padding: 0.5rem 1rem;\n    border: 2px solid #e2e8f0;\n    border-radius: 8px;\n    font-size: 0.95rem;\n    background: white;\n    color: var(--dark);\n    cursor: pointer;\n    transition: all 0.3s;\n    min-width: 200px;\n}\n\n.price-select:focus {\n    outline: none;\n    border-color: var(--primary);\n    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);\n}\n\n.price-display {\n    font-weight: 600;\n    color: var(--primary);\n    min-width: 80px;\n    text-align: right;\n}\n\n.total-price-display {\n    font-size: 1.3rem;\n    color: var(--primary);\n}\n\n/* Dark Mode Styles */\n[data-theme=\"dark\"] {\n    --dark: #f8fafc;\n    --light: #1e293b;\n    --gray: #94a3b8;\n    background: #0f172a;\n    color: var(--dark);\n}\n\n[data-theme=\"dark\"] .booking-section,\n[data-theme=\"dark\"] .price-summary-card,\n[data-theme=\"dark\"] .booking-summary-card,\n[data-theme=\"dark\"] .flight-option,\n[data-theme=\"dark\"] .hotel-option {\n    background: #1e293b;\n    color: var(--dark);\n    border-color: #334155;\n}\n\n[data-theme=\"dark\"] .price-select,\n[data-theme=\"dark\"] .form-input {\n    background: #334155;\n    border-color: #475569;\n    color: var(--dark);\n}\n\n[data-theme=\"dark\"] .navbar {\n    background: rgba(30, 41, 59, 0.95);\n    border-bottom-color: #334155;\n}\n\n[data-theme=\"dark\"] .nav-link {\n    color: #cbd5e1;\n}\n\n[data-theme=\"dark\"] .nav-link:hover,\n[data-theme=\"dark\"] .nav-link.active {\n    background: rgba(99, 102, 241, 0.2);\n    color: var(--primary);\n}\n\n[data-theme=\"dark\"] .theme-toggle {\n    background: rgba(99, 102, 241, 0.2);\n    border-radius: 50%;\n    width: 40px;\n    height: 40px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.3s;\n}\n\n[data-theme=\"dark\"] .theme-toggle:hover {\n    background: rgba(99, 102, 241, 0.3);\n    transform: scale(1.1);\n}\n\n.booking-section {\n    background: white;\n    border-radius: 20px;\n    padding: 2rem;\n    margin-bottom: 2rem;\n    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);\n}\n\n.booking-section-title {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--dark);\n    margin-bottom: 1.5rem;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.options-container {\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n}\n\n.flight-option, .hotel-option {\n    border: 2px solid #e2e8f0;\n    border-radius: 12px;\n    padding: 1.5rem;\n    cursor: pointer;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    background: white;\n}\n\n.flight-option:hover, .hotel-option:hover {\n    border-color: var(--primary);\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(99, 102, 241, 0.15);\n}\n\n.flight-option.selected, .hotel-option.selected {\n    border-color: var(--primary);\n    background: rgba(99, 102, 241, 0.05);\n    box-shadow: 0 4px 20px rgba(99, 102, 241, 0.2);\n}\n\n.flight-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 1rem;\n}\n\n.flight-airline {\n    display: flex;\n    flex-direction: column;\n    gap: 0.25rem;\n}\n\n.flight-number {\n    font-size: 0.85rem;\n    color: var(--gray);\n}\n\n.flight-price {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--primary);\n}\n\n.flight-details {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    flex-wrap: wrap;\n    gap: 1rem;\n}\n\n.flight-time {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    flex: 1;\n}\n\n.flight-time > div {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n}\n\n.flight-time strong {\n    font-size: 1.2rem;\n    color: var(--dark);\n}\n\n.flight-city {\n    font-size: 0.85rem;\n    color: var(--gray);\n    margin-top: 0.25rem;\n}\n\n.flight-duration {\n    color: var(--gray);\n    font-size: 0.9rem;\n    padding: 0.5rem;\n    background: rgba(99, 102, 241, 0.1);\n    border-radius: 8px;\n}\n\n.flight-info {\n    display: flex;\n    gap: 0.5rem;\n    flex-wrap: wrap;\n}\n\n.hotel-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-start;\n    margin-bottom: 1rem;\n    gap: 1rem;\n}\n\n.hotel-name {\n    font-size: 1.3rem;\n    font-weight: 700;\n    color: var(--dark);\n    margin-bottom: 0.5rem;\n}\n\n.hotel-rating {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    color: var(--dark);\n    font-weight: 600;\n}\n\n.hotel-reviews {\n    font-size: 0.85rem;\n    color: var(--gray);\n    font-weight: 400;\n}\n\n.hotel-price {\n    text-align: right;\n}\n\n.price-per-night {\n    font-size: 1.1rem;\n    color: var(--gray);\n    margin-bottom: 0.25rem;\n}\n\n.price-total {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--primary);\n}\n\n.hotel-details {\n    display: flex;\n    flex-direction: column;\n    gap: 0.75rem;\n}\n\n.hotel-location {\n    color: var(--gray);\n    font-size: 0.9rem;\n}\n\n.hotel-amenities {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 0.5rem;\n}\n\n.amenity-badge {\n    padding: 0.3rem 0.8rem;\n    background: rgba(99, 102, 241, 0.1);\n    color: var(--primary);\n    border-radius: 20px;\n    font-size: 0.85rem;\n    font-weight: 500;\n}\n\n.booking-summary-card {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(236, 72, 153, 0.1) 100%);\n    border-radius: 20px;\n    padding: 2rem;\n    margin-bottom: 2rem;\n    border: 2px solid rgba(99, 102, 241, 0.2);\n}\n\n.price-summary-card {\n    background: white;\n    border-radius: 20px;\n    padding: 2rem;\n    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);\n}\n\n/* Collapsible Price Summary Footer */\n.price-summary-footer {\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    z-index: 1000;\n    background: white;\n    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.15);\n    border-top: 2px solid var(--primary);\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.price-summary-toggle {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 1rem 2rem;\n    cursor: pointer;\n    background: var(--gradient-1);\n    color: white;\n    transition: all 0.3s;\n    user-select: none;\n}\n\n.price-summary-toggle:hover {\n    background: linear-gradient(135deg, #7c8ef5 0%, #8a5db8 100%);\n}\n\n.toggle-content {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    flex: 1;\n}\n\n.toggle-icon {\n    font-size: 1.5rem;\n}\n\n.toggle-text {\n    font-size: 1.1rem;\n    font-weight: 600;\n}\n\n.toggle-total {\n    margin-left: auto;\n    font-size: 1.2rem;\n    font-weight: 700;\n    background: rgba(255, 255, 255, 0.2);\n    padding: 0.5rem 1rem;\n    border-radius: 8px;\n}\n\n.toggle-arrow {\n    font-size: 1.2rem;\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    margin-left: 1rem;\n}\n\n.price-summary-footer.expanded .toggle-arrow {\n    transform: rotate(180deg);\n}\n\n.price-summary-content {\n    max-height: 0;\n    overflow: hidden;\n    transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1), padding 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n    background: white;\n}\n\n.price-summary-footer.expanded .price-summary-content {\n    max-height: 800px;\n    padding: 2rem;\n    overflow-y: auto;\n}\n\n.price-summary-content .price-summary-card {\n    margin: 0;\n    box-shadow: none;\n    border: none;\n}\n\n/* Dark mode for footer */\n[data-theme=\"dark\"] .price-summary-footer {\n    background: #1e293b;\n    border-top-color: var(--primary);\n}\n\n[data-theme=\"dark\"] .price-summary-content {\n    background: #1e293b;\n}\n\n[data-theme=\"dark\"] .price-summary-content .price-summary-card {\n    background: #334155;\n    color: var(--dark);\n}\n\n/* Mobile responsive */\n@media (max-width: 768px) {\n    .price-summary-toggle {\n        padding: 0.75rem 1rem;\n    }\n    \n    .toggle-content {\n        flex-direction: column;\n        align-items: flex-start;\n        gap: 0.5rem;\n    }\n    \n    .toggle-text {\n        font-size: 1rem;\n    }\n    \n    .toggle-total {\n        margin-left: 0;\n        font-size: 1rem;\n        width: 100%;\n        text-align: center;\n    }\n    \n    .price-summary-footer.expanded .price-summary-content {\n        padding: 1rem;\n        max-height: 70vh;\n    }\n    \n    .price-dropdown {\n        flex-direction: column;\n        gap: 0.5rem;\n    }\n    \n    .price-select {\n        min-width: 100%;\n    }\n    \n    .price-display {\n        text-align: left;\n    }\n}\n\n.price-breakdown {\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n}\n\n.price-row {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0.75rem 0;\n    border-bottom: 1px solid #e2e8f0;\n    gap: 1rem;\n}\n\n.price-row > span:first-child {\n    font-weight: 500;\n    min-width: 150px;\n}\n\n.price-row.total-row {\n    border-top: 2px solid var(--primary);\n    border-bottom: none;\n    padding-top: 1rem;\n    margin-top: 0.5rem;\n    font-size: 1.2rem;\n}\n\n.passenger-form {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n    gap: 1.5rem;\n}\n\n.form-group {\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n}\n\n.form-group label {\n    font-weight: 600;\n    color: var(--dark);\n}\n\n.form-input {\n    padding: 0.75rem 1rem;\n    border: 2px solid #e2e8f0;\n    border-radius: 8px;\n    font-size: 1rem;\n    transition: all 0.3s;\n}\n\n.form-input:focus {\n    outline: none;\n    border-color: var(--primary);\n    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);\n}\n\n@media (max-width: 768px) {\n    .flight-time {\n        flex-direction: column;\n        align-items: flex-start;\n    }\n    \n    .hotel-header {\n        flex-direction: column;\n    }\n    \n    .hotel-price {\n        text-align: left;\n    }\n    \n    .price-summary-card {\n        position: relative;\n        top: 0;\n    }\n}\n\n","size_bytes":9649},"static/styles.css":{"content":"* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\n:root {\n    --primary: #6366f1;\n    --primary-dark: #4f46e5;\n    --secondary: #ec4899;\n    --accent: #14b8a6;\n    --dark: #1e293b;\n    --light: #f8fafc;\n    --gray: #64748b;\n    --success: #10b981;\n    --warning: #f59e0b;\n    --gradient-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    --gradient-2: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);\n    --gradient-3: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);\n    --gradient-hero: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);\n    \n    /* Light theme (default) */\n    --bg-primary: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);\n    --bg-secondary: #ffffff;\n    --bg-tertiary: #f8fafc;\n    --text-primary: #1e293b;\n    --text-secondary: #64748b;\n    --border-color: rgba(99, 102, 241, 0.1);\n    --shadow-sm: 0 2px 10px rgba(0, 0, 0, 0.1);\n    --shadow-md: 0 4px 20px rgba(0, 0, 0, 0.15);\n    --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.2);\n    --navbar-bg: rgba(255, 255, 255, 0.95);\n    --card-bg: rgba(255, 255, 255, 0.9);\n    --input-bg: #ffffff;\n    --chat-user-bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    --chat-assistant-bg: #f1f5f9;\n    --chat-assistant-text: #1e293b;\n}\n\n/* Dark theme */\n[data-theme=\"dark\"] {\n    --bg-primary: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);\n    --bg-secondary: #1e293b;\n    --bg-tertiary: #334155;\n    --text-primary: #f1f5f9;\n    --text-secondary: #94a3b8;\n    --border-color: rgba(99, 102, 241, 0.2);\n    --shadow-sm: 0 2px 10px rgba(0, 0, 0, 0.3);\n    --shadow-md: 0 4px 20px rgba(0, 0, 0, 0.4);\n    --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.5);\n    --navbar-bg: rgba(30, 41, 59, 0.95);\n    --card-bg: rgba(30, 41, 59, 0.9);\n    --input-bg: #334155;\n    --chat-user-bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    --chat-assistant-bg: #334155;\n    --chat-assistant-text: #f1f5f9;\n}\n\nbody {\n    font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    background: var(--bg-primary);\n    background-attachment: fixed;\n    color: var(--text-primary);\n    line-height: 1.6;\n    overflow-x: hidden;\n    position: relative;\n    transition: background 0.3s ease, color 0.3s ease;\n}\n\nbody::before {\n    content: '';\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: \n        radial-gradient(circle at 20% 50%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),\n        radial-gradient(circle at 80% 80%, rgba(236, 72, 153, 0.1) 0%, transparent 50%),\n        radial-gradient(circle at 40% 20%, rgba(20, 184, 166, 0.1) 0%, transparent 50%);\n    pointer-events: none;\n    z-index: 0;\n}\n\n.page {\n    display: none;\n    animation: fadeIn 0.5s ease-in-out;\n    position: relative;\n    z-index: 1;\n}\n\n.page.active {\n    display: block;\n    animation: slideInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1);\n}\n\n@keyframes slideInUp {\n    from {\n        opacity: 0;\n        transform: translateY(30px) scale(0.95);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0) scale(1);\n    }\n}\n\n@keyframes fadeIn {\n    from {\n        opacity: 0;\n        transform: translateY(20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n@keyframes fadeInUp {\n    from {\n        opacity: 0;\n        transform: translateY(40px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.navbar {\n    background: var(--navbar-bg);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    box-shadow: var(--shadow-sm);\n    position: sticky;\n    top: 0;\n    z-index: 1000;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    border-bottom: 1px solid var(--border-color);\n}\n\n.navbar.scrolled {\n    box-shadow: var(--shadow-md);\n    padding: 0.5rem 0;\n}\n\n.nav-container {\n    max-width: 1400px;\n    margin: 0 auto;\n    padding: 1rem 2rem;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n.nav-logo {\n    font-size: 1.5rem;\n    font-weight: 800;\n    background: var(--gradient-1);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    transition: all 0.3s;\n    position: relative;\n}\n\n.nav-logo:hover {\n    transform: scale(1.05);\n    filter: brightness(1.1);\n}\n\n.nav-logo::after {\n    content: '';\n    position: absolute;\n    bottom: -5px;\n    left: 0;\n    width: 0;\n    height: 3px;\n    background: var(--gradient-1);\n    transition: width 0.3s;\n    border-radius: 2px;\n}\n\n.nav-logo:hover::after {\n    width: 100%;\n}\n\n.nav-links {\n    display: flex;\n    gap: 2rem;\n    list-style: none;\n}\n\n.nav-link {\n    cursor: pointer;\n    padding: 0.5rem 1rem;\n    border-radius: 8px;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    font-weight: 500;\n    color: var(--gray);\n    position: relative;\n    overflow: hidden;\n}\n\n.nav-link::before {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 0;\n    height: 0;\n    border-radius: 50%;\n    background: rgba(99, 102, 241, 0.1);\n    transform: translate(-50%, -50%);\n    transition: width 0.6s, height 0.6s;\n}\n\n.nav-link:hover::before {\n    width: 300px;\n    height: 300px;\n}\n\n.nav-link:hover,\n.nav-link.active {\n    color: var(--primary);\n    background: rgba(99, 102, 241, 0.1);\n    transform: translateY(-2px);\n}\n\n.nav-link.active {\n    font-weight: 600;\n    box-shadow: 0 2px 8px rgba(99, 102, 241, 0.2);\n}\n\n.nav-link.nav-booking {\n    background: var(--gradient-1) !important;\n    color: white !important;\n    transition: all 0.3s;\n}\n\n.nav-link.nav-booking:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);\n}\n\n.theme-toggle {\n    cursor: pointer;\n    padding: 0.5rem;\n    border-radius: 50%;\n    width: 40px;\n    height: 40px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.3s;\n    font-size: 1.2rem;\n}\n\n.theme-toggle:hover {\n    background: rgba(99, 102, 241, 0.1);\n    transform: scale(1.1) rotate(15deg);\n}\n\n/* Dark Mode Global Styles */\n[data-theme=\"dark\"] {\n    --dark: #f8fafc;\n    --light: #1e293b;\n    --gray: #94a3b8;\n}\n\n[data-theme=\"dark\"] body {\n    background: #0f172a;\n    color: var(--dark);\n}\n\n[data-theme=\"dark\"] body::before {\n    background: \n        radial-gradient(circle at 20% 50%, rgba(99, 102, 241, 0.05) 0%, transparent 50%),\n        radial-gradient(circle at 80% 80%, rgba(236, 72, 153, 0.05) 0%, transparent 50%),\n        radial-gradient(circle at 40% 20%, rgba(20, 184, 166, 0.05) 0%, transparent 50%);\n}\n\n[data-theme=\"dark\"] .page {\n    background: transparent;\n}\n\n[data-theme=\"dark\"] .feature-card,\n[data-theme=\"dark\"] .trip-card,\n[data-theme=\"dark\"] .chat-box,\n[data-theme=\"dark\"] .preferences-card {\n    background: #1e293b;\n    color: var(--dark);\n    border-color: #334155;\n}\n\n[data-theme=\"dark\"] .message-bubble {\n    background: #334155;\n    color: var(--dark);\n}\n\n[data-theme=\"dark\"] .message.user .message-bubble {\n    background: var(--gradient-1);\n    color: white;\n}\n\n[data-theme=\"dark\"] .chat-messages {\n    background: #0f172a;\n}\n\n[data-theme=\"dark\"] .chat-input {\n    background: #334155;\n    border-color: #475569;\n    color: var(--dark);\n}\n\n[data-theme=\"dark\"] .btn-primary {\n    background: var(--gradient-1);\n    color: white;\n}\n\n[data-theme=\"dark\"] .badge {\n    background: rgba(99, 102, 241, 0.2);\n    color: var(--primary);\n}\n\n.btn-inline {\n    display: inline-block;\n    margin: 0.5rem 0.5rem 0.5rem 0;\n    padding: 0.5rem 1rem;\n    background: var(--primary);\n    color: white;\n    border: none;\n    border-radius: 8px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.3s;\n}\n\n.btn-inline:hover {\n    background: var(--primary-dark);\n    transform: translateY(-2px);\n    box-shadow: 0 4px 8px rgba(99, 102, 241, 0.3);\n}\n\n.hero {\n    background: var(--gradient-hero);\n    min-height: 90vh;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    position: relative;\n    overflow: hidden;\n    animation: gradientShift 10s ease infinite;\n    background-size: 200% 200%;\n}\n\n@keyframes gradientShift {\n    0%, 100% {\n        background-position: 0% 50%;\n    }\n    50% {\n        background-position: 100% 50%;\n    }\n}\n\n.hero::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 1440 320\"><path fill=\"rgba(255,255,255,0.1)\" d=\"M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,122.7C672,117,768,139,864,138.7C960,139,1056,117,1152,112C1248,107,1344,117,1392,122.7L1440,128L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z\"></path></svg>') no-repeat bottom;\n    animation: wave 10s linear infinite;\n}\n\n@keyframes wave {\n    0% {\n        background-position: 0 bottom;\n    }\n    100% {\n        background-position: 1440px bottom;\n    }\n}\n\n.hero-content {\n    text-align: center;\n    color: white;\n    z-index: 1;\n    padding: 2rem;\n    max-width: 900px;\n}\n\n.hero-title {\n    font-size: 4rem;\n    font-weight: 900;\n    margin-bottom: 1rem;\n    animation: slideUp 1s ease-out;\n}\n\n@keyframes slideUp {\n    from {\n        opacity: 0;\n        transform: translateY(50px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.hero-subtitle {\n    font-size: 1.5rem;\n    margin-bottom: 2rem;\n    opacity: 0.95;\n    animation: slideUp 1s ease-out 0.2s both;\n}\n\n.hero-buttons {\n    display: flex;\n    gap: 1rem;\n    justify-content: center;\n    animation: slideUp 1s ease-out 0.4s both;\n}\n\n.btn {\n    padding: 1rem 2.5rem;\n    border: none;\n    border-radius: 50px;\n    font-size: 1.1rem;\n    font-weight: 600;\n    cursor: pointer;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    display: inline-flex;\n    align-items: center;\n    gap: 0.5rem;\n    position: relative;\n    overflow: hidden;\n}\n\n.btn::before {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 0;\n    height: 0;\n    border-radius: 50%;\n    background: rgba(255, 255, 255, 0.3);\n    transform: translate(-50%, -50%);\n    transition: width 0.6s, height 0.6s;\n}\n\n.btn:hover::before {\n    width: 300px;\n    height: 300px;\n}\n\n.btn-primary {\n    background: white;\n    color: var(--primary);\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);\n}\n\n.btn-primary:hover {\n    transform: translateY(-3px) scale(1.05);\n    box-shadow: 0 15px 40px rgba(99, 102, 241, 0.4);\n}\n\n.btn-primary:active {\n    transform: translateY(-1px) scale(1.02);\n}\n\n.btn-secondary {\n    background: rgba(255, 255, 255, 0.2);\n    color: white;\n    border: 2px solid white;\n    backdrop-filter: blur(10px);\n}\n\n.btn-secondary:hover {\n    background: rgba(255, 255, 255, 0.3);\n    transform: translateY(-3px);\n}\n\n.features {\n    padding: 5rem 2rem;\n    background: white;\n    position: relative;\n}\n\n.features::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 1px;\n    background: linear-gradient(90deg, transparent, var(--primary), transparent);\n}\n\n.container {\n    max-width: 1400px;\n    margin: 0 auto;\n}\n\n.section-title {\n    text-align: center;\n    font-size: 2.5rem;\n    font-weight: 800;\n    margin-bottom: 3rem;\n    background: var(--gradient-1);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n}\n\n.features-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n    gap: 2rem;\n}\n\n.feature-card {\n    background: white;\n    padding: 2rem;\n    border-radius: 20px;\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n    border: 2px solid transparent;\n    position: relative;\n    overflow: hidden;\n}\n\n.feature-card::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.1), transparent);\n    transition: left 0.6s;\n}\n\n.feature-card:hover::before {\n    left: 100%;\n}\n\n.feature-card:hover {\n    transform: translateY(-10px) scale(1.02);\n    box-shadow: 0 20px 50px rgba(99, 102, 241, 0.2);\n    border-color: var(--primary);\n}\n\n.feature-card:nth-child(1) { animation-delay: 0.1s; }\n.feature-card:nth-child(2) { animation-delay: 0.2s; }\n.feature-card:nth-child(3) { animation-delay: 0.3s; }\n.feature-card:nth-child(4) { animation-delay: 0.4s; }\n.feature-card:nth-child(5) { animation-delay: 0.5s; }\n.feature-card:nth-child(6) { animation-delay: 0.6s; }\n\n.feature-icon {\n    font-size: 3rem;\n    margin-bottom: 1rem;\n    display: inline-block;\n    transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);\n    animation: float 3s ease-in-out infinite;\n}\n\n.feature-card:hover .feature-icon {\n    transform: scale(1.2) rotate(5deg);\n    animation: bounce 0.6s ease;\n}\n\n@keyframes float {\n    0%, 100% {\n        transform: translateY(0px);\n    }\n    50% {\n        transform: translateY(-10px);\n    }\n}\n\n@keyframes bounce {\n    0%, 100% {\n        transform: scale(1.2) rotate(5deg) translateY(0);\n    }\n    50% {\n        transform: scale(1.3) rotate(-5deg) translateY(-10px);\n    }\n}\n\n.feature-title {\n    font-size: 1.5rem;\n    font-weight: 700;\n    margin-bottom: 0.5rem;\n    color: var(--dark);\n}\n\n.feature-desc {\n    color: var(--gray);\n    line-height: 1.7;\n}\n\n.chat-container {\n    max-width: 1400px;\n    margin: 2rem auto;\n    padding: 0 2rem;\n}\n\n.chat-box {\n    background: white;\n    border-radius: 20px;\n    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);\n    overflow: hidden;\n    height: 700px;\n    display: flex;\n    flex-direction: column;\n    border: 1px solid rgba(99, 102, 241, 0.1);\n    animation: slideInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1);\n    position: relative;\n}\n\n.chat-box::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 4px;\n    background: var(--gradient-1);\n    animation: shimmer 2s infinite;\n}\n\n@keyframes shimmer {\n    0% {\n        background-position: -200% 0;\n    }\n    100% {\n        background-position: 200% 0;\n    }\n}\n\n.chat-header {\n    background: var(--gradient-1);\n    color: white;\n    padding: 1.5rem;\n    font-size: 1.3rem;\n    font-weight: 700;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    position: relative;\n    overflow: hidden;\n}\n\n.chat-header::before {\n    content: '';\n    position: absolute;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);\n    animation: rotate 20s linear infinite;\n}\n\n@keyframes rotate {\n    from {\n        transform: rotate(0deg);\n    }\n    to {\n        transform: rotate(360deg);\n    }\n}\n\n.chat-messages {\n    flex: 1;\n    padding: 2rem;\n    overflow-y: auto;\n    background: #f8fafc;\n}\n\n.message {\n    margin-bottom: 1.5rem;\n    animation: messageSlide 0.4s cubic-bezier(0.16, 1, 0.3, 1);\n    opacity: 0;\n    animation-fill-mode: forwards;\n}\n\n.message.user {\n    animation-delay: 0.1s;\n}\n\n.message.assistant {\n    animation-delay: 0.2s;\n}\n\n@keyframes messageSlide {\n    from {\n        opacity: 0;\n        transform: translateX(-20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateX(0);\n    }\n}\n\n.message.user {\n    text-align: right;\n}\n\n.message.user .message-bubble {\n    animation: messageSlideRight 0.3s ease-out;\n}\n\n@keyframes messageSlideRight {\n    from {\n        opacity: 0;\n        transform: translateX(20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateX(0);\n    }\n}\n\n.message-bubble {\n    display: inline-block;\n    max-width: 70%;\n    padding: 1rem 1.5rem;\n    border-radius: 20px;\n    text-align: left;\n    position: relative;\n    word-wrap: break-word;\n    animation: bubblePop 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);\n}\n\n@keyframes bubblePop {\n    0% {\n        transform: scale(0.8);\n        opacity: 0;\n    }\n    50% {\n        transform: scale(1.05);\n    }\n    100% {\n        transform: scale(1);\n        opacity: 1;\n    }\n}\n\n.message.user .message-bubble {\n    background: var(--gradient-1);\n    color: white;\n    border-bottom-right-radius: 5px;\n}\n\n.message.assistant .message-bubble {\n    background: white;\n    color: var(--dark);\n    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n    border-bottom-left-radius: 5px;\n}\n\n.chat-input-area {\n    padding: 1.5rem;\n    background: white;\n    border-top: 1px solid #e2e8f0;\n}\n\n.chat-input-container {\n    display: flex;\n    gap: 1rem;\n}\n\n.chat-input {\n    flex: 1;\n    padding: 1rem 1.5rem;\n    border: 2px solid #e2e8f0;\n    border-radius: 50px;\n    font-size: 1rem;\n    outline: none;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    background: white;\n}\n\n.chat-input:focus {\n    border-color: var(--primary);\n    box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.15), 0 4px 12px rgba(99, 102, 241, 0.1);\n    transform: translateY(-2px);\n}\n\n.chat-input::placeholder {\n    color: #94a3b8;\n    transition: opacity 0.3s;\n}\n\n.chat-input:focus::placeholder {\n    opacity: 0.5;\n}\n\n.preferences-container {\n    max-width: 900px;\n    margin: 2rem auto;\n    padding: 0 2rem;\n}\n\n.preferences-card {\n    background: white;\n    padding: 2rem;\n    border-radius: 20px;\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);\n    margin-bottom: 2rem;\n}\n\n.form-group {\n    margin-bottom: 1.5rem;\n}\n\n.form-label {\n    display: block;\n    margin-bottom: 0.5rem;\n    font-weight: 600;\n    color: var(--dark);\n}\n\n.form-input,\n.form-select {\n    width: 100%;\n    padding: 0.75rem 1rem;\n    border: 2px solid #e2e8f0;\n    border-radius: 10px;\n    font-size: 1rem;\n    outline: none;\n    transition: all 0.3s;\n}\n\n.form-input:focus,\n.form-select:focus {\n    border-color: var(--primary);\n    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);\n}\n\n.loading-spinner {\n    display: inline-block;\n    width: 20px;\n    height: 20px;\n    border: 3px solid rgba(255, 255, 255, 0.3);\n    border-radius: 50%;\n    border-top-color: white;\n    animation: spin 0.8s linear infinite;\n}\n\n@keyframes spin {\n    to {\n        transform: rotate(360deg);\n    }\n}\n\n.badge {\n    display: inline-block;\n    padding: 0.4rem 1rem;\n    border-radius: 20px;\n    font-size: 0.85rem;\n    font-weight: 600;\n    margin: 0.25rem;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n}\n\n.badge::before {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 0;\n    height: 0;\n    border-radius: 50%;\n    background: rgba(255, 255, 255, 0.3);\n    transform: translate(-50%, -50%);\n    transition: width 0.4s, height 0.4s;\n}\n\n.badge:hover::before {\n    width: 200px;\n    height: 200px;\n}\n\n.badge:hover {\n    transform: translateY(-2px) scale(1.05);\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.badge-primary {\n    background: rgba(99, 102, 241, 0.1);\n    color: var(--primary);\n}\n\n.badge-success {\n    background: rgba(16, 185, 129, 0.1);\n    color: var(--success);\n}\n\n.trips-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));\n    gap: 2rem;\n    padding: 2rem;\n}\n\n.trip-card {\n    background: white;\n    border-radius: 20px;\n    overflow: hidden;\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n    cursor: pointer;\n    position: relative;\n    border: 2px solid transparent;\n}\n\n.trip-card::after {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    border-radius: 20px;\n    padding: 2px;\n    background: var(--gradient-1);\n    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);\n    -webkit-mask-composite: xor;\n    mask-composite: exclude;\n    opacity: 0;\n    transition: opacity 0.3s;\n}\n\n.trip-card:hover::after {\n    opacity: 1;\n}\n\n.trip-card:hover {\n    transform: translateY(-8px) scale(1.02);\n    box-shadow: 0 25px 50px rgba(99, 102, 241, 0.25);\n    border-color: var(--primary);\n}\n\n.trip-image {\n    width: 100%;\n    height: 200px;\n    background: var(--gradient-1);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 4rem;\n    position: relative;\n    overflow: hidden;\n    transition: all 0.4s ease;\n}\n\n.trip-image::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0) 100%);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.trip-card:hover .trip-image::before {\n    opacity: 1;\n}\n\n.trip-card:hover .trip-image {\n    transform: scale(1.05);\n}\n\n.trip-content {\n    padding: 1.5rem;\n    background: white;\n    position: relative;\n}\n\n.trip-title {\n    font-size: 1.3rem;\n    font-weight: 700;\n    margin-bottom: 0.5rem;\n    color: var(--dark);\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.trip-meta {\n    color: var(--gray);\n    font-size: 0.9rem;\n    margin-bottom: 1rem;\n    display: flex;\n    flex-wrap: wrap;\n    gap: 0.5rem;\n}\n\n.modal {\n    display: none;\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: rgba(0, 0, 0, 0.7);\n    z-index: 2000;\n    align-items: center;\n    justify-content: center;\n    backdrop-filter: blur(5px);\n    animation: modalFadeIn 0.3s ease-out;\n}\n\n.modal.active {\n    display: flex;\n}\n\n@keyframes modalFadeIn {\n    from {\n        opacity: 0;\n    }\n    to {\n        opacity: 1;\n    }\n}\n\n.modal-content {\n    background: white;\n    border-radius: 20px;\n    max-width: 600px;\n    width: 90%;\n    max-height: 85vh;\n    overflow-y: auto;\n    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n    animation: modalSlideUp 0.3s ease-out;\n}\n\n@keyframes modalSlideUp {\n    from {\n        transform: translateY(50px);\n        opacity: 0;\n    }\n    to {\n        transform: translateY(0);\n        opacity: 1;\n    }\n}\n\n.modal-header {\n    background: var(--gradient-1);\n    color: white;\n    padding: 1.5rem 2rem;\n    border-radius: 20px 20px 0 0;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n.modal-header h2 {\n    margin: 0;\n    font-size: 1.5rem;\n}\n\n.modal-close {\n    background: rgba(255, 255, 255, 0.2);\n    border: none;\n    color: white;\n    font-size: 1.5rem;\n    cursor: pointer;\n    width: 40px;\n    height: 40px;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.3s;\n}\n\n.modal-close:hover {\n    background: rgba(255, 255, 255, 0.3);\n    transform: rotate(90deg);\n}\n\n.modal-body {\n    padding: 2rem;\n}\n\n.booking-summary {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(236, 72, 153, 0.05) 100%);\n    padding: 1.5rem;\n    border-radius: 15px;\n    margin-bottom: 1.5rem;\n}\n\n.booking-item {\n    display: flex;\n    justify-content: space-between;\n    padding: 0.75rem 0;\n    border-bottom: 1px solid rgba(0, 0, 0, 0.1);\n}\n\n.booking-item:last-child {\n    border-bottom: none;\n    font-weight: 700;\n    font-size: 1.2rem;\n    color: var(--primary);\n}\n\n.booking-item label {\n    color: var(--gray);\n}\n\n.booking-item span {\n    color: var(--dark);\n    font-weight: 600;\n}\n\n/* Enhanced Booking Modal Styles */\n.booking-hero {\n    background: var(--gradient-1);\n    padding: 2.5rem 2rem;\n    margin: -2rem -2rem 2rem -2rem;\n    border-radius: 20px 20px 0 0;\n    display: flex;\n    align-items: center;\n    gap: 1.5rem;\n    color: white;\n}\n\n.booking-hero-icon {\n    font-size: 4rem;\n    background: rgba(255, 255, 255, 0.2);\n    width: 90px;\n    height: 90px;\n    border-radius: 20px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    backdrop-filter: blur(10px);\n    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);\n}\n\n.booking-hero-content {\n    flex: 1;\n}\n\n.booking-destination {\n    font-size: 1.8rem;\n    font-weight: 800;\n    margin: 0 0 0.5rem 0;\n}\n\n.booking-subtitle {\n    font-size: 1.1rem;\n    opacity: 0.95;\n    margin: 0;\n}\n\n.booking-summary-card {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(236, 72, 153, 0.05) 100%);\n    border-radius: 15px;\n    padding: 1.5rem;\n    margin-bottom: 1.5rem;\n    border: 1px solid rgba(99, 102, 241, 0.1);\n}\n\n.booking-row {\n    margin-bottom: 1rem;\n}\n\n.booking-row:last-child {\n    margin-bottom: 0;\n}\n\n.booking-detail {\n    display: flex;\n    align-items: flex-start;\n    gap: 1rem;\n}\n\n.booking-icon {\n    font-size: 1.8rem;\n    width: 45px;\n    height: 45px;\n    background: white;\n    border-radius: 12px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);\n}\n\n.detail-label {\n    font-size: 0.85rem;\n    color: var(--gray);\n    margin-bottom: 0.25rem;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.detail-value {\n    font-size: 1.1rem;\n    color: var(--dark);\n    font-weight: 600;\n}\n\n.passenger-controls {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    margin-top: 0.25rem;\n}\n\n.passenger-btn {\n    background: var(--primary);\n    border: none;\n    color: white;\n    width: 36px;\n    height: 36px;\n    border-radius: 10px;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 1.3rem;\n    transition: all 0.3s;\n    box-shadow: 0 4px 10px rgba(99, 102, 241, 0.3);\n}\n\n.passenger-btn:hover {\n    background: var(--primary-dark);\n    transform: translateY(-2px);\n    box-shadow: 0 6px 15px rgba(99, 102, 241, 0.4);\n}\n\n.passenger-btn:active {\n    transform: translateY(0);\n}\n\n.passenger-controls input {\n    width: 60px;\n    text-align: center;\n    font-size: 1.1rem;\n    font-weight: 700;\n    border: 2px solid var(--primary);\n    border-radius: 10px;\n    padding: 0.5rem;\n    color: var(--primary);\n    background: white;\n}\n\n.price-breakdown-card {\n    background: linear-gradient(135deg, rgba(16, 185, 129, 0.05) 0%, rgba(20, 184, 166, 0.05) 100%);\n    border-radius: 15px;\n    padding: 1.5rem;\n    margin-bottom: 1.5rem;\n    border: 1px solid rgba(16, 185, 129, 0.2);\n}\n\n.price-row {\n    display: flex;\n    justify-content: space-between;\n    padding: 0.75rem 0;\n    color: var(--dark);\n}\n\n.price-row span {\n    font-size: 1rem;\n}\n\n.price-divider {\n    height: 1px;\n    background: linear-gradient(90deg, transparent, var(--primary), transparent);\n    margin: 0.5rem 0;\n}\n\n.total-row {\n    padding-top: 1rem;\n    font-size: 1.1rem;\n}\n\n.total-price {\n    font-size: 1.8rem !important;\n    font-weight: 800 !important;\n    color: var(--success) !important;\n    transition: transform 0.2s ease;\n}\n\n.trust-badges {\n    display: flex;\n    gap: 1rem;\n    margin-bottom: 1.5rem;\n    flex-wrap: wrap;\n}\n\n.trust-badge {\n    flex: 1;\n    min-width: 140px;\n    background: white;\n    padding: 1rem;\n    border-radius: 12px;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 0.5rem;\n    text-align: center;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n    border: 2px solid rgba(99, 102, 241, 0.1);\n    transition: all 0.3s;\n}\n\n.trust-badge:hover {\n    transform: translateY(-3px);\n    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);\n    border-color: var(--primary);\n}\n\n.trust-badge span:first-child {\n    font-size: 1.8rem;\n}\n\n.trust-badge span:last-child {\n    font-size: 0.85rem;\n    color: var(--gray);\n    font-weight: 600;\n}\n\n.booking-form {\n    margin-bottom: 1.5rem;\n}\n\n.form-group-modern {\n    margin-bottom: 1.5rem;\n}\n\n.form-label-modern {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    margin-bottom: 0.75rem;\n    font-weight: 600;\n    color: var(--dark);\n}\n\n.label-icon {\n    font-size: 1.2rem;\n}\n\n.form-input-modern {\n    width: 100%;\n    padding: 1rem 1.25rem;\n    border: 2px solid #e2e8f0;\n    border-radius: 12px;\n    font-size: 1rem;\n    transition: all 0.3s;\n    font-family: inherit;\n    background: white;\n}\n\n.form-input-modern:focus {\n    outline: none;\n    border-color: var(--primary);\n    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);\n    transform: translateY(-2px);\n}\n\n.form-input-modern::placeholder {\n    color: #cbd5e1;\n}\n\ntextarea.form-input-modern {\n    resize: vertical;\n    min-height: 80px;\n}\n\n.btn-booking-cta {\n    width: 100%;\n    background: var(--gradient-1);\n    color: white;\n    border: none;\n    padding: 1.25rem 2rem;\n    border-radius: 15px;\n    font-size: 1.2rem;\n    font-weight: 700;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    transition: all 0.3s;\n    box-shadow: 0 10px 25px rgba(99, 102, 241, 0.3);\n    position: relative;\n    overflow: hidden;\n}\n\n.btn-booking-cta::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);\n    transition: left 0.5s;\n}\n\n.btn-booking-cta:hover::before {\n    left: 100%;\n}\n\n.btn-booking-cta:hover {\n    transform: translateY(-3px);\n    box-shadow: 0 15px 35px rgba(99, 102, 241, 0.4);\n}\n\n.btn-booking-cta:active {\n    transform: translateY(-1px);\n}\n\n.cta-text {\n    font-size: 1.1rem;\n}\n\n.cta-icon {\n    font-size: 1.5rem;\n}\n\n.booking-footer-note {\n    margin-top: 1.5rem;\n    padding: 1rem;\n    background: rgba(99, 102, 241, 0.05);\n    border-radius: 10px;\n    text-align: center;\n}\n\n.booking-footer-note p {\n    margin: 0;\n    font-size: 0.9rem;\n    color: var(--gray);\n}\n\n.pulse {\n    animation: pulse 2s infinite;\n}\n\n@keyframes pulse {\n    0%, 100% {\n        transform: scale(1);\n    }\n    50% {\n        transform: scale(1.05);\n    }\n}\n\n.success-icon {\n    font-size: 4rem;\n    text-align: center;\n    animation: bounceIn 0.6s ease-out;\n}\n\n@keyframes bounceIn {\n    0% {\n        transform: scale(0);\n    }\n    50% {\n        transform: scale(1.2);\n    }\n    100% {\n        transform: scale(1);\n    }\n}\n\n.alert {\n    padding: 1rem 1.5rem;\n    border-radius: 10px;\n    margin-bottom: 1rem;\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n}\n\n.alert-success {\n    background: rgba(16, 185, 129, 0.1);\n    border: 1px solid var(--success);\n    color: var(--success);\n}\n\n.alert-info {\n    background: rgba(99, 102, 241, 0.1);\n    border: 1px solid var(--primary);\n    color: var(--primary);\n}\n\n.alert-warning {\n    background: rgba(245, 158, 11, 0.1);\n    border: 1px solid var(--warning);\n    color: var(--warning);\n}\n\n.success-toast {\n    animation: slideInRight 0.5s ease-out, pulse 0.5s ease-out 0.5s;\n    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);\n    backdrop-filter: blur(10px);\n}\n\n@keyframes slideInRight {\n    from {\n        transform: translateX(400px);\n        opacity: 0;\n    }\n    to {\n        transform: translateX(0);\n        opacity: 1;\n    }\n}\n\n.shimmer {\n    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);\n    background-size: 200% 100%;\n    animation: shimmer 1.5s infinite;\n}\n\n@keyframes shimmer {\n    0% {\n        background-position: 200% 0;\n    }\n    100% {\n        background-position: -200% 0;\n    }\n}\n\n.floating {\n    animation: floating 3s ease-in-out infinite;\n}\n\n@keyframes floating {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(-10px);\n    }\n}\n\n/* Calendar Styles */\n.calendar-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));\n    gap: 2rem;\n    padding: 1rem;\n}\n\n.calendar-card {\n    background: white;\n    border-radius: 20px;\n    overflow: hidden;\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);\n    transition: all 0.3s;\n    display: flex;\n    border-left: 5px solid var(--primary);\n    animation: fadeIn 0.5s ease-out;\n}\n\n.calendar-card:hover {\n    transform: translateY(-5px);\n    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);\n    border-left-color: var(--secondary);\n}\n\n.calendar-date {\n    background: var(--gradient-1);\n    color: white;\n    padding: 1.5rem 1rem;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    min-width: 100px;\n    text-align: center;\n}\n\n.date-month {\n    font-size: 1rem;\n    font-weight: 600;\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n\n.date-day {\n    font-size: 3rem;\n    font-weight: 800;\n    line-height: 1;\n    margin: 0.5rem 0;\n}\n\n.date-year {\n    font-size: 0.9rem;\n    opacity: 0.9;\n}\n\n.calendar-content {\n    padding: 1.5rem;\n    flex: 1;\n}\n\n.trip-destination,\n.trip-dates,\n.trip-duration,\n.trip-budget,\n.trip-description {\n    margin: 0.5rem 0;\n    color: var(--gray);\n    font-size: 0.95rem;\n}\n\n.calendar-actions {\n    display: flex;\n    gap: 0.5rem;\n    margin-top: 1rem;\n}\n\n.btn-small {\n    padding: 0.5rem 1rem;\n    border: none;\n    border-radius: 8px;\n    font-size: 0.85rem;\n    font-weight: 600;\n    cursor: pointer;\n    transition: all 0.3s;\n    display: inline-flex;\n    align-items: center;\n    gap: 0.3rem;\n}\n\n.btn-view {\n    background: rgba(99, 102, 241, 0.1);\n    color: var(--primary);\n}\n\n.btn-view:hover {\n    background: rgba(99, 102, 241, 0.2);\n    transform: translateY(-2px);\n}\n\n.btn-delete {\n    background: rgba(239, 68, 68, 0.1);\n    color: #ef4444;\n}\n\n.btn-delete:hover {\n    background: rgba(239, 68, 68, 0.2);\n    transform: translateY(-2px);\n}\n\n/* Loading Animations */\n.loading-container {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    padding: 3rem;\n    text-align: center;\n}\n\n.loading-spinner-large {\n    display: inline-block;\n    width: 60px;\n    height: 60px;\n    border: 6px solid rgba(99, 102, 241, 0.1);\n    border-radius: 50%;\n    border-top-color: var(--primary);\n    animation: spin 1s linear infinite;\n    position: relative;\n}\n\n.loading-spinner-large::after {\n    content: '';\n    position: absolute;\n    top: -6px;\n    left: -6px;\n    right: -6px;\n    bottom: -6px;\n    border-radius: 50%;\n    border: 6px solid transparent;\n    border-right-color: var(--secondary);\n    animation: spin 1.5s linear infinite reverse;\n}\n\n/* Typing Indicator */\n.typing-indicator {\n    display: flex;\n    gap: 0.5rem;\n    padding: 1rem 1.5rem;\n    align-items: center;\n}\n\n.typing-indicator span {\n    width: 8px;\n    height: 8px;\n    border-radius: 50%;\n    background: var(--gray);\n    animation: typing 1.4s infinite;\n}\n\n.typing-indicator span:nth-child(1) {\n    animation-delay: 0s;\n}\n\n.typing-indicator span:nth-child(2) {\n    animation-delay: 0.2s;\n}\n\n.typing-indicator span:nth-child(3) {\n    animation-delay: 0.4s;\n}\n\n@keyframes typing {\n    0%, 60%, 100% {\n        transform: translateY(0);\n        opacity: 0.7;\n    }\n    30% {\n        transform: translateY(-10px);\n        opacity: 1;\n    }\n}\n\n/* Message highlight animation for dynamic effects */\n.message-highlight {\n    animation: messageHighlight 1s ease-out;\n}\n\n@keyframes messageHighlight {\n    0%, 100% {\n        transform: scale(1);\n        box-shadow: none;\n    }\n    50% {\n        transform: scale(1.02);\n        box-shadow: 0 0 20px rgba(99, 102, 241, 0.3);\n    }\n}\n\n/* Send Button Spinning Effect */\n.btn-primary.spinning {\n    animation: pulse 1.5s ease-in-out infinite, rotate 2s linear infinite;\n}\n\n@keyframes rotate {\n    from {\n        transform: rotate(0deg);\n    }\n    to {\n        transform: rotate(360deg);\n    }\n}\n\n.btn-primary.spinning:hover {\n    transform: translateY(-3px) rotate(360deg);\n}\n\n/* Empty State */\n.empty-state {\n    text-align: center;\n    padding: 4rem 2rem;\n    max-width: 600px;\n    margin: 0 auto;\n}\n\n.empty-icon {\n    font-size: 5rem;\n    margin-bottom: 1rem;\n    animation: floating 3s ease-in-out infinite;\n}\n\n.empty-state h3 {\n    font-size: 1.8rem;\n    color: var(--dark);\n    margin-bottom: 0.5rem;\n}\n\n.empty-state p {\n    color: var(--gray);\n    margin-bottom: 2rem;\n    font-size: 1.1rem;\n}\n\n/* Fade-in Animation for Messages */\n@keyframes fadeInUp {\n    from {\n        opacity: 0;\n        transform: translateY(30px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.message {\n    animation: fadeInUp 0.4s ease-out;\n}\n\n/* Data Fetching Skeleton Loader */\n.skeleton {\n    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);\n    background-size: 200% 100%;\n    animation: shimmer 1.5s infinite;\n    border-radius: 10px;\n}\n\n/* Badge warning */\n.badge-warning {\n    background: rgba(245, 158, 11, 0.1);\n    color: var(--warning);\n}\n\n/* Pulse animation for important elements */\n@keyframes pulse {\n    0%, 100% {\n        opacity: 1;\n        transform: scale(1);\n    }\n    50% {\n        opacity: 0.8;\n        transform: scale(1.05);\n    }\n}\n\n.pulse-animation {\n    animation: pulse 2s ease-in-out infinite;\n}\n\n/* Smooth scroll */\nhtml {\n    scroll-behavior: smooth;\n}\n\n/* Enhanced card hover effects */\n.card-hover-effect {\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.card-hover-effect:hover {\n    transform: translateY(-5px);\n    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);\n}\n\n/* Gradient text animation */\n.gradient-text {\n    background: var(--gradient-1);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n    background-size: 200% auto;\n    animation: gradient-shift 3s ease infinite;\n}\n\n@keyframes gradient-shift {\n    0%, 100% {\n        background-position: 0% center;\n    }\n    50% {\n        background-position: 100% center;\n    }\n}\n\n/* Ripple effect */\n.ripple {\n    position: relative;\n    overflow: hidden;\n}\n\n.ripple::after {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 0;\n    height: 0;\n    border-radius: 50%;\n    background: rgba(255, 255, 255, 0.5);\n    transform: translate(-50%, -50%);\n    transition: width 0.6s, height 0.6s;\n}\n\n.ripple:active::after {\n    width: 300px;\n    height: 300px;\n}\n\n@media (max-width: 768px) {\n    .hero-title {\n        font-size: 2.5rem;\n    }\n\n    .hero-subtitle {\n        font-size: 1.2rem;\n    }\n\n    .nav-links {\n        display: none;\n    }\n\n    .features-grid,\n    .trips-grid,\n    .calendar-grid {\n        grid-template-columns: 1fr;\n    }\n    \n    .modal-content {\n        width: 95%;\n        max-height: 90vh;\n    }\n    \n    .calendar-card {\n        flex-direction: column;\n    }\n    \n    .calendar-date {\n        flex-direction: row;\n        gap: 1rem;\n        padding: 1rem;\n        min-width: auto;\n    }\n    \n    .date-day {\n        font-size: 2rem;\n    }\n    \n    .message-bubble {\n        max-width: 85%;\n    }\n    \n    .nav-link.nav-booking {\n        padding: 0.4rem 1rem;\n        font-size: 0.9rem;\n    }\n}\n\n/* Booking Page Styles */\n.booking-section {\n    background: white;\n    border-radius: 20px;\n    padding: 2rem;\n    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);\n    margin-bottom: 2rem;\n}\n\n.booking-section-title {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--dark);\n    margin-bottom: 1.5rem;\n    padding-bottom: 1rem;\n    border-bottom: 2px solid rgba(99, 102, 241, 0.1);\n}\n\n.booking-summary-card {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(236, 72, 153, 0.1) 100%);\n    border-radius: 20px;\n    padding: 2rem;\n    margin-bottom: 2rem;\n    border: 2px solid rgba(99, 102, 241, 0.2);\n}\n\n.booking-summary-content {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 1rem;\n}\n\n.booking-summary-item {\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n}\n\n.booking-summary-item strong {\n    color: var(--primary);\n    font-size: 0.9rem;\n}\n\n.options-container {\n    display: flex;\n    flex-direction: column;\n    gap: 1.5rem;\n}\n\n.flight-card, .hotel-card {\n    background: white;\n    border: 2px solid #e2e8f0;\n    border-radius: 16px;\n    padding: 1.5rem;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    cursor: pointer;\n    position: relative;\n}\n\n.flight-card:hover, .hotel-card:hover {\n    border-color: var(--primary);\n    box-shadow: 0 8px 24px rgba(99, 102, 241, 0.15);\n    transform: translateY(-2px);\n}\n\n.flight-card.selected, .hotel-card.selected {\n    border-color: var(--primary);\n    background: rgba(99, 102, 241, 0.05);\n    box-shadow: 0 8px 24px rgba(99, 102, 241, 0.2);\n}\n\n.flight-card.selected::before, .hotel-card.selected::before {\n    content: '✓';\n    position: absolute;\n    top: 1rem;\n    right: 1rem;\n    width: 30px;\n    height: 30px;\n    background: var(--primary);\n    color: white;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: bold;\n    font-size: 1.2rem;\n}\n\n.flight-header, .hotel-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-start;\n    margin-bottom: 1rem;\n}\n\n.flight-info, .hotel-info {\n    flex: 1;\n}\n\n.flight-airline, .hotel-name {\n    font-size: 1.2rem;\n    font-weight: 700;\n    color: var(--dark);\n    margin-bottom: 0.5rem;\n}\n\n.flight-number, .hotel-location {\n    font-size: 0.9rem;\n    color: var(--gray);\n    margin-bottom: 0.5rem;\n}\n\n.flight-time, .hotel-rating {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    margin-top: 0.5rem;\n}\n\n.flight-price, .hotel-price {\n    text-align: right;\n}\n\n.flight-price-amount, .hotel-price-amount {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--primary);\n}\n\n.flight-price-label, .hotel-price-label {\n    font-size: 0.85rem;\n    color: var(--gray);\n}\n\n.flight-details, .hotel-details {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n    gap: 1rem;\n    margin-top: 1rem;\n    padding-top: 1rem;\n    border-top: 1px solid #e2e8f0;\n}\n\n.flight-detail-item, .hotel-detail-item {\n    display: flex;\n    flex-direction: column;\n    gap: 0.25rem;\n}\n\n.flight-detail-label, .hotel-detail-label {\n    font-size: 0.8rem;\n    color: var(--gray);\n    font-weight: 500;\n}\n\n.flight-detail-value, .hotel-detail-value {\n    font-size: 0.95rem;\n    color: var(--dark);\n    font-weight: 600;\n}\n\n.hotel-amenities {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 0.5rem;\n    margin-top: 1rem;\n}\n\n.hotel-amenity {\n    background: rgba(99, 102, 241, 0.1);\n    color: var(--primary);\n    padding: 0.3rem 0.8rem;\n    border-radius: 20px;\n    font-size: 0.8rem;\n    font-weight: 500;\n}\n\n.hotel-reviews {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    margin-top: 0.5rem;\n}\n\n.star-rating {\n    color: #fbbf24;\n    font-size: 1rem;\n}\n\n.passenger-form {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n    gap: 1.5rem;\n}\n\n.form-group {\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n}\n\n.form-group label {\n    font-weight: 600;\n    color: var(--dark);\n    font-size: 0.95rem;\n}\n\n.form-input {\n    padding: 0.75rem 1rem;\n    border: 2px solid #e2e8f0;\n    border-radius: 12px;\n    font-size: 1rem;\n    transition: all 0.3s;\n    font-family: inherit;\n}\n\n.form-input:focus {\n    outline: none;\n    border-color: var(--primary);\n    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);\n}\n\n.price-summary-card {\n    background: white;\n    border-radius: 20px;\n    padding: 2rem;\n    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);\n    margin-top: 2rem;\n    position: sticky;\n    bottom: 2rem;\n}\n\n.price-breakdown {\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n}\n\n.price-row {\n    display: flex;\n    justify-content: space-between;\n    padding: 0.75rem 0;\n    border-bottom: 1px solid #e2e8f0;\n}\n\n.price-row.total-row {\n    border-top: 2px solid var(--primary);\n    border-bottom: none;\n    padding-top: 1rem;\n    margin-top: 0.5rem;\n    font-size: 1.2rem;\n}\n\n.price-row:last-child {\n    border-bottom: none;\n}\n","size_bytes":43511}},"version":2}