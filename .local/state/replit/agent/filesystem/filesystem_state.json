{"file_contents":{"pyproject.toml":{"content":"[project]\nname = \"python-template\"\nversion = \"0.1.0\"\ndescription = \"\"\nauthors = [\"Your Name <you@example.com>\"]\nrequires-python = \">=3.11\"\ndependencies = [\n    \"fastapi>=0.121.0\",\n    \"langchain>=1.0.5\",\n    \"langchain-community>=0.4.1\",\n    \"langchain-google-genai>=3.0.1\",\n    \"langchain-groq>=1.0.0\",\n    \"langchain-openai>=1.0.2\",\n    \"openai>=2.7.1\",\n    \"psycopg2-binary>=2.9.11\",\n    \"pydantic>=2.12.4\",\n    \"python-dotenv>=1.2.1\",\n    \"sqlalchemy>=2.0.44\",\n    \"stripe>=13.2.0\",\n    \"uvicorn>=0.38.0\",\n]\n","size_bytes":512},"main.py":{"content":"import os\nfrom fastapi import FastAPI, HTTPException, Depends\nfrom fastapi.staticfiles import StaticFiles\nfrom fastapi.responses import FileResponse, RedirectResponse\nfrom pydantic import BaseModel\nfrom agent.travel_agent import TravelPlannerAgent\nimport uvicorn\nimport stripe\nfrom stripe._error import StripeError\nfrom typing import Optional, Dict, Any, List\nfrom datetime import datetime\nimport json\nfrom sqlalchemy.orm import Session\nfrom database import init_db, get_db, Itinerary, Booking, CalendarEvent, User, Session as DBSession\n\n# Initialize FastAPI app\napp = FastAPI(title=\"TripMind AI Agent\")\n\n# Initialize database\ninit_db()\n\n# Initialize Stripe (API key will be set from environment)\nstripe.api_key = os.environ.get('STRIPE_SECRET_KEY', '')\n\n# Initialize the AI agent (only if API key is available)\nagent = None\ntry:\n    if os.environ.get('GROQ_API_KEY'):\n        agent = TravelPlannerAgent()\n    else:\n        print(\"Warning: GROQ_API_KEY not set. AI agent features will be unavailable.\")\nexcept Exception as e:\n    print(f\"Warning: Failed to initialize AI agent: {e}. AI agent features will be unavailable.\")\n\n# In-memory storage for bookings (fallback, but we'll use database)\nbookings_store = {}\n\n# Server-side trip pricing (canonical source of truth)\nTRIP_PRICES = {\n    \"goa-beach\": 450.00,\n    \"paris-family\": 750.00,\n    \"manali-adventure\": 200.00\n}\n\n# Request/Response models\nclass TravelQuery(BaseModel):\n    query: str\n\nclass TravelResponse(BaseModel):\n    status: str\n    response: str\n    request: str = \"\"\n    error: str = \"\"\n\nclass BookingRequest(BaseModel):\n    trip_id: str\n    trip_name: str\n    destination: str\n    start_date: str\n    end_date: str\n    total_price: float\n    passengers: int\n    email: Optional[str] = None\n    flight_details: Optional[Dict[str, Any]] = None\n    hotel_details: Optional[Dict[str, Any]] = None\n    special_requests: Optional[str] = None\n\nclass PaymentRequest(BaseModel):\n    booking_id: str\n    amount: float\n\nclass AuthSignInRequest(BaseModel):\n    email: str\n    password: str\n    remember_me: Optional[bool] = False\n\nclass AuthSignUpRequest(BaseModel):\n    name: str\n    email: str\n    password: str\n\nclass CalendarEventRequest(BaseModel):\n    title: str\n    description: Optional[str] = None\n    start_date: str\n    end_date: str\n    start_time: Optional[str] = None\n    end_time: Optional[str] = None\n    all_day: Optional[str] = \"true\"\n    event_type: Optional[str] = \"personal\"\n    tags: Optional[List[str]] = None\n    color: Optional[str] = None\n    booking_id: Optional[str] = None\n    reminder_enabled: Optional[str] = \"false\"\n    reminder_time: Optional[str] = None\n\nclass ItineraryRequest(BaseModel):\n    trip_name: str\n    destination: str\n    start_date: str\n    end_date: str\n    duration_days: int\n    budget: Optional[float] = None\n    description: Optional[str] = None\n    itinerary_data: Optional[Dict[str, Any]] = None\n\n# Serve static files\napp.mount(\"/static\", StaticFiles(directory=\"static\"), name=\"static\")\n\n@app.get(\"/\")\nasync def read_root():\n    \"\"\"Serve the main HTML page.\"\"\"\n    return FileResponse(\"static/index.html\")\n\nimport secrets\nfrom passlib.context import CryptContext\n\n# Password hashing context using bcrypt\npwd_context = CryptContext(schemes=[\"bcrypt\"], deprecated=\"auto\")\n\ndef hash_password(password: str) -> str:\n    \"\"\"Hash a password using bcrypt.\"\"\"\n    return pwd_context.hash(password)\n\ndef verify_password(plain_password: str, hashed_password: str) -> bool:\n    \"\"\"Verify a password against a hash.\"\"\"\n    return pwd_context.verify(plain_password, hashed_password)\n\ndef generate_token() -> str:\n    \"\"\"Generate a secure random token.\"\"\"\n    return secrets.token_urlsafe(32)\n\n@app.post(\"/api/auth/signup\")\nasync def signup(request: AuthSignUpRequest, db: Session = Depends(get_db)):\n    \"\"\"User signup endpoint.\"\"\"\n    try:\n        # Check if user already exists\n        existing_user = db.query(User).filter(User.email == request.email).first()\n        if existing_user:\n            return {\n                \"status\": \"error\",\n                \"message\": \"Email already registered\"\n            }\n        \n        # Create new user\n        new_user = User(\n            name=request.name,\n            email=request.email,\n            password_hash=hash_password(request.password)\n        )\n        db.add(new_user)\n        db.commit()\n        db.refresh(new_user)\n        \n        # Generate auth token\n        token = generate_token()\n        new_session = DBSession(\n            token=token,\n            user_id=new_user.id,\n            email=new_user.email\n        )\n        db.add(new_session)\n        db.commit()\n        \n        return {\n            \"status\": \"success\",\n            \"user\": {\n                \"name\": new_user.name,\n                \"email\": new_user.email\n            },\n            \"token\": token\n        }\n    except Exception as e:\n        db.rollback()\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.post(\"/api/auth/signin\")\nasync def signin(request: AuthSignInRequest, db: Session = Depends(get_db)):\n    \"\"\"User signin endpoint.\"\"\"\n    try:\n        # Check if user exists\n        user = db.query(User).filter(User.email == request.email).first()\n        if not user:\n            return {\n                \"status\": \"error\",\n                \"message\": \"Invalid email or password\"\n            }\n        \n        # Verify password\n        if not verify_password(request.password, user.password_hash):\n            return {\n                \"status\": \"error\",\n                \"message\": \"Invalid email or password\"\n            }\n        \n        # Generate auth token\n        token = generate_token()\n        new_session = DBSession(\n            token=token,\n            user_id=user.id,\n            email=user.email\n        )\n        db.add(new_session)\n        db.commit()\n        \n        return {\n            \"status\": \"success\",\n            \"user\": {\n                \"name\": user.name,\n                \"email\": user.email\n            },\n            \"token\": token\n        }\n    except Exception as e:\n        db.rollback()\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.post(\"/api/auth/logout\")\nasync def logout(token: str, db: Session = Depends(get_db)):\n    \"\"\"User logout endpoint.\"\"\"\n    try:\n        session = db.query(DBSession).filter(DBSession.token == token).first()\n        if session:\n            db.delete(session)\n            db.commit()\n        return {\"status\": \"success\"}\n    except Exception as e:\n        db.rollback()\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.post(\"/api/plan\", response_model=TravelResponse)\nasync def plan_trip(query: TravelQuery):\n    \"\"\"\n    Main endpoint for travel planning.\n    Accepts natural language queries and returns AI-generated travel plans.\n    \"\"\"\n    if agent is None:\n        return TravelResponse(\n            status=\"error\",\n            response=\"⚠️ AI Agent is currently unavailable. Please configure the GROQ_API_KEY environment variable to enable AI-powered trip planning. You can still use the booking features!\",\n            request=query.query,\n            error=\"AI agent is not available. Please set GROQ_API_KEY environment variable.\"\n        )\n    try:\n        result = agent.plan_trip(query.query)\n        \n        return TravelResponse(\n            status=result.get(\"status\", \"success\"),\n            response=result.get(\"response\", \"\"),\n            request=result.get(\"request\", query.query),\n            error=result.get(\"error\", \"\")\n        )\n    except Exception as e:\n        return TravelResponse(\n            status=\"error\",\n            response=f\"❌ An error occurred: {str(e)}\",\n            request=query.query,\n            error=str(e)\n        )\n\n@app.post(\"/api/reset\")\nasync def reset_memory():\n    \"\"\"Reset the agent's conversation memory.\"\"\"\n    if agent is None:\n        return {\"status\": \"error\", \"message\": \"AI agent is not available\"}\n    try:\n        agent.reset_memory()\n        return {\"status\": \"success\", \"message\": \"Memory cleared\"}\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.get(\"/api/history\")\nasync def get_history():\n    \"\"\"Get conversation history.\"\"\"\n    if agent is None:\n        return {\"status\": \"success\", \"history\": []}\n    try:\n        history = agent.get_conversation_history()\n        return {\"status\": \"success\", \"history\": history}\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.get(\"/api/preferences\")\nasync def get_preferences():\n    \"\"\"Get saved user preferences.\"\"\"\n    try:\n        from agent.travel_agent import user_preferences_store\n        return {\n            \"status\": \"success\",\n            \"preferences\": user_preferences_store\n        }\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.post(\"/api/booking-options\")\nasync def get_booking_options(request: Dict[str, Any] = None):\n    \"\"\"Extract flight and hotel options from conversation history or provided trip details.\"\"\"\n    try:\n        # Get trip details from request or conversation history\n        destination = None\n        origin = \"Mumbai\"  # Default origin\n        start_date = None\n        end_date = None\n        budget = None\n        passengers = 1\n        \n        if request and request.get(\"trip_details\"):\n            # Use provided trip details\n            trip = request[\"trip_details\"]\n            destination = trip.get(\"destination\")\n            origin = trip.get(\"origin\", \"Mumbai\")\n            start_date = trip.get(\"start_date\")\n            end_date = trip.get(\"end_date\")\n            budget = trip.get(\"budget\")\n            passengers = trip.get(\"passengers\", 1)\n        elif agent is not None:\n            # Extract from conversation history\n            history = agent.get_conversation_history()\n            import re\n            for entry in history:\n                content = entry.get(\"content\", \"\")\n                \n                # Extract dates\n                date_pattern = r'\\d{4}-\\d{2}-\\d{2}'\n                dates = re.findall(date_pattern, content)\n                if dates:\n                    if not start_date:\n                        start_date = dates[0]\n                    if len(dates) > 1:\n                        end_date = dates[1]\n                    elif not end_date:\n                        end_date = dates[0]\n                \n                # Extract destination\n                dest_patterns = [\n                    r'(?:destination|going to|visit|trip to|travel to)[:\\s]+([A-Z][a-z]+(?:\\s+[A-Z][a-z]+)*)',\n                    r'([A-Z][a-z]+(?:\\s+[A-Z][a-z]+)*)\\s+(?:trip|vacation|getaway)',\n                ]\n                for pattern in dest_patterns:\n                    dest_match = re.search(pattern, content, re.IGNORECASE)\n                    if dest_match and not destination:\n                        destination = dest_match.group(1)\n                        break\n                \n                # Extract budget\n                budget_match = re.search(r'\\$(\\d+(?:\\.\\d{2})?)', content)\n                if budget_match and not budget:\n                    budget = float(budget_match.group(1))\n                \n                # Extract passengers\n                passenger_match = re.search(r'(\\d+)\\s*(?:passenger|person|people|guest)', content, re.IGNORECASE)\n                if passenger_match and passengers == 1:\n                    passengers = int(passenger_match.group(1))\n        \n        # Use defaults if not found\n        if not destination:\n            destination = \"Goa\"\n        if not start_date:\n            from datetime import datetime, timedelta\n            start_date = (datetime.now() + timedelta(days=7)).strftime(\"%Y-%m-%d\")\n        if not end_date:\n            from datetime import datetime, timedelta\n            end_date = (datetime.now() + timedelta(days=14)).strftime(\"%Y-%m-%d\")\n        if not budget:\n            budget = 1000.0\n        \n        # Get flight options using the agent's search_flights tool\n        flights_data = []\n        hotels_data = []\n        \n        if agent is not None:\n            from agent.travel_agent import search_flights, search_hotels\n            import json\n            \n            # Search flights\n            flight_budget = budget * 0.4  # Allocate 40% of budget to flights\n            flights_result = search_flights(origin, destination, start_date, flight_budget / passengers)\n            flights_json = json.loads(flights_result)\n            flights_data = flights_json.get(\"flights\", [])\n            \n            # Search hotels\n            hotel_budget = budget * 0.4  # Allocate 40% of budget to hotels per night\n            num_nights = (datetime.strptime(end_date, \"%Y-%m-%d\") - datetime.strptime(start_date, \"%Y-%m-%d\")).days\n            hotels_result = search_hotels(destination, start_date, end_date, hotel_budget / num_nights if num_nights > 0 else hotel_budget)\n            hotels_json = json.loads(hotels_result)\n            hotels_data = hotels_json.get(\"hotels\", [])\n        else:\n            # Fallback: Generate sample flights and hotels\n            flights_data = [\n                {\n                    \"airline\": \"Air India\",\n                    \"flight_number\": \"AI202\",\n                    \"departure_time\": \"08:00\",\n                    \"arrival_time\": \"10:30\",\n                    \"duration\": \"2h 30m\",\n                    \"price\": min(budget * 0.3, 450),\n                    \"stops\": 0,\n                    \"class\": \"Economy\"\n                },\n                {\n                    \"airline\": \"IndiGo\",\n                    \"flight_number\": \"6E345\",\n                    \"departure_time\": \"14:00\",\n                    \"arrival_time\": \"16:45\",\n                    \"duration\": \"2h 45m\",\n                    \"price\": min(budget * 0.25, 350),\n                    \"stops\": 0,\n                    \"class\": \"Economy\"\n                },\n                {\n                    \"airline\": \"SpiceJet\",\n                    \"flight_number\": \"SG890\",\n                    \"departure_time\": \"18:30\",\n                    \"arrival_time\": \"21:15\",\n                    \"duration\": \"2h 45m\",\n                    \"price\": min(budget * 0.2, 320),\n                    \"stops\": 0,\n                    \"class\": \"Economy\"\n                }\n            ]\n            \n            num_nights = (datetime.strptime(end_date, \"%Y-%m-%d\") - datetime.strptime(start_date, \"%Y-%m-%d\")).days\n            hotels_data = [\n                {\n                    \"name\": \"Beach Paradise Resort\",\n                    \"rating\": 4.5,\n                    \"price_per_night\": min(budget * 0.3 / num_nights if num_nights > 0 else budget * 0.3, 120),\n                    \"location\": \"Beachfront\",\n                    \"amenities\": [\"Pool\", \"WiFi\", \"Breakfast\", \"Spa\", \"Beach Access\"],\n                    \"reviews\": 1250,\n                    \"style\": \"luxury\"\n                },\n                {\n                    \"name\": \"Cozy Inn & Suites\",\n                    \"rating\": 4.2,\n                    \"price_per_night\": min(budget * 0.2 / num_nights if num_nights > 0 else budget * 0.2, 80),\n                    \"location\": \"City Center\",\n                    \"amenities\": [\"WiFi\", \"Breakfast\", \"Parking\", \"Gym\"],\n                    \"reviews\": 890,\n                    \"style\": \"mid-range\"\n                },\n                {\n                    \"name\": \"Budget Stay Hotel\",\n                    \"rating\": 3.8,\n                    \"price_per_night\": min(budget * 0.15 / num_nights if num_nights > 0 else budget * 0.15, 50),\n                    \"location\": \"Near Beach\",\n                    \"amenities\": [\"WiFi\", \"AC\", \"24/7 Reception\"],\n                    \"reviews\": 456,\n                    \"style\": \"budget-friendly\"\n                }\n            ]\n        \n        return {\n            \"status\": \"success\",\n            \"trip_details\": {\n                \"origin\": origin,\n                \"destination\": destination,\n                \"start_date\": start_date,\n                \"end_date\": end_date,\n                \"budget\": budget,\n                \"passengers\": passengers\n            },\n            \"flights\": flights_data,\n            \"hotels\": hotels_data\n        }\n    except Exception as e:\n        return {\n            \"status\": \"error\",\n            \"message\": str(e),\n            \"flights\": [],\n            \"hotels\": []\n        }\n\n@app.post(\"/api/bookings\")\nasync def create_booking(booking: BookingRequest, db: Session = Depends(get_db)):\n    \"\"\"Create a new booking with server-side price calculation.\"\"\"\n    try:\n        # SECURITY: Calculate price server-side using canonical trip prices\n        # Ignore any client-provided total_price\n        \n        if booking.trip_id not in TRIP_PRICES:\n            raise HTTPException(\n                status_code=400, \n                detail=f\"Unknown trip ID: {booking.trip_id}\"\n            )\n        \n        # Validate passenger count\n        if booking.passengers < 1 or booking.passengers > 10:\n            raise HTTPException(\n                status_code=400,\n                detail=\"Passenger count must be between 1 and 10\"\n            )\n        \n        # Calculate total using TRUSTED server-side pricing\n        base_price = TRIP_PRICES[booking.trip_id]\n        calculated_total = base_price * booking.passengers\n        \n        booking_id = f\"BK{datetime.now().strftime('%Y%m%d%H%M%S')}\"\n        \n        # Extract email from flight_details if not provided directly\n        email = booking.email\n        if not email and booking.flight_details and isinstance(booking.flight_details, dict):\n            email = booking.flight_details.get('email')\n        \n        # Extract special_requests from flight_details if not provided directly\n        special_requests = booking.special_requests\n        if not special_requests and booking.flight_details and isinstance(booking.flight_details, dict):\n            special_requests = booking.flight_details.get('special_requests')\n        \n        # Create booking in database\n        db_booking = Booking(\n            booking_id=booking_id,\n            trip_id=booking.trip_id,\n            trip_name=booking.trip_name,\n            destination=booking.destination,\n            start_date=booking.start_date,\n            end_date=booking.end_date,\n            base_price=base_price,\n            total_price=calculated_total,\n            passengers=booking.passengers,\n            email=email,\n            flight_details=booking.flight_details or {},\n            hotel_details=booking.hotel_details or {},\n            special_requests=special_requests,\n            status=\"pending\",\n            payment_status=\"unpaid\"\n        )\n        \n        db.add(db_booking)\n        db.commit()\n        db.refresh(db_booking)\n        \n        # Also store in memory for backward compatibility\n        booking_data = {\n            \"id\": booking_id,\n            \"booking_id\": booking_id,\n            \"trip_id\": booking.trip_id,\n            \"trip_name\": booking.trip_name,\n            \"destination\": booking.destination,\n            \"start_date\": booking.start_date,\n            \"end_date\": booking.end_date,\n            \"base_price\": base_price,\n            \"total_price\": calculated_total,\n            \"passengers\": booking.passengers,\n            \"email\": email,\n            \"flight_details\": booking.flight_details,\n            \"hotel_details\": booking.hotel_details,\n            \"special_requests\": special_requests,\n            \"status\": \"pending\",\n            \"payment_status\": \"unpaid\",\n            \"created_at\": db_booking.created_at.isoformat() if db_booking.created_at else datetime.now().isoformat()\n        }\n        bookings_store[booking_id] = booking_data\n        \n        return {\n            \"status\": \"success\",\n            \"booking_id\": booking_id,\n            \"booking\": booking_data\n        }\n    except HTTPException:\n        raise\n    except Exception as e:\n        db.rollback()\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.get(\"/api/bookings\")\nasync def get_bookings(db: Session = Depends(get_db), status: Optional[str] = None):\n    \"\"\"Get all bookings, optionally filtered by status.\"\"\"\n    try:\n        query = db.query(Booking).order_by(Booking.created_at.desc())\n        \n        if status:\n            query = query.filter(Booking.status == status)\n        \n        bookings = query.all()\n        \n        result = []\n        for booking in bookings:\n            result.append({\n                \"id\": booking.booking_id,\n                \"booking_id\": booking.booking_id,\n                \"trip_id\": booking.trip_id,\n                \"trip_name\": booking.trip_name,\n                \"destination\": booking.destination,\n                \"start_date\": booking.start_date,\n                \"end_date\": booking.end_date,\n                \"base_price\": booking.base_price,\n                \"total_price\": booking.total_price,\n                \"passengers\": booking.passengers,\n                \"email\": booking.email,\n                \"flight_details\": booking.flight_details,\n                \"hotel_details\": booking.hotel_details,\n                \"special_requests\": booking.special_requests,\n                \"status\": booking.status,\n                \"payment_status\": booking.payment_status,\n                \"created_at\": booking.created_at.isoformat() if booking.created_at else None,\n                \"confirmed_at\": booking.confirmed_at.isoformat() if booking.confirmed_at else None,\n                \"cancelled_at\": booking.cancelled_at.isoformat() if booking.cancelled_at else None\n            })\n        \n        return {\n            \"status\": \"success\",\n            \"bookings\": result\n        }\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.get(\"/api/bookings/{booking_id}\")\nasync def get_booking(booking_id: str, db: Session = Depends(get_db)):\n    \"\"\"Get a specific booking by booking_id.\"\"\"\n    try:\n        booking = db.query(Booking).filter(Booking.booking_id == booking_id).first()\n        \n        if not booking:\n            # Fallback to in-memory store for backward compatibility\n            if booking_id in bookings_store:\n                return {\n                    \"status\": \"success\",\n                    \"booking\": bookings_store[booking_id]\n                }\n            raise HTTPException(status_code=404, detail=\"Booking not found\")\n        \n        booking_data = {\n            \"id\": booking.booking_id,\n            \"booking_id\": booking.booking_id,\n            \"trip_id\": booking.trip_id,\n            \"trip_name\": booking.trip_name,\n            \"destination\": booking.destination,\n            \"start_date\": booking.start_date,\n            \"end_date\": booking.end_date,\n            \"base_price\": booking.base_price,\n            \"total_price\": booking.total_price,\n            \"passengers\": booking.passengers,\n            \"email\": booking.email,\n            \"flight_details\": booking.flight_details,\n            \"hotel_details\": booking.hotel_details,\n            \"special_requests\": booking.special_requests,\n            \"status\": booking.status,\n            \"payment_status\": booking.payment_status,\n            \"stripe_session_id\": booking.stripe_session_id,\n            \"created_at\": booking.created_at.isoformat() if booking.created_at else None,\n            \"confirmed_at\": booking.confirmed_at.isoformat() if booking.confirmed_at else None,\n            \"cancelled_at\": booking.cancelled_at.isoformat() if booking.cancelled_at else None,\n            \"updated_at\": booking.updated_at.isoformat() if booking.updated_at else None\n        }\n        \n        return {\n            \"status\": \"success\",\n            \"booking\": booking_data\n        }\n    except HTTPException:\n        raise\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.post(\"/api/create-checkout-session\")\nasync def create_checkout_session(payment: PaymentRequest, db: Session = Depends(get_db)):\n    \"\"\"Create a Stripe checkout session for payment.\"\"\"\n    try:\n        if not stripe.api_key:\n            raise HTTPException(\n                status_code=400, \n                detail=\"Stripe is not configured. Please set STRIPE_SECRET_KEY.\"\n            )\n        \n        booking = db.query(Booking).filter(Booking.booking_id == payment.booking_id).first()\n        \n        if not booking:\n            # Fallback to in-memory store\n            if payment.booking_id not in bookings_store:\n                raise HTTPException(status_code=404, detail=\"Booking not found\")\n            booking_dict = bookings_store[payment.booking_id]\n            actual_amount = booking_dict['total_price']\n            \n            # Validate booking is in a payable state (in-memory)\n            if booking_dict.get('status') == 'confirmed':\n                raise HTTPException(status_code=400, detail=\"Booking is already confirmed\")\n            if booking_dict.get('status') == 'cancelled':\n                raise HTTPException(status_code=400, detail=\"Booking is cancelled\")\n            if booking_dict.get('payment_status') == 'paid':\n                raise HTTPException(status_code=400, detail=\"Booking is already paid\")\n            \n            # Use in-memory booking data for Stripe\n            booking_destination = booking_dict.get('destination', 'Unknown')\n            booking_trip_name = booking_dict.get('trip_name', 'Trip')\n            booking_start_date = booking_dict.get('start_date', '')\n            booking_end_date = booking_dict.get('end_date', '')\n            booking_passengers = booking_dict.get('passengers', 1)\n            booking_email = booking_dict.get('email')\n        else:\n            actual_amount = booking.total_price\n            \n            # Validate booking is in a payable state\n            if booking.status == 'confirmed':\n                raise HTTPException(status_code=400, detail=\"Booking is already confirmed\")\n            if booking.status == 'cancelled':\n                raise HTTPException(status_code=400, detail=\"Booking is cancelled\")\n            if booking.payment_status == 'paid':\n                raise HTTPException(status_code=400, detail=\"Booking is already paid\")\n            \n            # Use database booking data for Stripe\n            booking_destination = booking.destination\n            booking_trip_name = booking.trip_name\n            booking_start_date = booking.start_date\n            booking_end_date = booking.end_date\n            booking_passengers = booking.passengers\n            booking_email = booking.email\n        \n        # Optional: Log if client-provided amount differs from booking total\n        if abs(payment.amount - actual_amount) > 0.01:\n            print(f\"Warning: Client amount ({payment.amount}) differs from booking total ({actual_amount})\")\n        \n        # Get the domain for success/cancel URLs\n        domain = os.environ.get('REPLIT_DEV_DOMAIN', 'localhost:5000')\n        if os.environ.get('REPLIT_DEPLOYMENT'):\n            protocol = 'https://'\n        else:\n            domains = os.environ.get('REPLIT_DOMAINS', '').split(',')\n            domain = domains[0] if domains and domains[0] else 'localhost:5000'\n            # Use http:// for localhost, https:// for other domains\n            protocol = 'https://' if not domain.startswith('localhost') else 'http://'\n        \n        # Create Stripe checkout session using TRUSTED server-side amount\n        checkout_session = stripe.checkout.Session.create(\n            payment_method_types=['card'],\n            line_items=[\n                {\n                    'price_data': {\n                        'currency': 'usd',\n                        'unit_amount': int(actual_amount * 100),  # Use booking total, not client amount\n                        'product_data': {\n                            'name': f\"Trip to {booking_destination}\",\n                            'description': f\"{booking_trip_name} - {booking_start_date} to {booking_end_date} ({booking_passengers} passenger(s))\",\n                        },\n                    },\n                    'quantity': 1,\n                },\n            ],\n            mode='payment',\n            success_url=f'{protocol}{domain}/?payment=success&booking_id={payment.booking_id}',\n            cancel_url=f'{protocol}{domain}/?payment=cancelled&booking_id={payment.booking_id}',\n            customer_email=booking_email,\n            metadata={\n                'booking_id': payment.booking_id,\n                'expected_amount': str(actual_amount)\n            }\n        )\n        \n        # Update booking with Stripe session ID (only if using database)\n        if booking:\n            booking.stripe_session_id = checkout_session.id\n            db.commit()\n        \n        return {\n            \"status\": \"success\",\n            \"checkout_url\": checkout_session.url,\n            \"session_id\": checkout_session.id\n        }\n    except StripeError as e:\n        raise HTTPException(status_code=400, detail=f\"Stripe error: {str(e)}\")\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.post(\"/api/bookings/{booking_id}/confirm\")\nasync def confirm_booking(booking_id: str, db: Session = Depends(get_db)):\n    \"\"\"Confirm a booking after successful payment.\"\"\"\n    try:\n        booking = db.query(Booking).filter(Booking.booking_id == booking_id).first()\n        \n        if not booking:\n            # Fallback to in-memory store\n            if booking_id not in bookings_store:\n                raise HTTPException(status_code=404, detail=\"Booking not found\")\n            bookings_store[booking_id][\"status\"] = \"confirmed\"\n            bookings_store[booking_id][\"payment_status\"] = \"paid\"\n            bookings_store[booking_id][\"confirmed_at\"] = datetime.now().isoformat()\n            return {\n                \"status\": \"success\",\n                \"booking\": bookings_store[booking_id]\n            }\n        \n        booking.status = \"confirmed\"\n        booking.payment_status = \"paid\"\n        booking.confirmed_at = datetime.utcnow()\n        db.commit()\n        db.refresh(booking)\n        \n        # Also update in-memory store\n        if booking_id in bookings_store:\n            bookings_store[booking_id][\"status\"] = \"confirmed\"\n            bookings_store[booking_id][\"payment_status\"] = \"paid\"\n            bookings_store[booking_id][\"confirmed_at\"] = booking.confirmed_at.isoformat()\n        \n        booking_data = {\n            \"id\": booking.booking_id,\n            \"booking_id\": booking.booking_id,\n            \"trip_id\": booking.trip_id,\n            \"trip_name\": booking.trip_name,\n            \"destination\": booking.destination,\n            \"start_date\": booking.start_date,\n            \"end_date\": booking.end_date,\n            \"base_price\": booking.base_price,\n            \"total_price\": booking.total_price,\n            \"passengers\": booking.passengers,\n            \"email\": booking.email,\n            \"status\": booking.status,\n            \"payment_status\": booking.payment_status,\n            \"confirmed_at\": booking.confirmed_at.isoformat() if booking.confirmed_at else None\n        }\n        \n        return {\n            \"status\": \"success\",\n            \"booking\": booking_data\n        }\n    except HTTPException:\n        raise\n    except Exception as e:\n        db.rollback()\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.delete(\"/api/bookings/{booking_id}\")\nasync def cancel_booking(booking_id: str, db: Session = Depends(get_db)):\n    \"\"\"Cancel a booking.\"\"\"\n    try:\n        booking = db.query(Booking).filter(Booking.booking_id == booking_id).first()\n        \n        if not booking:\n            # Fallback to in-memory store\n            if booking_id not in bookings_store:\n                raise HTTPException(status_code=404, detail=\"Booking not found\")\n            bookings_store[booking_id][\"status\"] = \"cancelled\"\n            bookings_store[booking_id][\"cancelled_at\"] = datetime.now().isoformat()\n            return {\n                \"status\": \"success\",\n                \"message\": \"Booking cancelled successfully\"\n            }\n        \n        if booking.status == \"cancelled\":\n            raise HTTPException(status_code=400, detail=\"Booking is already cancelled\")\n        \n        booking.status = \"cancelled\"\n        booking.cancelled_at = datetime.utcnow()\n        db.commit()\n        \n        # Also update in-memory store\n        if booking_id in bookings_store:\n            bookings_store[booking_id][\"status\"] = \"cancelled\"\n            bookings_store[booking_id][\"cancelled_at\"] = booking.cancelled_at.isoformat()\n        \n        return {\n            \"status\": \"success\",\n            \"message\": \"Booking cancelled successfully\"\n        }\n    except HTTPException:\n        raise\n    except Exception as e:\n        db.rollback()\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.post(\"/api/itineraries\")\nasync def save_itinerary(request: ItineraryRequest, db: Session = Depends(get_db)):\n    \"\"\"Save a planned itinerary to the calendar.\"\"\"\n    try:\n        itinerary = Itinerary(\n            trip_name=request.trip_name,\n            destination=request.destination,\n            start_date=request.start_date,\n            end_date=request.end_date,\n            duration_days=request.duration_days,\n            budget=request.budget,\n            description=request.description,\n            itinerary_data=request.itinerary_data or {}\n        )\n        db.add(itinerary)\n        db.commit()\n        db.refresh(itinerary)\n        \n        return {\n            \"status\": \"success\",\n            \"itinerary_id\": itinerary.id,\n            \"message\": \"Itinerary saved successfully\"\n        }\n    except Exception as e:\n        db.rollback()\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.get(\"/api/itineraries\")\nasync def get_itineraries(db: Session = Depends(get_db)):\n    \"\"\"Get all itineraries for the calendar.\"\"\"\n    try:\n        itineraries = db.query(Itinerary).order_by(Itinerary.created_at.desc()).all()\n        \n        result = []\n        for itin in itineraries:\n            result.append({\n                \"id\": itin.id,\n                \"trip_name\": itin.trip_name,\n                \"destination\": itin.destination,\n                \"start_date\": itin.start_date,\n                \"end_date\": itin.end_date,\n                \"duration_days\": itin.duration_days,\n                \"budget\": itin.budget,\n                \"description\": itin.description,\n                \"itinerary_data\": itin.itinerary_data,\n                \"created_at\": itin.created_at.isoformat() if itin.created_at else None\n            })\n        \n        return {\n            \"status\": \"success\",\n            \"itineraries\": result\n        }\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.get(\"/api/itineraries/{itinerary_id}\")\nasync def get_itinerary(itinerary_id: int, db: Session = Depends(get_db)):\n    \"\"\"Get a specific itinerary by ID.\"\"\"\n    try:\n        itinerary = db.query(Itinerary).filter(Itinerary.id == itinerary_id).first()\n        \n        if not itinerary:\n            raise HTTPException(status_code=404, detail=\"Itinerary not found\")\n        \n        return {\n            \"status\": \"success\",\n            \"itinerary\": {\n                \"id\": itinerary.id,\n                \"trip_name\": itinerary.trip_name,\n                \"destination\": itinerary.destination,\n                \"start_date\": itinerary.start_date,\n                \"end_date\": itinerary.end_date,\n                \"duration_days\": itinerary.duration_days,\n                \"budget\": itinerary.budget,\n                \"description\": itinerary.description,\n                \"itinerary_data\": itinerary.itinerary_data,\n                \"created_at\": itinerary.created_at.isoformat() if itinerary.created_at else None\n            }\n        }\n    except HTTPException:\n        raise\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.delete(\"/api/itineraries/{itinerary_id}\")\nasync def delete_itinerary(itinerary_id: int, db: Session = Depends(get_db)):\n    \"\"\"Delete an itinerary from the calendar.\"\"\"\n    try:\n        itinerary = db.query(Itinerary).filter(Itinerary.id == itinerary_id).first()\n        \n        if not itinerary:\n            raise HTTPException(status_code=404, detail=\"Itinerary not found\")\n        \n        db.delete(itinerary)\n        db.commit()\n        \n        return {\n            \"status\": \"success\",\n            \"message\": \"Itinerary deleted successfully\"\n        }\n    except HTTPException:\n        raise\n    except Exception as e:\n        db.rollback()\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.post(\"/api/bookings/from-itinerary/{itinerary_id}\")\nasync def create_booking_from_itinerary(itinerary_id: int, passengers: int = 1, db: Session = Depends(get_db)):\n    \"\"\"Create a booking from a saved itinerary.\"\"\"\n    try:\n        itinerary = db.query(Itinerary).filter(Itinerary.id == itinerary_id).first()\n        \n        if not itinerary:\n            raise HTTPException(status_code=404, detail=\"Itinerary not found\")\n        \n        # Validate passenger count\n        if passengers < 1 or passengers > 10:\n            raise HTTPException(\n                status_code=400,\n                detail=\"Passenger count must be between 1 and 10\"\n            )\n        \n        # Generate a trip_id from itinerary (or use a default)\n        trip_id = f\"itinerary-{itinerary_id}\"\n        \n        # Calculate price based on itinerary budget or use default\n        if itinerary.budget:\n            base_price = itinerary.budget / (itinerary.duration_days or 1)\n        else:\n            # Default pricing if no budget specified\n            base_price = 200.0\n        \n        calculated_total = base_price * passengers\n        \n        booking_id = f\"BK{datetime.now().strftime('%Y%m%d%H%M%S')}\"\n        \n        db_booking = Booking(\n            booking_id=booking_id,\n            trip_id=trip_id,\n            trip_name=itinerary.trip_name,\n            destination=itinerary.destination,\n            start_date=itinerary.start_date,\n            end_date=itinerary.end_date,\n            base_price=base_price,\n            total_price=calculated_total,\n            passengers=passengers,\n            flight_details={},\n            hotel_details={},\n            status=\"pending\",\n            payment_status=\"unpaid\"\n        )\n        \n        db.add(db_booking)\n        db.commit()\n        db.refresh(db_booking)\n        \n        booking_data = {\n            \"id\": booking_id,\n            \"booking_id\": booking_id,\n            \"trip_id\": trip_id,\n            \"trip_name\": itinerary.trip_name,\n            \"destination\": itinerary.destination,\n            \"start_date\": itinerary.start_date,\n            \"end_date\": itinerary.end_date,\n            \"base_price\": base_price,\n            \"total_price\": calculated_total,\n            \"passengers\": passengers,\n            \"status\": \"pending\",\n            \"payment_status\": \"unpaid\",\n            \"created_at\": db_booking.created_at.isoformat() if db_booking.created_at else datetime.now().isoformat()\n        }\n        \n        return {\n            \"status\": \"success\",\n            \"booking_id\": booking_id,\n            \"booking\": booking_data\n        }\n    except HTTPException:\n        raise\n    except Exception as e:\n        db.rollback()\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.get(\"/health\")\nasync def health_check():\n    \"\"\"Health check endpoint.\"\"\"\n    return {\"status\": \"healthy\", \"service\": \"TripMind AI Agent\"}\n\n# Calendar Events API Endpoints\n@app.get(\"/api/calendar/events\")\nasync def get_calendar_events(start: Optional[str] = None, end: Optional[str] = None, db: Session = Depends(get_db)):\n    \"\"\"Get all calendar events, optionally filtered by date range.\"\"\"\n    try:\n        # Get all calendar events\n        all_events = db.query(CalendarEvent).all()\n        \n        # Also get bookings and convert them to calendar events\n        bookings = db.query(Booking).filter(Booking.status.in_([\"pending\", \"confirmed\"])).all()\n        \n        events = []\n        \n        # Add manual calendar events\n        for event in all_events:\n            # Determine color based on event type\n            color = event.color\n            if not color:\n                if event.event_type == \"booking\":\n                    color = \"#3b82f6\"  # Blue for bookings\n                elif event.event_type == \"trip\":\n                    color = \"#10b981\"  # Green for trips\n                elif event.event_type == \"reminder\":\n                    color = \"#f59e0b\"  # Yellow for reminders\n                else:\n                    color = \"#6366f1\"  # Purple for personal\n            \n            # Format start and end dates properly\n            start_str = event.start_date\n            end_str = event.end_date\n            \n            # Add time if not all-day and time is provided\n            if event.start_time and event.all_day != \"true\":\n                start_str = f\"{event.start_date}T{event.start_time}:00\"\n            if event.end_time and event.all_day != \"true\":\n                end_str = f\"{event.end_date}T{event.end_time}:00\"\n            \n            events.append({\n                \"id\": f\"event_{event.id}\",\n                \"title\": event.title or \"Untitled Event\",\n                \"description\": event.description or \"\",\n                \"start\": start_str,\n                \"end\": end_str,\n                \"allDay\": event.all_day == \"true\",\n                \"backgroundColor\": color,\n                \"borderColor\": color,\n                \"textColor\": \"#ffffff\",\n                \"extendedProps\": {\n                    \"event_type\": event.event_type or \"personal\",\n                    \"tags\": event.tags if event.tags else [],\n                    \"booking_id\": event.booking_id,\n                    \"reminder_enabled\": event.reminder_enabled == \"true\",\n                    \"reminder_time\": event.reminder_time,\n                    \"database_id\": event.id\n                }\n            })\n        \n        # Add booking events\n        for booking in bookings:\n            status_color = {\n                \"pending\": \"#f59e0b\",  # Yellow\n                \"confirmed\": \"#10b981\",  # Green\n                \"cancelled\": \"#ef4444\",  # Red\n                \"completed\": \"#6b7280\"  # Gray\n            }.get(booking.status, \"#6366f1\")\n            \n            events.append({\n                \"id\": f\"booking_{booking.booking_id}\",\n                \"title\": f\"✈️ {booking.trip_name}\",\n                \"description\": f\"Destination: {booking.destination}\\nPassengers: {booking.passengers}\\nStatus: {booking.status.title()}\",\n                \"start\": booking.start_date,\n                \"end\": booking.end_date,\n                \"allDay\": True,\n                \"backgroundColor\": status_color,\n                \"borderColor\": status_color,\n                \"textColor\": \"#ffffff\",\n                \"extendedProps\": {\n                    \"event_type\": \"booking\",\n                    \"booking_id\": booking.booking_id,\n                    \"status\": booking.status,\n                    \"destination\": booking.destination,\n                    \"is_booking\": True\n                }\n            })\n        \n        return {\n            \"status\": \"success\",\n            \"events\": events\n        }\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.post(\"/api/calendar/events\")\nasync def create_calendar_event(event: CalendarEventRequest, db: Session = Depends(get_db)):\n    \"\"\"Create a new calendar event.\"\"\"\n    try:\n        # Validate required fields\n        if not event.title or not event.title.strip():\n            return {\n                \"status\": \"error\",\n                \"error\": \"Event title is required\"\n            }\n        \n        if not event.start_date or not event.end_date:\n            return {\n                \"status\": \"error\",\n                \"error\": \"Start date and end date are required\"\n            }\n        \n        # Validate date format\n        try:\n            from datetime import datetime\n            datetime.strptime(event.start_date, \"%Y-%m-%d\")\n            datetime.strptime(event.end_date, \"%Y-%m-%d\")\n        except ValueError:\n            return {\n                \"status\": \"error\",\n                \"error\": \"Invalid date format. Please use YYYY-MM-DD format\"\n            }\n        \n        # Determine color based on event type if not provided\n        color = event.color\n        if not color:\n            if event.event_type == \"booking\":\n                color = \"#3b82f6\"\n            elif event.event_type == \"trip\":\n                color = \"#10b981\"\n            elif event.event_type == \"reminder\":\n                color = \"#f59e0b\"\n            else:\n                color = \"#6366f1\"\n        \n        db_event = CalendarEvent(\n            title=event.title.strip(),\n            description=event.description,\n            start_date=event.start_date,\n            end_date=event.end_date,\n            start_time=event.start_time,\n            end_time=event.end_time,\n            all_day=event.all_day or \"true\",\n            event_type=event.event_type or \"personal\",\n            tags=event.tags or [],\n            color=color,\n            booking_id=event.booking_id,\n            reminder_enabled=event.reminder_enabled or \"false\",\n            reminder_time=event.reminder_time\n        )\n        \n        db.add(db_event)\n        db.commit()\n        db.refresh(db_event)\n        \n        return {\n            \"status\": \"success\",\n            \"event_id\": db_event.id,\n            \"message\": \"Event created successfully\"\n        }\n    except Exception as e:\n        db.rollback()\n        import traceback\n        error_msg = str(e)\n        print(f\"Error creating calendar event: {error_msg}\")\n        print(traceback.format_exc())\n        return {\n            \"status\": \"error\",\n            \"error\": f\"Failed to create event: {error_msg}\"\n        }\n\n@app.put(\"/api/calendar/events/{event_id}\")\nasync def update_calendar_event(event_id: int, event: CalendarEventRequest, db: Session = Depends(get_db)):\n    \"\"\"Update an existing calendar event.\"\"\"\n    try:\n        db_event = db.query(CalendarEvent).filter(CalendarEvent.id == event_id).first()\n        if not db_event:\n            return {\n                \"status\": \"error\",\n                \"error\": \"Event not found\"\n            }\n        \n        # Validate required fields\n        if not event.title or not event.title.strip():\n            return {\n                \"status\": \"error\",\n                \"error\": \"Event title is required\"\n            }\n        \n        db_event.title = event.title.strip()\n        db_event.description = event.description\n        db_event.start_date = event.start_date\n        db_event.end_date = event.end_date\n        db_event.start_time = event.start_time\n        db_event.end_time = event.end_time\n        db_event.all_day = event.all_day or \"true\"\n        db_event.event_type = event.event_type or db_event.event_type\n        db_event.tags = event.tags or db_event.tags\n        if event.color:\n            db_event.color = event.color\n        db_event.reminder_enabled = event.reminder_enabled or db_event.reminder_enabled\n        db_event.reminder_time = event.reminder_time\n        db_event.updated_at = datetime.utcnow()\n        \n        db.commit()\n        db.refresh(db_event)\n        \n        return {\n            \"status\": \"success\",\n            \"message\": \"Event updated successfully\"\n        }\n    except Exception as e:\n        db.rollback()\n        import traceback\n        error_msg = str(e)\n        print(f\"Error updating calendar event: {error_msg}\")\n        print(traceback.format_exc())\n        return {\n            \"status\": \"error\",\n            \"error\": f\"Failed to update event: {error_msg}\"\n        }\n\n@app.delete(\"/api/calendar/events/{event_id}\")\nasync def delete_calendar_event(event_id: int, db: Session = Depends(get_db)):\n    \"\"\"Delete a calendar event.\"\"\"\n    try:\n        db_event = db.query(CalendarEvent).filter(CalendarEvent.id == event_id).first()\n        if not db_event:\n            return {\n                \"status\": \"error\",\n                \"error\": \"Event not found\"\n            }\n        \n        db.delete(db_event)\n        db.commit()\n        \n        return {\n            \"status\": \"success\",\n            \"message\": \"Event deleted successfully\"\n        }\n    except Exception as e:\n        db.rollback()\n        import traceback\n        error_msg = str(e)\n        print(f\"Error deleting calendar event: {error_msg}\")\n        print(traceback.format_exc())\n        return {\n            \"status\": \"error\",\n            \"error\": f\"Failed to delete event: {error_msg}\"\n        }\n\nif __name__ == \"__main__\":\n    # Run the server on 0.0.0.0:5000 for Replit\n    uvicorn.run(app, host=\"0.0.0.0\", port=5000)\n","size_bytes":48789},"static/calendar-styles.css":{"content":"/* FullCalendar Custom Styling */\n#calendar-container {\n    width: 100%;\n    min-height: 600px;\n}\n\n.fc {\n    font-family: inherit;\n    background: transparent;\n}\n\n.fc-header-toolbar {\n    margin-bottom: 1.5rem;\n    padding: 1.5rem;\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.12) 0%, rgba(168, 85, 247, 0.1) 50%, rgba(236, 72, 153, 0.1) 100%);\n    border-radius: 18px;\n    border: 1px solid rgba(99, 102, 241, 0.15);\n    box-shadow: \n        0 4px 16px rgba(99, 102, 241, 0.1),\n        inset 0 1px 1px rgba(255, 255, 255, 0.5);\n    backdrop-filter: blur(10px);\n}\n\n.fc-button {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;\n    border: none !important;\n    padding: 0.7rem 1.3rem !important;\n    border-radius: 12px !important;\n    font-weight: 700 !important;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;\n    text-transform: capitalize !important;\n    box-shadow: \n        0 4px 12px rgba(99, 102, 241, 0.3),\n        inset 0 1px 1px rgba(255, 255, 255, 0.2) !important;\n    color: white !important;\n    position: relative;\n    overflow: hidden;\n}\n\n.fc-button::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);\n    transition: left 0.5s;\n}\n\n.fc-button:hover::before {\n    left: 100%;\n}\n\n.fc-button:hover {\n    background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%) !important;\n    transform: translateY(-3px) scale(1.05) !important;\n    box-shadow: \n        0 6px 20px rgba(99, 102, 241, 0.5),\n        0 0 30px rgba(99, 102, 241, 0.3),\n        inset 0 1px 1px rgba(255, 255, 255, 0.3) !important;\n    cursor: none;\n}\n\n.fc-button:active {\n    transform: translateY(0) !important;\n}\n\n.fc-button-primary:not(:disabled):active,\n.fc-button-primary:not(:disabled).fc-button-active {\n    background: var(--primary-dark) !important;\n    box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3) !important;\n}\n\n.fc-button:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n}\n\n.fc-toolbar-title {\n    font-size: 1.75rem !important;\n    font-weight: 800 !important;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    -webkit-background-clip: text !important;\n    -webkit-text-fill-color: transparent !important;\n    background-clip: text !important;\n    filter: drop-shadow(0 2px 4px rgba(99, 102, 241, 0.2));\n}\n\n.fc-daygrid-day {\n    background: white;\n    border: 1px solid #e2e8f0;\n    transition: all 0.2s ease;\n}\n\n.fc-daygrid-day:hover {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.12) 0%, rgba(168, 85, 247, 0.08) 100%) !important;\n    transform: scale(1.02);\n    box-shadow: 0 2px 8px rgba(99, 102, 241, 0.15);\n}\n\n.fc-day-today {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.18) 0%, rgba(168, 85, 247, 0.12) 50%, rgba(236, 72, 153, 0.1) 100%) !important;\n    border: 2px solid var(--primary) !important;\n    box-shadow: \n        inset 0 0 20px rgba(99, 102, 241, 0.15),\n        0 0 20px rgba(99, 102, 241, 0.1);\n    position: relative;\n}\n\n.fc-day-today::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: linear-gradient(135deg, transparent 0%, rgba(99, 102, 241, 0.05) 100%);\n    animation: todayPulse 3s ease-in-out infinite;\n}\n\n@keyframes todayPulse {\n    0%, 100% { opacity: 0.5; }\n    50% { opacity: 1; }\n}\n\n.fc-daygrid-day-number {\n    padding: 0.5rem;\n    font-weight: 700;\n    color: var(--dark);\n    transition: all 0.3s;\n}\n\n.fc-day-today .fc-daygrid-day-number {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    border-radius: 50%;\n    width: 2.5rem;\n    height: 2.5rem;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: 800;\n    box-shadow: \n        0 4px 12px rgba(99, 102, 241, 0.4),\n        0 0 20px rgba(99, 102, 241, 0.3);\n    animation: todayNumberPulse 2s ease-in-out infinite;\n}\n\n@keyframes todayNumberPulse {\n    0%, 100% { transform: scale(1); box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4), 0 0 20px rgba(99, 102, 241, 0.3); }\n    50% { transform: scale(1.1); box-shadow: 0 6px 16px rgba(99, 102, 241, 0.6), 0 0 30px rgba(99, 102, 241, 0.5); }\n}\n\n.fc-event {\n    border-radius: 10px !important;\n    padding: 8px 12px !important;\n    cursor: pointer !important;\n    border: none !important;\n    font-size: 0.9rem !important;\n    font-weight: 700 !important;\n    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) !important;\n    box-shadow: \n        0 4px 12px rgba(0, 0, 0, 0.25),\n        0 2px 4px rgba(0, 0, 0, 0.15),\n        inset 0 1px 1px rgba(255, 255, 255, 0.3) !important;\n    margin: 4px 3px !important;\n    backdrop-filter: blur(8px);\n    position: relative;\n    overflow: hidden;\n    background-image: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, transparent 100%) !important;\n}\n\n.fc-event::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, transparent 50%);\n    opacity: 0;\n    transition: opacity 0.3s;\n}\n\n.fc-event::after {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);\n    transition: left 0.6s;\n}\n\n.fc-event:hover {\n    transform: translateY(-4px) scale(1.05) !important;\n    box-shadow: \n        0 12px 28px rgba(0, 0, 0, 0.35),\n        0 4px 8px rgba(0, 0, 0, 0.2),\n        0 0 40px rgba(99, 102, 241, 0.3),\n        inset 0 1px 1px rgba(255, 255, 255, 0.5) !important;\n    z-index: 10 !important;\n    cursor: none !important;\n}\n\n.fc-event:hover::before {\n    opacity: 1;\n}\n\n.fc-event:hover::after {\n    left: 100%;\n}\n\n.fc-event:active {\n    transform: translateY(-1px) scale(1.01) !important;\n}\n\n.fc-event-title {\n    font-weight: 600;\n    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);\n}\n\n.fc-event-title {\n    font-weight: 600;\n}\n\n.fc-daygrid-event {\n    margin: 2px 4px !important;\n}\n\n.fc-timegrid-slot {\n    border-color: #e2e8f0;\n}\n\n.fc-timegrid-col {\n    border-color: #e2e8f0;\n}\n\n.fc-col-header-cell {\n    background: rgba(99, 102, 241, 0.05);\n    padding: 0.75rem 0;\n    font-weight: 600;\n    color: var(--dark);\n    border-color: #e2e8f0;\n}\n\n.fc-scrollgrid {\n    border-radius: 10px;\n    overflow: hidden;\n}\n\n.fc-daygrid-event-dot {\n    display: none;\n}\n\n/* Dark mode support */\n[data-theme=\"dark\"] .fc {\n    color: #f8fafc;\n}\n\n[data-theme=\"dark\"] .fc-daygrid-day {\n    background: #1e293b !important;\n    border-color: #334155 !important;\n}\n\n[data-theme=\"dark\"] .fc-daygrid-day:hover {\n    background: rgba(99, 102, 241, 0.15) !important;\n}\n\n[data-theme=\"dark\"] .fc-day-today {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.25) 0%, rgba(236, 72, 153, 0.15) 100%) !important;\n    border: 2px solid var(--primary) !important;\n}\n\n[data-theme=\"dark\"] .fc-day-today .fc-daygrid-day-number {\n    background: var(--primary) !important;\n    color: white !important;\n}\n\n[data-theme=\"dark\"] .fc-daygrid-day-number {\n    color: #f8fafc !important;\n}\n\n[data-theme=\"dark\"] .fc-toolbar-title {\n    color: #f8fafc !important;\n}\n\n[data-theme=\"dark\"] .fc-col-header-cell {\n    background: #334155 !important;\n    color: #f8fafc !important;\n    border-color: #475569 !important;\n}\n\n[data-theme=\"dark\"] .fc-header-toolbar {\n    background: rgba(99, 102, 241, 0.15) !important;\n    border-color: rgba(99, 102, 241, 0.3) !important;\n}\n\n[data-theme=\"dark\"] .fc-timegrid-slot,\n[data-theme=\"dark\"] .fc-timegrid-col {\n    border-color: #475569 !important;\n}\n\n[data-theme=\"dark\"] .fc-timegrid-slot-label {\n    color: #cbd5e1 !important;\n}\n\n[data-theme=\"dark\"] .fc-timegrid-axis {\n    color: #cbd5e1 !important;\n    border-color: #475569 !important;\n}\n\n[data-theme=\"dark\"] .fc-list-day-cushion {\n    background: #334155 !important;\n    color: #f8fafc !important;\n}\n\n[data-theme=\"dark\"] .fc-list-event {\n    background: #1e293b !important;\n    border-color: #334155 !important;\n}\n\n[data-theme=\"dark\"] .fc-list-event:hover {\n    background: rgba(99, 102, 241, 0.1) !important;\n}\n\n[data-theme=\"dark\"] .fc-scrollgrid {\n    border-color: #475569 !important;\n}\n\n/* Calendar wrapper dark mode */\n[data-theme=\"dark\"] #calendar-wrapper {\n    background: #1e293b !important;\n    border: 1px solid #334155;\n}\n\n/* Mobile responsive */\n@media (max-width: 768px) {\n    .fc-header-toolbar {\n        flex-direction: column;\n        gap: 1rem;\n        padding: 1rem !important;\n    }\n    \n    .fc-toolbar-chunk {\n        display: flex;\n        justify-content: center;\n        width: 100%;\n        flex-wrap: wrap;\n    }\n    \n    .fc-button {\n        padding: 0.4rem 0.8rem !important;\n        font-size: 0.85rem !important;\n    }\n    \n    .fc-toolbar-title {\n        font-size: 1.2rem !important;\n    }\n    \n    #calendar-wrapper {\n        padding: 1rem !important;\n    }\n}\n\n/* Additional smooth transitions */\n.fc-scrollgrid-section {\n    transition: background-color 0.3s ease;\n}\n\n.fc-daygrid-day-frame {\n    transition: all 0.2s ease;\n}\n\n/* Loading state */\n.fc-loading {\n    opacity: 0.6;\n}\n\n","size_bytes":9227},"replit.md":{"content":"# TripMind AI Agent\n\n## Overview\nTripMind is an autonomous AI-powered travel planning application that processes natural language queries to create complete travel itineraries. It utilizes LangGraph's ReAct agent framework to orchestrate specialized tools for tasks such as searching flights, finding hotels, checking weather, and generating day-by-day itineraries. The application features a FastAPI backend and a vanilla JavaScript frontend, offering a robust platform for intelligent travel planning.\n\nThe project includes a complete authentication system with sign-in/sign-up functionality, secure password hashing, and database-backed user sessions. It also boasts a full booking system with secure Stripe payment integration, allowing users to book and pay for trips directly within the platform. The user interface is designed with modern aesthetics, including animations, glassmorphic effects, and responsive multi-page layouts.\n\n## User Preferences\nPreferred communication style: Simple, everyday language.\n\n## Recent Changes (Latest)\n- **Automated Trip Booking Flow**: Streamlined booking experience with automatic trip saving and booking activation\n  - When AI generates a trip plan, it automatically saves to My Trips (as an itinerary in the database)\n  - Booking page opens automatically after trip is saved, no manual button clicking required\n  - Toast notifications provide clear feedback on save success/failure\n  - Graceful error handling ensures booking modal still opens even if auto-save fails\n  - Works for both immediate trip detection and delayed origin completion flows\n  - Trip details include destination, origin, dates, passengers, budget, and duration\n  - All trips are saved to `/api/itineraries` with AI-generated flag for tracking\n- **Enhanced Profile Dropdown Menu**: Redesigned with comprehensive account management options\n  - Account Settings - View account information\n  - My Trips - Access saved trip plans\n  - My Bookings - View confirmed bookings\n  - Calendar - Access travel calendar\n  - Preferences - Manage travel preferences\n  - Switch Account - Sign out and switch to different account\n  - Sign Out - Logout with confirmation message\n  - Profile displays user name, email, and auto-generated initials\n  - All menu items fully functional with smooth animations\n- **Cursor Hiding on Button Hover**: Implemented cursor: none on all interactive element hover states\n  - All buttons hide cursor on hover (primary, secondary, inline, booking, view, delete, submit, social)\n  - Navigation elements hide cursor (logo, links, booking button, theme toggle)\n  - Profile menu elements hide cursor (trigger and dropdown items)\n  - Plan Trip page chips and buttons hide cursor on hover\n  - Calendar controls and events hide cursor (with !important overrides for FullCalendar)\n  - Auth page buttons and mini-features hide cursor on hover\n  - Interactive cards hide cursor (feature cards, trip cards)\n  - Modal close buttons hide cursor in both light and dark modes\n  - Consistent implementation across all CSS files\n- **Comprehensive Dark Mode Fix**: Resolved dark theme issues across all pages and modals\n  - Standardized all dark mode selectors to `[data-theme=\"dark\"]` (removed mixed `body.dark-mode` usage)\n  - Fixed Home page: Hero section, features, trip cards, form inputs, buttons, modals\n  - Fixed Plan Trip page: Headers, welcome state, stats, testimonials, inputs, all text elements\n  - Fixed My Trips page: Trip card content, titles, descriptions, images\n  - Fixed Calendar page: Edit plan modal, form fields, labels, buttons\n  - Fixed Book Now popup: Booking sections, summary cards, detail sections, form elements, footer notes\n  - All text gradients, backgrounds, and borders now properly themed\n  - Enhanced accessibility with proper contrast in dark mode\n- **Navbar Cleanup**: Simplified navigation bar design\n  - Removed emojis from Calendar and Book Now buttons for a cleaner, more professional look\n  - Removed emojis from Start Planning and Set Preferences buttons on home page\n  - Kept theme toggle emoji for visual clarity\n- **Plan Trip Page Improvements**: Enhanced layout and user experience\n  - Optimized travel illustration size to 86% width (max 520px) for better visual presence while preventing text overflow\n  - Centered illustration with proper margins for better visual balance\n  - Fixed graphics side positioning to prevent image shifting when selecting suggestions\n  - Added \"✨ Others\" suggestion chip that focuses input without preset text\n  - Users can now easily choose custom trips or use suggested templates\n- **Header Spacing Optimization**: Refined navbar spacing for better visual balance\n  - Reduced nav-container padding from 1rem to 0.75rem for a more compact header\n  - Adjusted nav-links gap from 2rem to 1.5rem for tighter navigation spacing\n  - Added proper alignment and gap properties for cleaner layout\n  - All changes maintain responsive design across breakpoints\n- **Profile Menu Functionality Enhancement**: Fixed and improved profile dropdown behavior\n  - Implemented smooth opacity and transform animations for dropdown open/close\n  - Fixed timeout race condition using class-based state management (.show class)\n  - Profile dropdown now uses single source of truth for visibility state\n  - Proper z-index layering ensures dropdown appears above all content\n  - Smooth transitions with pointer-events management prevent click-through issues\n  - Rapid open/close toggle sequences work correctly without flickering\n- **Secure Toast Notification System**: Replaced all browser alerts with modern, animated toast notifications\n  - Four types: success, error, warning, info with color-coded styling\n  - XSS-safe implementation using textContent instead of innerHTML\n  - Auto-dismiss after 5 seconds, clickable to close manually\n  - Stacked vertical display with smooth slide-in animations\n  - Full dark mode support with themed colors\n  - Mobile responsive positioning\n- **Mobile Responsive Improvements**: Comprehensive breakpoints for all screen sizes\n  - Navbar scales appropriately at 1024px, 900px, 768px, and 640px breakpoints\n  - Profile dropdown repositions for optimal mobile viewing\n  - Horizontal scroll support for navigation links on small screens\n  - Toast notifications adjust position and sizing on mobile devices\n- **Profile Menu Added**: Complete profile dropdown in navbar's rightmost corner\n  - User avatar with auto-generated initials\n  - Displays user name and email\n  - Quick access to Settings, My Trips, and Calendar\n  - Logout functionality\n  - Smooth animations and full dark mode support\n  - Loads user data from localStorage automatically\n- **My Trips Page Enhanced**: Redesigned trip cards with rich detail display\n  - Location badges showing destination\n  - Trip highlights section with 3 key features per trip\n  - Duration information (e.g., \"5 days\")\n  - Prominent pricing display\n  - Staggered fade-in animations for visual appeal\n- **Plan Trip Page Cleanup**: Improved readability and fixed layout issues\n  - Removed colorful gradient overlays for cleaner interface\n  - Fixed navbar overlap with proper 80px top padding\n  - Clean, neutral backgrounds for better chat visibility\n\n## System Architecture\n\n### Application Architecture\nThe system employs a monolithic backend with an embedded static frontend. The backend is a FastAPI REST API server that handles travel query processing and serves static files. The frontend is built with vanilla JavaScript, eliminating framework dependencies and complex build tooling. This architecture prioritizes deployment simplicity and a lightweight frontend.\n\n### AI Agent Architecture\nThe AI agent is built using LangGraph with a ReAct (Reasoning + Acting) pattern. It utilizes `create_react_agent` for autonomous planning, powered by OpenAI GPT-4o for natural language understanding and reasoning. The agent operates through a reasoning loop where the LLM analyzes queries, decides which tools to invoke, executes them, and evaluates results to formulate complex multi-step travel plans. `ChatMessageHistory` maintains conversation context within sessions.\n\n### Tool System\nA decorator-based tool registry with Pydantic type validation defines eight modular tools:\n- `search_flights`: Flight search with pricing and schedules.\n- `search_hotels`: Accommodation discovery.\n- `get_weather_forecast`: Weather data.\n- `search_activities`: Local attractions and experiences.\n- `calculate_trip_budget`: Cost estimation.\n- `save_user_preferences`: Persist user preferences.\n- `get_user_preferences`: Retrieve user preferences.\n- `create_day_by_day_itinerary`: Generate daily schedules.\nThis modular design ensures maintainability and extensibility.\n\n### State Management\nThe system uses hybrid storage:\n- **Conversation State**: Ephemeral, in-memory `ChatMessageHistory` for active user sessions.\n- **User Preferences**: A global in-memory dictionary (`user_preferences_store`) for user preferences, accessed via dedicated tools. This would be replaced by persistent storage in a production environment.\n\n### UI/UX Decisions\nThe application features a multi-page design with stunning animations, eye-catching gradients, and responsive modals. Specific design elements include:\n- **Authentication**: Animated welcome page with floating gradient orbs, glassmorphic feature cards, and split-screen sign-in/sign-up pages with dark mode support.\n- **Plan Trip Page**: Immersive full-page split layout with an animated travel illustration, modern chat interface, quick action chips, live stats cards, and testimonials.\n- **My Trips Page**: Redesigned dynamic trip cards with detailed metadata, location badges, features, and prominent pricing. Features staggered fade-in animations and clickable cards that lead to a detailed booking modal.\n- **General**: Glassmorphism effects, vibrant gradients, SVG graphics, and comprehensive dark mode support across all pages.\n\n### Feature Specifications\n- **Authentication System**: Secure sign-in/sign-up, bcrypt password hashing, database-backed sessions, dynamic navigation, and mobile responsiveness.\n- **Booking System**: Secure Stripe payment integration, email validation, loading states, enhanced error handling, and comprehensive dark mode.\n- **Smart Chat-to-Booking Flow**: AI automatically detects trip details, intelligently handles missing origin information, and offers \"Book This Trip\" or \"Quick Book\" options with seamless auto-population of booking pages.\n- **Interactive Feature Explanations**: Clickable feature buttons on the welcome page provide detailed explanations in professional modal designs.\n\n## External Dependencies\n\n### AI/ML Services\n- **LangChain & LangGraph**: Core frameworks for agent orchestration, tool management, and ReAct agent implementation.\n- **Groq API**: Primary LLM provider (Llama 3.3 70B Versatile model) for ultra-fast inference, natural language understanding, reasoning, and response synthesis. Configured via `GROQ_API_KEY`.\n\n### Backend Framework\n- **FastAPI**: REST API server providing automatic OpenAPI documentation, async request handling, static file serving, and Pydantic integration.\n- **Uvicorn**: ASGI server for running the FastAPI application.\n\n### Data Validation\n- **Pydantic**: Used for request/response model validation, tool parameter type checking, and data serialization/deserialization.\n\n### External APIs (Mocked)\nAll external APIs are currently mocked for development and testing. Production integration points include:\n- Flight search APIs (e.g., Amadeus, Skyscanner)\n- Hotel booking APIs (e.g., Booking.com, Expedia)\n- Weather services (e.g., OpenWeatherMap, Weather.com)\n- Activity/attraction databases (e.g., Google Places, TripAdvisor)\n\n### Database\n- **Current**: SQLite (development) with PostgreSQL support for production.\n- **Models**: User, Session, Itinerary, Booking, and CalendarEvent to store user accounts, authentication tokens, trip plans, Stripe-integrated bookings, and calendar events.","size_bytes":11967},"static/app.js":{"content":"let currentPage = 'home';\nlet selectedFlight = null;\nlet selectedHotel = null;\nlet bookingTripDetails = null;\nlet toastCounter = 0;\nlet profileDropdownHideTimeout = null;\n\n// ========== TOAST NOTIFICATION SYSTEM (XSS-Safe) ==========\nfunction showToast(message, type = 'info', duration = 5000) {\n    const container = document.getElementById('toast-container');\n    if (!container) return;\n    \n    const toastId = `toast-${toastCounter++}`;\n    const icons = {\n        success: '✓',\n        error: '✕',\n        warning: '⚠',\n        info: 'ℹ'\n    };\n    \n    const titles = {\n        success: 'Success',\n        error: 'Error',\n        warning: 'Warning',\n        info: 'Info'\n    };\n    \n    // Create toast element safely using DOM methods\n    const toast = document.createElement('div');\n    toast.className = `toast toast-${type}`;\n    toast.id = toastId;\n    \n    // Create icon element\n    const iconEl = document.createElement('div');\n    iconEl.className = 'toast-icon';\n    iconEl.textContent = icons[type];\n    \n    // Create content container\n    const contentEl = document.createElement('div');\n    contentEl.className = 'toast-content';\n    \n    // Create title element\n    const titleEl = document.createElement('div');\n    titleEl.className = 'toast-title';\n    titleEl.textContent = titles[type];\n    \n    // Create message element (safe from XSS)\n    const messageEl = document.createElement('div');\n    messageEl.className = 'toast-message';\n    messageEl.textContent = message; // textContent prevents XSS\n    \n    // Create close button\n    const closeBtn = document.createElement('button');\n    closeBtn.className = 'toast-close';\n    closeBtn.textContent = '×';\n    closeBtn.onclick = () => closeToast(toastId);\n    \n    // Assemble the toast\n    contentEl.appendChild(titleEl);\n    contentEl.appendChild(messageEl);\n    toast.appendChild(iconEl);\n    toast.appendChild(contentEl);\n    toast.appendChild(closeBtn);\n    \n    container.appendChild(toast);\n    \n    if (duration > 0) {\n        setTimeout(() => {\n            closeToast(toastId);\n        }, duration);\n    }\n    \n    return toastId;\n}\n\nfunction closeToast(toastId) {\n    const toast = document.getElementById(toastId);\n    if (!toast) return;\n    \n    toast.classList.add('toast-hiding');\n    setTimeout(() => {\n        toast.remove();\n    }, 300);\n}\n\nfunction showSuccessToast(message, duration = 4000) {\n    return showToast(message, 'success', duration);\n}\n\nfunction showErrorToast(message, duration = 6000) {\n    return showToast(message, 'error', duration);\n}\n\nfunction showWarningToast(message, duration = 5000) {\n    return showToast(message, 'warning', duration);\n}\n\nfunction showInfoToast(message, duration = 4000) {\n    return showToast(message, 'info', duration);\n}\n\n// ========== THEME MANAGEMENT ==========\nfunction initTheme() {\n    const savedTheme = localStorage.getItem('theme') || 'light';\n    applyTheme(savedTheme);\n}\n\nfunction toggleTheme() {\n    const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';\n    const newTheme = currentTheme === 'light' ? 'dark' : 'light';\n    applyTheme(newTheme);\n}\n\nfunction applyTheme(theme) {\n    document.documentElement.setAttribute('data-theme', theme);\n    localStorage.setItem('theme', theme);\n    \n    const themeIcon = document.getElementById('theme-icon');\n    if (themeIcon) {\n        themeIcon.textContent = theme === 'dark' ? '☀️' : '🌙';\n    }\n    \n    // Add smooth transition\n    document.body.style.transition = 'background-color 0.3s ease, color 0.3s ease';\n}\n\nfunction navigateTo(page) {\n    // Add fade out animation\n    const currentActivePage = document.querySelector('.page.active');\n    if (currentActivePage) {\n        currentActivePage.style.animation = 'fadeOut 0.3s ease-out';\n        setTimeout(() => {\n            currentActivePage.classList.remove('active');\n            currentActivePage.style.animation = '';\n        }, 300);\n    }\n    \n    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));\n    \n    // Show/hide navbar based on page\n    const navbar = document.getElementById('main-navbar');\n    if (navbar) {\n        if (page === 'welcome' || page === 'signin' || page === 'signup') {\n            navbar.style.display = 'none';\n        } else {\n            navbar.style.display = 'block';\n        }\n    }\n    \n    const pageElement = document.getElementById(`${page}-page`);\n    if (pageElement) {\n        setTimeout(() => {\n            pageElement.classList.add('active');\n            currentPage = page;\n            \n            const navLink = document.querySelector(`[data-page=\"${page}\"]`);\n            if (navLink) {\n                navLink.classList.add('active');\n            }\n            \n            window.scrollTo({ top: 0, behavior: 'smooth' });\n            \n            if (page === 'preferences') {\n                loadPreferences();\n            } else if (page === 'trips') {\n                loadMyTrips();\n            } else if (page === 'calendar') {\n                loadCalendar();\n            } else if (page === 'plan') {\n                // Show welcome message if chat is empty\n                setTimeout(() => showWelcomeMessage(), 100);\n            } else if (page === 'booking') {\n                // Show price summary footer on booking page\n                const footer = document.getElementById(\"price-summary-footer\");\n                if (footer) {\n                    footer.style.display = \"block\";\n                }\n                if (!bookingTripDetails) {\n                    // If booking page opened without trip details, try to load from chat\n                    openBookingPageFromChat();\n                }\n            } else {\n                // Hide price summary footer on other pages\n                const footer = document.getElementById(\"price-summary-footer\");\n                if (footer) {\n                    footer.style.display = \"none\";\n                }\n            }\n        }, currentActivePage ? 300 : 0);\n    }\n}\n\n// Add fadeOut animation\nconst style = document.createElement('style');\nstyle.textContent = `\n    @keyframes fadeOut {\n        from {\n            opacity: 1;\n            transform: translateY(0);\n        }\n        to {\n            opacity: 0;\n            transform: translateY(-20px);\n        }\n    }\n`;\ndocument.head.appendChild(style);\n\nwindow.addEventListener('scroll', () => {\n    const navbar = document.querySelector('.navbar');\n    if (window.scrollY > 50) {\n        navbar.classList.add('scrolled');\n    } else {\n        navbar.classList.remove('scrolled');\n    }\n});\n\nfunction showWelcomeMessage() {\n    const messagesDiv = document.getElementById('chat-messages');\n    if (!messagesDiv || messagesDiv.children.length > 0) return;\n    \n    messagesDiv.innerHTML = `\n        <div class=\"welcome-message\">\n            <svg width=\"80\" height=\"80\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" style=\"margin-bottom: 1.5rem;\">\n                <path d=\"M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z\" fill=\"url(#gradient)\"/>\n                <defs>\n                    <linearGradient id=\"gradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n                        <stop offset=\"0%\" style=\"stop-color:#667eea;stop-opacity:1\" />\n                        <stop offset=\"50%\" style=\"stop-color:#764ba2;stop-opacity:1\" />\n                        <stop offset=\"100%\" style=\"stop-color:#f093fb;stop-opacity:1\" />\n                    </linearGradient>\n                </defs>\n            </svg>\n            <h2>Ready to Plan Your Dream Trip?</h2>\n            <p>Tell me where you want to go, your budget, and dates. I'll handle everything from flights to accommodations to daily activities!</p>\n            <div style=\"display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; margin-top: 2rem;\">\n                <div style=\"text-align: center; padding: 1rem; background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(168, 85, 247, 0.1) 100%); border-radius: 12px; max-width: 200px;\">\n                    <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path d=\"M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z\" fill=\"url(#icon-grad)\"/>\n                        <defs><linearGradient id=\"icon-grad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\"><stop offset=\"0%\" style=\"stop-color:#667eea\" /><stop offset=\"100%\" style=\"stop-color:#764ba2\" /></linearGradient></defs>\n                    </svg>\n                    <div style=\"margin-top: 0.5rem; font-weight: 600; color: var(--primary);\">Smart Scheduling</div>\n                </div>\n                <div style=\"text-align: center; padding: 1rem; background: linear-gradient(135deg, rgba(168, 85, 247, 0.1) 0%, rgba(236, 72, 153, 0.1) 100%); border-radius: 12px; max-width: 200px;\">\n                    <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path d=\"M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z\" fill=\"url(#budget-grad)\"/>\n                        <defs><linearGradient id=\"budget-grad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\"><stop offset=\"0%\" style=\"stop-color:#764ba2\" /><stop offset=\"100%\" style=\"stop-color:#f093fb\" /></linearGradient></defs>\n                    </svg>\n                    <div style=\"margin-top: 0.5rem; font-weight: 600; color: #a855f7;\">Budget Friendly</div>\n                </div>\n                <div style=\"text-align: center; padding: 1rem; background: linear-gradient(135deg, rgba(236, 72, 153, 0.1) 0%, rgba(99, 102, 241, 0.1) 100%); border-radius: 12px; max-width: 200px;\">\n                    <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path d=\"M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20v6z\" fill=\"url(#activity-grad)\"/>\n                        <defs><linearGradient id=\"activity-grad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\"><stop offset=\"0%\" style=\"stop-color:#ec4899\" /><stop offset=\"100%\" style=\"stop-color:#667eea\" /></linearGradient></defs>\n                    </svg>\n                    <div style=\"margin-top: 0.5rem; font-weight: 600; color: #ec4899;\">Personalized</div>\n                </div>\n            </div>\n        </div>\n    `;\n}\n\nfunction addMessage(role, content, isTyping = false, animate = true) {\n    const messagesDiv = document.getElementById('chat-messages');\n    const messageDiv = document.createElement('div');\n    messageDiv.className = `message ${role}`;\n    messageDiv.style.opacity = '0';\n    messageDiv.style.transform = 'translateY(20px) scale(0.95)';\n    \n    if (isTyping) {\n        messageDiv.innerHTML = `\n            <div class=\"message-content typing-indicator\">\n                <span></span>\n                <span></span>\n                <span></span>\n            </div>\n        `;\n    } else {\n        messageDiv.innerHTML = `\n            <div class=\"message-content\">\n                ${formatMessage(content)}\n            </div>\n        `;\n    }\n    \n    messagesDiv.appendChild(messageDiv);\n    messagesDiv.scrollTop = messagesDiv.scrollHeight;\n    \n    // Enhanced entrance animation with spring effect\n    if (animate) {\n        setTimeout(() => {\n            messageDiv.style.transition = 'all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1)';\n            messageDiv.style.opacity = '1';\n            messageDiv.style.transform = 'translateY(0) scale(1)';\n        }, 10);\n    } else {\n        messageDiv.style.opacity = '1';\n        messageDiv.style.transform = 'translateY(0) scale(1)';\n    }\n    \n    // Add shimmer effect for AI messages\n    if (role === 'assistant' && !isTyping) {\n        setTimeout(() => {\n            messageDiv.classList.add('message-highlight');\n            setTimeout(() => {\n                messageDiv.classList.remove('message-highlight');\n            }, 1000);\n        }, 200);\n    }\n}\n\nfunction formatMessage(content) {\n    // Convert markdown-style formatting\n    content = content.replace(/\\n/g, '<br>');\n    content = content.replace(/```json\\n([\\s\\S]*?)\\n```/g, '<pre><code>$1</code></pre>');\n    content = content.replace(/```([\\s\\S]*?)```/g, '<pre><code>$1</code></pre>');\n    content = content.replace(/(https?:\\/\\/[^\\s]+)/g, '<a href=\"$1\" target=\"_blank\">$1</a>');\n    \n    // Handle inline buttons\n    content = content.replace(/<button class=\"btn-inline\"/g, '<button class=\"btn-inline\" style=\"margin: 0.5rem 0; padding: 0.5rem 1rem; background: var(--primary); color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 0.9rem;\"');\n    \n    // Format code blocks\n    content = content.replace(/<code>([^<]+)<\\/code>/g, '<code style=\"background: rgba(0,0,0,0.1); padding: 0.2rem 0.4rem; border-radius: 4px; font-family: monospace;\">$1</code>');\n    \n    return content;\n}\n\nasync function sendMessage() {\n    const input = document.getElementById('chat-input');\n    const sendBtn = document.getElementById('send-btn');\n    const message = input.value.trim();\n    \n    if (!message) return;\n    \n    addMessage('user', message);\n    input.value = '';\n    \n    // Add typing indicator\n    const typingId = Date.now();\n    addMessage('assistant', '', true);\n    \n    sendBtn.disabled = true;\n    sendBtn.classList.add('spinning');\n    sendBtn.innerHTML = '<span class=\"loading-spinner\"></span> Planning...';\n    \n    try {\n        const response = await fetch('/api/plan', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({ query: message })\n        });\n        \n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        \n        const data = await response.json();\n        \n        if (data.status === 'success') {\n            let responseText = data.response || '';\n            \n            // Check if response contains booking information\n            const bookingMatch = responseText.match(/booking[_\\s]?id[:\\s]+([A-Z0-9]+)/i);\n            if (bookingMatch) {\n                const bookingId = bookingMatch[1];\n                responseText += `\\n\\n💳 <strong>Booking Created!</strong> Your booking ID is: <code>${bookingId}</code>\\n\\nWould you like to proceed to payment? <button class=\"btn-inline\" onclick=\"navigateTo('trips'); setTimeout(() => loadMyTrips(), 500);\">View My Bookings</button>`;\n            }\n            \n            // Check for booking data in JSON format\n            try {\n                const jsonMatch = responseText.match(/\\{[\\s\\S]*\"booking_id\"[\\s\\S]*\\}/);\n                if (jsonMatch) {\n                    const bookingInfo = JSON.parse(jsonMatch[0]);\n                    if (bookingInfo.booking_id) {\n                        responseText = responseText.replace(jsonMatch[0], '');\n                        responseText += `\\n\\n💳 <strong>Booking Created!</strong> Your booking ID is: <code>${bookingInfo.booking_id}</code>\\n\\n<button class=\"btn-inline\" onclick=\"navigateTo('trips'); setTimeout(() => loadMyTrips(), 500);\">View My Bookings</button>`;\n                    }\n                }\n            } catch (e) {\n                // Not JSON, continue\n            }\n            \n            // Remove typing indicator\n            const messagesDiv = document.getElementById('chat-messages');\n            const typingIndicator = messagesDiv.querySelector('.typing-indicator');\n            if (typingIndicator) {\n                typingIndicator.closest('.message').remove();\n            }\n            \n            addMessage('assistant', responseText);\n            \n            // Always try to extract trip details from AI response\n            // This ensures booking buttons appear after ANY trip planning, not just when user says \"book\"\n            setTimeout(() => {\n                extractAndCreateBooking(responseText, message);\n            }, 500);\n        } else {\n            // Remove typing indicator\n            const messagesDiv = document.getElementById('chat-messages');\n            const typingIndicator = messagesDiv.querySelector('.typing-indicator');\n            if (typingIndicator) {\n                typingIndicator.closest('.message').remove();\n            }\n            \n            const errorMsg = data.error || 'Something went wrong';\n            addMessage('assistant', '❌ Error: ' + errorMsg);\n        }\n    } catch (error) {\n        console.error('Chat error:', error);\n        \n        // Remove typing indicator\n        const messagesDiv = document.getElementById('chat-messages');\n        const typingIndicator = messagesDiv.querySelector('.typing-indicator');\n        if (typingIndicator) {\n            typingIndicator.closest('.message').remove();\n        }\n        \n        addMessage('assistant', '❌ Error connecting to server: ' + error.message + '\\n\\nPlease check if the server is running and try again.');\n    } finally {\n        sendBtn.disabled = false;\n        sendBtn.classList.remove('spinning');\n        sendBtn.innerHTML = '✈️ Send';\n    }\n}\n\nasync function extractAndCreateBooking(aiResponse, userMessage) {\n    // Try to extract booking details from AI response\n    try {\n        // Check if we're waiting for origin from a previous trip detection\n        if (window.partialTripDetails) {\n            // User is responding with their origin city\n            const originFromUser = userMessage.trim();\n            \n            // Validate it looks like a city name (basic check)\n            if (originFromUser.length > 1 && /^[A-Za-z\\s]+$/.test(originFromUser)) {\n                // Complete the trip details with the provided origin\n                window.lastTripDetails = {\n                    ...window.partialTripDetails,\n                    origin: originFromUser\n                };\n                \n                const tripDetails = window.lastTripDetails;\n                \n                // Clear partial details\n                delete window.partialTripDetails;\n                \n                // Calculate trip duration\n                const durationDays = Math.ceil((new Date(tripDetails.end_date) - new Date(tripDetails.start_date)) / (1000 * 60 * 60 * 24)) || 1;\n                const tripName = `Trip to ${tripDetails.destination}`;\n                \n                // Automatically save trip to My Trips and trigger booking\n                setTimeout(async () => {\n                    const summaryPrompt = `✨ <strong>Trip Plan Complete!</strong>\\n\\n📍 <strong>Destination:</strong> ${tripDetails.destination}\\n✈️ <strong>Origin:</strong> ${tripDetails.origin}\\n📅 <strong>Dates:</strong> ${tripDetails.start_date} to ${tripDetails.end_date}\\n👥 <strong>Passengers:</strong> ${tripDetails.passengers}\\n💰 <strong>Budget:</strong> $${tripDetails.budget.toFixed(2)}\\n\\n🔄 Saving to My Trips and opening booking...`;\n                    addMessage('assistant', summaryPrompt);\n                    \n                    try {\n                        // Save trip as itinerary\n                        const itineraryResponse = await fetch('/api/itineraries', {\n                            method: 'POST',\n                            headers: { 'Content-Type': 'application/json' },\n                            body: JSON.stringify({\n                                trip_name: tripName,\n                                destination: tripDetails.destination,\n                                start_date: tripDetails.start_date,\n                                end_date: tripDetails.end_date,\n                                duration_days: durationDays,\n                                budget: tripDetails.budget,\n                                description: `Trip from ${tripDetails.origin} to ${tripDetails.destination} for ${tripDetails.passengers} passenger(s)`,\n                                itinerary_data: {\n                                    origin: tripDetails.origin,\n                                    passengers: tripDetails.passengers,\n                                    ai_generated: true\n                                }\n                            })\n                        });\n                        \n                        const itineraryData = await itineraryResponse.json();\n                        \n                        if (itineraryData.status === 'success') {\n                            showToast('✅ Trip saved to My Trips!', 'success');\n                            \n                            // Automatically open booking modal\n                            setTimeout(() => {\n                                openBookingWithDetails();\n                            }, 500);\n                        } else {\n                            showToast('⚠️ Trip details ready, but could not auto-save. You can still book!', 'warning');\n                            // Still open booking even if save failed\n                            setTimeout(() => {\n                                openBookingWithDetails();\n                            }, 500);\n                        }\n                    } catch (error) {\n                        console.error('Error auto-saving trip:', error);\n                        showToast('⚠️ Trip details ready, but could not auto-save. Opening booking...', 'warning');\n                        // Still open booking even if save failed\n                        setTimeout(() => {\n                            openBookingWithDetails();\n                        }, 500);\n                    }\n                }, 800);\n                return;\n            }\n        }\n        \n        // Look for structured data in the response\n        const destinationMatch = aiResponse.match(/destination[:\\s]+([^\\n,]+)/i) || \n                                 userMessage.match(/(?:to|in|visit|going to)\\s+([A-Z][a-z]+(?:\\s+[A-Z][a-z]+)*)/i) ||\n                                 aiResponse.match(/(?:trip to|visit|going to)\\s+([A-Z][a-z]+(?:\\s+[A-Z][a-z]+)*)/i);\n        \n        // Only proceed if we have a clear destination\n        if (!destinationMatch) {\n            return; // No trip details found, silently exit\n        }\n        \n        const dateMatch = aiResponse.match(/(\\d{4}-\\d{2}-\\d{2})/g) || userMessage.match(/(\\d{4}-\\d{2}-\\d{2})/g);\n        const passengerMatch = aiResponse.match(/(\\d+)\\s*(?:passenger|person|people|guest)/i) || \n                              userMessage.match(/(\\d+)\\s*(?:passenger|person|people|guest)/i) ||\n                              userMessage.match(/(?:for|with)\\s+(\\d+)/i);\n        const budgetMatch = aiResponse.match(/budget[:\\s]+\\$?(\\d+(?:,\\d{3})*(?:\\.\\d{2})?)/i) ||\n                           userMessage.match(/budget[:\\s]+\\$?(\\d+(?:,\\d{3})*(?:\\.\\d{2})?)/i);\n        const originMatch = aiResponse.match(/(?:from|origin|starting from|departing from)[:\\s]+([^\\n,]+)/i) ||\n                           userMessage.match(/(?:from|starting from)\\s+([A-Z][a-z]+(?:\\s+[A-Z][a-z]+)*)/i);\n        \n        const destination = destinationMatch[1].trim().replace(/[^\\w\\s-]/g, '');\n        \n        // Use stored origin from previous trips, or ask user if not found\n        let origin = null;\n        if (originMatch) {\n            origin = originMatch[1].trim().replace(/[^\\w\\s-]/g, '');\n        } else if (window.lastTripDetails && window.lastTripDetails.origin) {\n            origin = window.lastTripDetails.origin; // Reuse from previous trip\n        }\n        \n        const startDate = dateMatch && dateMatch.length >= 1 ? dateMatch[0] : new Date().toISOString().split('T')[0];\n        const endDate = dateMatch && dateMatch.length >= 2 ? dateMatch[1] : \n                       dateMatch && dateMatch.length >= 1 ? dateMatch[0] : \n                       new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];\n        const passengers = passengerMatch ? parseInt(passengerMatch[1]) : 1;\n        const budget = budgetMatch ? parseFloat(budgetMatch[1].replace(/,/g, '')) : 1000.0;\n        \n        // If we don't have an origin, ask the user\n        if (!origin) {\n            setTimeout(() => {\n                const originPrompt = `✨ <strong>Trip to ${destination} detected!</strong>\\n\\n📅 <strong>Dates:</strong> ${startDate} to ${endDate}\\n👥 <strong>Passengers:</strong> ${passengers}\\n\\n⚠️ <strong>Where are you traveling from?</strong>\\n\\nPlease reply with your departure city (e.g., \"New York\", \"London\", \"Tokyo\")`;\n                addMessage('assistant', originPrompt);\n                \n                // Store partial details to complete later\n                window.partialTripDetails = {\n                    destination: destination,\n                    start_date: startDate,\n                    end_date: endDate,\n                    passengers: passengers,\n                    budget: budget\n                };\n            }, 800);\n            return;\n        }\n        \n        // Store complete trip details for booking\n        window.lastTripDetails = {\n            destination: destination,\n            origin: origin,\n            start_date: startDate,\n            end_date: endDate,\n            passengers: passengers,\n            budget: budget\n        };\n        \n        // Calculate trip duration\n        const durationDays = Math.ceil((new Date(endDate) - new Date(startDate)) / (1000 * 60 * 60 * 24)) || 1;\n        const tripName = `Trip to ${destination}`;\n        \n        // Automatically save trip to My Trips and trigger booking\n        setTimeout(async () => {\n            const summaryPrompt = `✨ <strong>Trip Plan Complete!</strong>\\n\\n📍 <strong>Destination:</strong> ${destination}\\n✈️ <strong>Origin:</strong> ${origin}\\n📅 <strong>Dates:</strong> ${startDate} to ${endDate}\\n👥 <strong>Passengers:</strong> ${passengers}\\n💰 <strong>Budget:</strong> $${budget.toFixed(2)}\\n\\n🔄 Saving to My Trips and opening booking...`;\n            addMessage('assistant', summaryPrompt);\n            \n            try {\n                // Save trip as itinerary\n                const itineraryResponse = await fetch('/api/itineraries', {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({\n                        trip_name: tripName,\n                        destination: destination,\n                        start_date: startDate,\n                        end_date: endDate,\n                        duration_days: durationDays,\n                        budget: budget,\n                        description: `Trip from ${origin} to ${destination} for ${passengers} passenger(s)`,\n                        itinerary_data: {\n                            origin: origin,\n                            passengers: passengers,\n                            ai_generated: true\n                        }\n                    })\n                });\n                \n                const itineraryData = await itineraryResponse.json();\n                \n                if (itineraryData.status === 'success') {\n                    showToast('✅ Trip saved to My Trips!', 'success');\n                    \n                    // Automatically open booking modal\n                    setTimeout(() => {\n                        openBookingWithDetails();\n                    }, 500);\n                } else {\n                    showToast('⚠️ Trip details ready, but could not auto-save. You can still book!', 'warning');\n                    // Still open booking even if save failed\n                    setTimeout(() => {\n                        openBookingWithDetails();\n                    }, 500);\n                }\n            } catch (error) {\n                console.error('Error auto-saving trip:', error);\n                showToast('⚠️ Trip details ready, but could not auto-save. Opening booking...', 'warning');\n                // Still open booking even if save failed\n                setTimeout(() => {\n                    openBookingWithDetails();\n                }, 500);\n            }\n        }, 1000);\n    } catch (error) {\n        console.error('Error extracting booking details:', error);\n    }\n}\n\nfunction openBookingWithDetails() {\n    // Open booking page with trip details from chat\n    if (window.lastTripDetails) {\n        bookingTripDetails = window.lastTripDetails;\n        selectedFlight = null;\n        selectedHotel = null;\n        \n        // Fetch booking options with trip details\n        fetch(\"/api/booking-options\", {\n            method: \"POST\",\n            headers: { \"Content-Type\": \"application/json\" },\n            body: JSON.stringify({ trip_details: window.lastTripDetails })\n        })\n        .then(response => response.json())\n        .then(data => {\n            if (data.status === \"success\") {\n                bookingTripDetails = data.trip_details;\n                navigateTo(\"booking\");\n                setTimeout(() => loadBookingOptions(data), 300);\n            } else {\n                alert(\"Unable to load booking options: \" + (data.error || \"Unknown error\"));\n            }\n        })\n        .catch(error => {\n            alert(\"Error loading booking options: \" + error.message);\n        });\n    } else {\n        alert(\"No trip details found. Please plan a trip first!\");\n    }\n}\n\nasync function createQuickBooking(destination, startDate, endDate, passengers, budget) {\n    // Quick booking without selecting flights/hotels\n    try {\n        const tripName = `Trip to ${destination}`;\n        const tripId = `chat-booking-${destination.toLowerCase().replace(/\\s+/g, '-')}`;\n        \n        const response = await fetch('/api/bookings', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n                trip_id: tripId,\n                trip_name: tripName,\n                destination: destination,\n                start_date: startDate,\n                end_date: endDate,\n                total_price: budget,\n                passengers: passengers,\n                flight_details: {},\n                hotel_details: {}\n            })\n        });\n        \n        const data = await response.json();\n        \n        if (data.status === 'success') {\n            addMessage('assistant', `✅ <strong>Quick Booking Created!</strong>\\n\\nBooking ID: <code>${data.booking_id}</code>\\n\\nYou can view and manage your booking in \"My Trips\" or proceed to payment.\\n\\n<button class=\"btn-inline\" onclick=\"navigateTo('trips'); setTimeout(() => loadMyTrips(), 500);\">View My Trips</button>`);\n        } else {\n            addMessage('assistant', '❌ Error creating booking: ' + (data.error || 'Unknown error'));\n        }\n    } catch (error) {\n        addMessage('assistant', '❌ Error creating booking: ' + error.message);\n    }\n}\n\nasync function createBookingFromChat(destination, startDate, endDate, passengers, basePrice) {\n    try {\n        const tripName = `Trip to ${destination}`;\n        const tripId = `chat-booking-${destination.toLowerCase().replace(/\\s+/g, '-')}`;\n        \n        const response = await fetch('/api/bookings', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n                trip_id: tripId,\n                trip_name: tripName,\n                destination: destination,\n                start_date: startDate,\n                end_date: endDate,\n                total_price: basePrice * passengers,\n                passengers: passengers,\n                flight_details: {},\n                hotel_details: {}\n            })\n        });\n        \n        const data = await response.json();\n        \n        if (data.status === 'success') {\n            addMessage('assistant', `✅ Booking created successfully! Booking ID: <strong>${data.booking_id}</strong>\\n\\nYou can now proceed to payment from the \"My Trips\" page.`);\n            setTimeout(() => {\n                navigateTo('trips');\n                loadMyTrips();\n            }, 2000);\n        } else {\n            addMessage('assistant', '❌ Error creating booking: ' + (data.error || 'Unknown error'));\n        }\n    } catch (error) {\n        addMessage('assistant', '❌ Error creating booking: ' + error.message);\n    }\n}\n\nasync function clearChat() {\n    if (confirm('Clear conversation history?')) {\n        const messagesDiv = document.getElementById('chat-messages');\n        messagesDiv.innerHTML = '';\n        \n        try {\n            await fetch('/api/reset', { method: 'POST' });\n        } catch (error) {\n            console.error('Error resetting memory:', error);\n        }\n        \n        addMessage('assistant', \n            '👋 Chat cleared! Ready to help you plan your next adventure. Where would you like to go? 🌍'\n        );\n    }\n}\n\nfunction setQuickExample(text) {\n    document.getElementById('chat-input').value = text;\n    navigateTo('plan');\n    setTimeout(() => {\n        document.getElementById('chat-input').focus();\n    }, 100);\n}\n\nasync function loadPreferences() {\n    try {\n        const response = await fetch('/api/preferences');\n        const data = await response.json();\n        \n        const prefsDiv = document.getElementById('saved-preferences');\n        if (data.preferences && Object.keys(data.preferences).length > 0) {\n            let html = '<div class=\"preferences-card\"><h3>Your Saved Preferences</h3>';\n            for (const [key, value] of Object.entries(data.preferences)) {\n                html += `<p><strong>${key}:</strong> ${JSON.stringify(value)}</p>`;\n            }\n            html += '</div>';\n            prefsDiv.innerHTML = html;\n        } else {\n            prefsDiv.innerHTML = '<div class=\"preferences-card\"><p>No preferences saved yet. Chat with the AI to save your preferences!</p></div>';\n        }\n    } catch (error) {\n        console.error('Error loading preferences:', error);\n    }\n}\n\nasync function savePreferencesForm() {\n    const budget = document.getElementById('pref-budget').value;\n    const style = document.getElementById('pref-style').value;\n    const activities = document.getElementById('pref-activities').value;\n    \n    const message = `Save my preferences: budget style is ${budget}, I prefer ${style} accommodations, and I enjoy ${activities}`;\n    \n    navigateTo('plan');\n    document.getElementById('chat-input').value = message;\n    await sendMessage();\n}\n\nasync function openBookingModal(tripId, tripName, destination, startDate, endDate, price) {\n    const modal = document.getElementById('booking-modal');\n    const modalBody = document.querySelector('#booking-modal .modal-body');\n    \n    const tripImages = {\n        'goa-beach': '🏖️',\n        'paris-family': '🗼',\n        'manali-adventure': '⛰️'\n    };\n    \n    const tripIcon = tripImages[tripId] || '✈️';\n    \n    modalBody.innerHTML = `\n        <div class=\"booking-hero\">\n            <div class=\"booking-hero-icon\">${tripIcon}</div>\n            <div class=\"booking-hero-content\">\n                <h3 class=\"booking-destination\">${destination}</h3>\n                <p class=\"booking-subtitle\">${tripName}</p>\n            </div>\n        </div>\n        \n        <div class=\"booking-summary-card\">\n            <div class=\"booking-row\">\n                <div class=\"booking-detail\">\n                    <div class=\"booking-icon\">📅</div>\n                    <div>\n                        <div class=\"detail-label\">Travel Dates</div>\n                        <div class=\"detail-value\">${startDate} to ${endDate}</div>\n                    </div>\n                </div>\n            </div>\n            \n            <div class=\"booking-row\">\n                <div class=\"booking-detail\">\n                    <div class=\"booking-icon\">👥</div>\n                    <div>\n                        <div class=\"detail-label\">Passengers</div>\n                        <div class=\"passenger-controls\">\n                            <button class=\"passenger-btn\" onclick=\"updatePassengers(-1, ${price})\" type=\"button\">\n                                <span>−</span>\n                            </button>\n                            <input type=\"number\" id=\"passengers\" min=\"1\" max=\"10\" value=\"1\" readonly>\n                            <button class=\"passenger-btn\" onclick=\"updatePassengers(1, ${price})\" type=\"button\">\n                                <span>+</span>\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"price-breakdown-card\">\n            <h4 style=\"margin-bottom: 1rem; color: var(--dark); font-size: 1.1rem;\">💰 Price Breakdown</h4>\n            <div class=\"price-row\">\n                <span>Base price per person</span>\n                <span id=\"base-price\">$${price.toFixed(2)}</span>\n            </div>\n            <div class=\"price-row\">\n                <span>Number of passengers</span>\n                <span id=\"passenger-count\">1</span>\n            </div>\n            <div class=\"price-divider\"></div>\n            <div class=\"price-row total-row\">\n                <span><strong>Total Amount</strong></span>\n                <span id=\"total-price\" class=\"total-price\">$${price.toFixed(2)}</span>\n            </div>\n        </div>\n        \n        <div class=\"trust-badges\">\n            <div class=\"trust-badge\">\n                <span>🔒</span>\n                <span>Secure Payment</span>\n            </div>\n            <div class=\"trust-badge\">\n                <span>✓</span>\n                <span>Instant Confirmation</span>\n            </div>\n            <div class=\"trust-badge\">\n                <span>🛡️</span>\n                <span>Protected Booking</span>\n            </div>\n        </div>\n        \n        <div class=\"booking-form\">\n            <div class=\"form-group-modern\">\n                <label class=\"form-label-modern\">\n                    <span class=\"label-icon\">✉️</span>\n                    <span>Contact Email</span>\n                </label>\n                <input type=\"email\" id=\"booking-email\" class=\"form-input-modern\" placeholder=\"your@email.com\" required>\n            </div>\n            \n            <div class=\"form-group-modern\">\n                <label class=\"form-label-modern\">\n                    <span class=\"label-icon\">📝</span>\n                    <span>Special Requests (Optional)</span>\n                </label>\n                <textarea id=\"special-requests\" class=\"form-input-modern\" rows=\"3\" placeholder=\"Dietary restrictions, accessibility needs, room preferences...\"></textarea>\n            </div>\n        </div>\n        \n        <button class=\"btn-booking-cta\" onclick=\"processBooking('${tripId}', '${tripName}', '${destination}', '${startDate}', '${endDate}', ${price})\">\n            <span class=\"cta-text\">Proceed to Secure Payment</span>\n            <span class=\"cta-icon\">💳</span>\n        </button>\n        \n        <div class=\"booking-footer-note\">\n            <p>🔐 Your payment is processed securely through Stripe. You'll be redirected to complete your booking.</p>\n        </div>\n    `;\n    \n    modal.classList.add('active');\n}\n\nfunction updatePassengers(change, basePrice) {\n    const input = document.getElementById('passengers');\n    let current = parseInt(input.value) || 1;\n    current = Math.max(1, Math.min(10, current + change));\n    input.value = current;\n    \n    const total = basePrice * current;\n    document.getElementById('total-price').textContent = `$${total.toFixed(2)}`;\n    document.getElementById('passenger-count').textContent = current;\n    \n    const totalElement = document.getElementById('total-price');\n    totalElement.style.transform = 'scale(1.1)';\n    setTimeout(() => {\n        totalElement.style.transform = 'scale(1)';\n    }, 200);\n}\n\nasync function processBooking(tripId, tripName, destination, startDate, endDate, basePrice) {\n    const email = document.getElementById('booking-email').value;\n    const passengers = parseInt(document.getElementById('passengers').value) || 1;\n    const specialRequests = document.getElementById('special-requests').value;\n    const totalPrice = basePrice * passengers;\n    \n    if (!email) {\n        alert('Please enter your email address');\n        return;\n    }\n    \n    try {\n        const bookingResponse = await fetch('/api/bookings', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n                trip_id: tripId,\n                trip_name: tripName,\n                destination: destination,\n                start_date: startDate,\n                end_date: endDate,\n                total_price: totalPrice,\n                passengers: passengers,\n                flight_details: { email, special_requests: specialRequests },\n                hotel_details: {}\n            })\n        });\n        \n        const bookingData = await bookingResponse.json();\n        \n        if (bookingData.status === 'success') {\n            const paymentResponse = await fetch('/api/create-checkout-session', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                    booking_id: bookingData.booking_id,\n                    amount: totalPrice\n                })\n            });\n            \n            const paymentData = await paymentResponse.json();\n            \n            if (paymentData.status === 'success') {\n                window.location.href = paymentData.checkout_url;\n            } else {\n                alert('Error creating payment session: ' + (paymentData.error || 'Unknown error'));\n            }\n        }\n    } catch (error) {\n        alert('Error processing booking: ' + error.message);\n    }\n}\n\nfunction closeModal(modalId) {\n    const modal = document.getElementById(modalId);\n    modal.classList.remove('active');\n}\n\nlet calendar = null;\nlet currentEditingEvent = null;\n\nasync function loadCalendar() {\n    const calendarEl = document.getElementById('calendar-container');\n    if (!calendarEl) return;\n    \n    // Initialize FullCalendar if not already done\n    if (!calendar) {\n        calendar = new FullCalendar.Calendar(calendarEl, {\n            initialView: 'dayGridMonth',\n            headerToolbar: {\n                left: 'prev,next today',\n                center: 'title',\n                right: ''\n            },\n            editable: true,\n            droppable: false,\n            selectable: true,\n            selectMirror: true,\n            dayMaxEvents: true,\n            weekends: true,\n            navLinks: true,\n            eventClick: function(info) {\n                openEventModalForEdit(info.event);\n            },\n            dateClick: function(info) {\n                openEventModalForDate(info.dateStr);\n            },\n            eventDrop: function(info) {\n                updateEventDates(info.event);\n            },\n            eventResize: function(info) {\n                updateEventDates(info.event);\n            },\n            events: async function(fetchInfo, successCallback, failureCallback) {\n                try {\n                    const response = await fetch(`/api/calendar/events?start=${fetchInfo.startStr}&end=${fetchInfo.endStr}`);\n                    if (!response.ok) {\n                        console.error('HTTP error loading events:', response.status, response.statusText);\n                        failureCallback();\n                        return;\n                    }\n                    const data = await response.json();\n                    console.log('Events loaded:', data);\n                    if (data.status === 'success' && Array.isArray(data.events)) {\n                        console.log(`Loaded ${data.events.length} events`);\n                        successCallback(data.events);\n                    } else {\n                        console.error('Invalid response format:', data);\n                        failureCallback();\n                    }\n                } catch (error) {\n                    console.error('Error loading events:', error);\n                    failureCallback();\n                }\n            },\n            eventContent: function(info) {\n                const event = info.event;\n                const props = event.extendedProps || {};\n                const title = event.title || 'Untitled Event';\n                \n                let icon = '';\n                if (props.is_booking) {\n                    icon = '✈️';\n                } else if (props.event_type === 'reminder') {\n                    icon = '🔔';\n                } else if (props.event_type === 'trip') {\n                    icon = '🗺️';\n                } else if (props.event_type === 'personal') {\n                    icon = '📌';\n                } else {\n                    icon = '📅';\n                }\n                \n                const html = `\n                    <div style=\"\n                        padding: 4px 6px;\n                        font-size: 0.85rem;\n                        font-weight: 600;\n                        white-space: nowrap;\n                        overflow: hidden;\n                        text-overflow: ellipsis;\n                        display: flex;\n                        align-items: center;\n                        gap: 4px;\n                    \">\n                        <span>${icon}</span>\n                        <span>${title}</span>\n                    </div>\n                `;\n                \n                return { html: html };\n            },\n            eventDidMount: function(info) {\n                // Add hover tooltip with description\n                if (info.event.extendedProps && info.event.extendedProps.description) {\n                    info.el.setAttribute('title', info.event.extendedProps.description);\n                }\n            },\n            height: 'auto',\n            contentHeight: 'auto',\n            aspectRatio: 1.8,\n            loading: function(isLoading) {\n                if (isLoading) {\n                    calendarEl.classList.add('loading');\n                } else {\n                    calendarEl.classList.remove('loading');\n                    updateCalendarStats();\n                }\n            }\n        });\n        \n        calendar.render();\n        \n        // Hide loading state after render\n        setTimeout(() => {\n            calendarEl.classList.remove('loading');\n            updateCalendarStats();\n        }, 500);\n    } else {\n        // Refresh events\n        calendar.refetchEvents();\n        setTimeout(() => {\n            calendarEl.classList.remove('loading');\n            updateCalendarStats();\n        }, 500);\n    }\n}\n\n// Switch calendar view\nfunction switchCalendarView(viewName) {\n    if (calendar) {\n        calendar.changeView(viewName);\n        // Update active button\n        document.querySelectorAll('.view-btn').forEach(btn => {\n            btn.classList.remove('active');\n        });\n        const viewMap = {\n            'dayGridMonth': 'month',\n            'timeGridWeek': 'week',\n            'timeGridDay': 'day',\n            'listWeek': 'list'\n        };\n        const activeBtn = document.querySelector(`.view-btn[data-view=\"${viewMap[viewName]}\"]`);\n        if (activeBtn) {\n            activeBtn.classList.add('active');\n        }\n    }\n}\n\n// Go to today\nfunction goToToday() {\n    if (calendar) {\n        calendar.today();\n        calendar.refetchEvents();\n    }\n}\n\n// Update calendar statistics\nasync function updateCalendarStats() {\n    try {\n        const response = await fetch('/api/calendar/events');\n        if (!response.ok) return;\n        \n        const data = await response.json();\n        if (data.status === 'success' && Array.isArray(data.events)) {\n            const events = data.events;\n            const now = new Date();\n            \n            // Total events\n            const totalEl = document.getElementById('total-events-count');\n            if (totalEl) {\n                animateValue(totalEl, 0, events.length, 500);\n            }\n            \n            // Booking events\n            const bookingCount = events.filter(e => e.extendedProps?.is_booking).length;\n            const bookingEl = document.getElementById('booking-events-count');\n            if (bookingEl) {\n                animateValue(bookingEl, 0, bookingCount, 500);\n            }\n            \n            // Upcoming events (within next 7 days)\n            const upcomingCount = events.filter(e => {\n                const startDate = new Date(e.start);\n                return startDate >= now && startDate <= new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000);\n            }).length;\n            const upcomingEl = document.getElementById('upcoming-events-count');\n            if (upcomingEl) {\n                animateValue(upcomingEl, 0, upcomingCount, 500);\n            }\n        }\n    } catch (error) {\n        console.error('Error updating calendar stats:', error);\n    }\n}\n\n// Animate number counter\nfunction animateValue(element, start, end, duration) {\n    let startTimestamp = null;\n    const step = (timestamp) => {\n        if (!startTimestamp) startTimestamp = timestamp;\n        const progress = Math.min((timestamp - startTimestamp) / duration, 1);\n        const current = Math.floor(progress * (end - start) + start);\n        element.textContent = current;\n        if (progress < 1) {\n            window.requestAnimationFrame(step);\n        } else {\n            element.textContent = end;\n        }\n    };\n    window.requestAnimationFrame(step);\n}\n\nfunction openEventModal() {\n    currentEditingEvent = null;\n    document.getElementById('event-modal-title').textContent = '➕ Create New Event';\n    document.getElementById('event-form').reset();\n    document.getElementById('event-all-day').checked = true;\n    document.getElementById('event-time-fields').style.display = 'none';\n    document.getElementById('event-reminder').checked = false;\n    document.getElementById('reminder-options').style.display = 'none';\n    document.getElementById('event-delete-btn').style.display = 'none';\n    document.getElementById('event-color').value = '#6366f1';\n    document.getElementById('event-color-text').value = '#6366f1';\n    \n    // Set default dates to today\n    const today = new Date().toISOString().split('T')[0];\n    document.getElementById('event-start-date').value = today;\n    document.getElementById('event-end-date').value = today;\n    \n    document.getElementById('event-modal').classList.add('active');\n}\n\nfunction openEventModalForDate(dateStr) {\n    openEventModal();\n    document.getElementById('event-start-date').value = dateStr;\n    document.getElementById('event-end-date').value = dateStr;\n}\n\nfunction openEventModalForEdit(event) {\n    currentEditingEvent = event;\n    const props = event.extendedProps;\n    \n    // Only allow editing of manual events, not bookings\n    if (props.is_booking) {\n        alert('This is a booking event. Please edit it from the \"My Trips\" page.');\n        return;\n    }\n    \n    document.getElementById('event-modal-title').textContent = '✏️ Edit Event';\n    document.getElementById('event-title').value = event.title;\n    document.getElementById('event-description').value = event.extendedProps.description || '';\n    \n    const startDate = event.start;\n    const endDate = event.end || event.start;\n    \n    document.getElementById('event-start-date').value = startDate.toISOString().split('T')[0];\n    document.getElementById('event-end-date').value = endDate.toISOString().split('T')[0];\n    \n    const allDay = event.allDay;\n    document.getElementById('event-all-day').checked = allDay;\n    toggleEventTime();\n    \n    if (!allDay && startDate instanceof Date) {\n        const startTime = startDate.toTimeString().slice(0, 5);\n        const endTime = endDate.toTimeString().slice(0, 5);\n        document.getElementById('event-start-time').value = startTime;\n        document.getElementById('event-end-time').value = endTime;\n    }\n    \n    document.getElementById('event-type').value = props.event_type || 'personal';\n    document.getElementById('event-tags').value = (props.tags || []).join(', ');\n    document.getElementById('event-color').value = event.backgroundColor || '#6366f1';\n    document.getElementById('event-color-text').value = event.backgroundColor || '#6366f1';\n    \n    const reminderEnabled = props.reminder_enabled === true || props.reminder_enabled === 'true';\n    document.getElementById('event-reminder').checked = reminderEnabled;\n    if (reminderEnabled) {\n        document.getElementById('reminder-options').style.display = 'block';\n        document.getElementById('event-reminder-time').value = props.reminder_time || '1 day before';\n    }\n    \n    document.getElementById('event-delete-btn').style.display = 'block';\n    document.getElementById('event-modal').classList.add('active');\n}\n\nfunction toggleEventTime() {\n    const allDay = document.getElementById('event-all-day').checked;\n    const timeFields = document.getElementById('event-time-fields');\n    timeFields.style.display = allDay ? 'none' : 'grid';\n}\n\nfunction updateEventColor() {\n    const eventType = document.getElementById('event-type').value;\n    const colorMap = {\n        'personal': '#6366f1',\n        'trip': '#10b981',\n        'booking': '#3b82f6',\n        'reminder': '#f59e0b'\n    };\n    const color = colorMap[eventType] || '#6366f1';\n    document.getElementById('event-color').value = color;\n    document.getElementById('event-color-text').value = color;\n}\n\nasync function saveEvent(e) {\n    e.preventDefault();\n    \n    const title = document.getElementById('event-title').value;\n    const description = document.getElementById('event-description').value;\n    const startDate = document.getElementById('event-start-date').value;\n    const endDate = document.getElementById('event-end-date').value;\n    const allDay = document.getElementById('event-all-day').checked;\n    const startTime = allDay ? null : document.getElementById('event-start-time').value;\n    const endTime = allDay ? null : document.getElementById('event-end-time').value;\n    const eventType = document.getElementById('event-type').value;\n    const tags = document.getElementById('event-tags').value.split(',').map(t => t.trim()).filter(t => t);\n    const color = document.getElementById('event-color-text').value;\n    const reminderEnabled = document.getElementById('event-reminder').checked;\n    const reminderTime = reminderEnabled ? document.getElementById('event-reminder-time').value : null;\n    \n    // Add loading state to save button\n    const saveBtn = document.querySelector('#event-form button[type=\"submit\"]');\n    if (saveBtn) {\n        saveBtn.disabled = true;\n        saveBtn.innerHTML = '⏳ Saving...';\n    }\n    \n    const eventData = {\n        title: title,\n        description: description,\n        start_date: startDate,\n        end_date: endDate,\n        start_time: startTime,\n        end_time: endTime,\n        all_day: allDay ? \"true\" : \"false\",\n        event_type: eventType,\n        tags: tags,\n        color: color,\n        reminder_enabled: reminderEnabled ? \"true\" : \"false\",\n        reminder_time: reminderTime\n    };\n    \n    try {\n        let response;\n        if (currentEditingEvent && currentEditingEvent.extendedProps.database_id) {\n            // Update existing event\n            response = await fetch(`/api/calendar/events/${currentEditingEvent.extendedProps.database_id}`, {\n                method: 'PUT',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify(eventData)\n            });\n        } else {\n            // Create new event\n            response = await fetch('/api/calendar/events', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify(eventData)\n            });\n        }\n        \n        if (!response.ok) {\n            const errorText = await response.text();\n            console.error('HTTP error saving event:', response.status, errorText);\n            let errorData;\n            try {\n                errorData = JSON.parse(errorText);\n            } catch {\n                errorData = { error: errorText || `HTTP ${response.status} error` };\n            }\n            alert('Error saving event: ' + (errorData.error || errorData.detail || `HTTP ${response.status} error`));\n            return;\n        }\n        \n        const data = await response.json();\n        console.log('Event save response:', data);\n        if (data.status === 'success') {\n            showSuccessMessage('✅ Event saved successfully!');\n            closeEventModal();\n            // Force calendar refresh with animation\n            if (calendar) {\n                setTimeout(() => {\n                    calendar.refetchEvents();\n                    updateCalendarStats();\n                    \n                    // Add a subtle flash animation to the calendar\n                    const calendarWrapper = document.querySelector('.calendar-wrapper');\n                    if (calendarWrapper) {\n                        calendarWrapper.style.animation = 'none';\n                        setTimeout(() => {\n                            calendarWrapper.style.animation = 'messageHighlight 0.8s ease-out';\n                        }, 10);\n                    }\n                }, 100);\n            }\n        } else {\n            const errorMsg = data.error || data.detail || 'Unknown error occurred';\n            console.error('Error saving event:', errorMsg, data);\n            alert('Error saving event: ' + errorMsg);\n        }\n    } catch (error) {\n        console.error('Error saving event:', error);\n        alert('Error saving event: ' + (error.message || 'Network error. Please check your connection.'));\n    } finally {\n        // Restore button state\n        const saveBtn = document.querySelector('#event-form button[type=\"submit\"]');\n        if (saveBtn) {\n            saveBtn.disabled = false;\n            saveBtn.innerHTML = '💾 Save Event';\n        }\n    }\n}\n\nasync function deleteEvent() {\n    if (!currentEditingEvent || !currentEditingEvent.extendedProps.database_id) {\n        alert('Cannot delete this event');\n        return;\n    }\n    \n    if (!confirm('Are you sure you want to delete this event?')) {\n        return;\n    }\n    \n    try {\n        const response = await fetch(`/api/calendar/events/${currentEditingEvent.extendedProps.database_id}`, {\n            method: 'DELETE'\n        });\n        \n        const data = await response.json();\n        if (data.status === 'success') {\n            showSuccessMessage('✅ Event deleted successfully!');\n            closeEventModal();\n            if (calendar) {\n                setTimeout(() => {\n                    calendar.refetchEvents();\n                    updateCalendarStats();\n                }, 100);\n            }\n        } else {\n            const errorMsg = data.error || data.detail || 'Unknown error occurred';\n            console.error('Error deleting event:', errorMsg, data);\n            alert('Error deleting event: ' + errorMsg);\n        }\n    } catch (error) {\n        console.error('Error deleting event:', error);\n        alert('Error deleting event: ' + (error.message || 'Network error. Please check your connection.'));\n    }\n}\n\nasync function updateEventDates(event) {\n    // Only update manual events, not bookings\n    if (event.extendedProps.is_booking || !event.extendedProps.database_id) {\n        calendar.refetchEvents(); // Revert the change\n        return;\n    }\n    \n    const start = event.start;\n    const end = event.end || event.start;\n    \n    const eventData = {\n        title: event.title,\n        description: event.extendedProps.description || '',\n        start_date: start.toISOString().split('T')[0],\n        end_date: end.toISOString().split('T')[0],\n        start_time: event.allDay ? null : start.toTimeString().slice(0, 5),\n        end_time: event.allDay ? null : (end.toTimeString().slice(0, 5)),\n        all_day: event.allDay ? \"true\" : \"false\",\n        event_type: event.extendedProps.event_type || 'personal',\n        tags: event.extendedProps.tags || [],\n        color: event.backgroundColor,\n        reminder_enabled: event.extendedProps.reminder_enabled ? \"true\" : \"false\",\n        reminder_time: event.extendedProps.reminder_time\n    };\n    \n    try {\n        const response = await fetch(`/api/calendar/events/${event.extendedProps.database_id}`, {\n            method: 'PUT',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(eventData)\n        });\n        \n        const data = await response.json();\n        if (data.status !== 'success') {\n            calendar.refetchEvents(); // Revert on error\n        }\n    } catch (error) {\n        console.error('Error updating event:', error);\n        calendar.refetchEvents(); // Revert on error\n    }\n}\n\nfunction closeEventModal() {\n    document.getElementById('event-modal').classList.remove('active');\n    currentEditingEvent = null;\n}\n\n// Moved to main DOMContentLoaded listener below\n\nasync function viewItinerary(id) {\n    try {\n        const response = await fetch(`/api/itineraries/${id}`);\n        const data = await response.json();\n        \n        if (data.status === 'success') {\n            const itin = data.itinerary;\n            const passengers = prompt(`Trip: ${itin.trip_name}\\nDestination: ${itin.destination}\\nDates: ${itin.start_date} to ${itin.end_date}\\nDuration: ${itin.duration_days} days\\nBudget: $${itin.budget || 'N/A'}\\n\\n${itin.description || ''}\\n\\nWould you like to book this trip? Enter number of passengers (1-10):`, '1');\n            \n            if (passengers && !isNaN(passengers) && parseInt(passengers) >= 1 && parseInt(passengers) <= 10) {\n                const bookingResponse = await fetch(`/api/bookings/from-itinerary/${id}?passengers=${parseInt(passengers)}`, {\n                    method: 'POST'\n                });\n                \n                const bookingData = await bookingResponse.json();\n                \n                if (bookingData.status === 'success') {\n                    showSuccessMessage(`✅ Booking created! Booking ID: ${bookingData.booking_id}. Redirecting to payment...`);\n                    setTimeout(() => {\n                        navigateTo('trips');\n                        loadMyTrips();\n                    }, 2000);\n                } else {\n                    alert('Error creating booking: ' + (bookingData.error || 'Unknown error'));\n                }\n            }\n        }\n    } catch (error) {\n        alert('Error loading itinerary: ' + error.message);\n    }\n}\n\nasync function bookFromItinerary(id) {\n    const passengers = prompt('Enter number of passengers (1-10):', '1');\n    \n    if (!passengers || isNaN(passengers) || parseInt(passengers) < 1 || parseInt(passengers) > 10) {\n        alert('Please enter a valid number of passengers between 1 and 10');\n        return;\n    }\n    \n    try {\n        const response = await fetch(`/api/bookings/from-itinerary/${id}?passengers=${parseInt(passengers)}`, {\n            method: 'POST'\n        });\n        \n        const data = await response.json();\n        \n        if (data.status === 'success') {\n            showSuccessMessage(`✅ Booking created! Booking ID: ${data.booking_id}`);\n            navigateTo('trips');\n            setTimeout(() => {\n                loadMyTrips();\n            }, 500);\n        } else {\n            alert('Error creating booking: ' + (data.error || 'Unknown error'));\n        }\n    } catch (error) {\n        alert('Error creating booking: ' + error.message);\n    }\n}\n\nasync function deleteItinerary(id) {\n    if (!confirm('Are you sure you want to delete this itinerary?')) return;\n    \n    try {\n        const response = await fetch(`/api/itineraries/${id}`, {\n            method: 'DELETE'\n        });\n        \n        const data = await response.json();\n        \n        if (data.status === 'success') {\n            showSuccessMessage('✅ Itinerary deleted successfully!');\n            loadCalendar();\n        } else {\n            alert('Error deleting itinerary');\n        }\n    } catch (error) {\n        alert('Error deleting itinerary: ' + error.message);\n    }\n}\n\nasync function loadMyTrips() {\n    const tripsGrid = document.querySelector('#trips-page .trips-grid');\n    \n    if (!tripsGrid) {\n        console.error('Trips grid element not found');\n        return;\n    }\n    \n    tripsGrid.innerHTML = '<div class=\"loading-container\"><div class=\"loading-spinner-large\"></div><p>Loading your trips...</p></div>';\n    \n    try {\n        const response = await fetch('/api/bookings');\n        \n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        \n        const data = await response.json();\n        \n        if (data.status === 'success' && data.bookings && data.bookings.length > 0) {\n            let html = '';\n            \n            data.bookings.forEach(booking => {\n                const statusBadge = booking.status === 'confirmed' \n                    ? '<span class=\"badge badge-success\">✓ Confirmed</span>'\n                    : booking.status === 'cancelled'\n                    ? '<span class=\"badge\" style=\"background: rgba(239, 68, 68, 0.1); color: #ef4444;\">Cancelled</span>'\n                    : '<span class=\"badge badge-primary\">Pending</span>';\n                \n                html += `\n                    <div class=\"trip-card\" onclick=\"handleTripClick('${booking.id}', '${booking.payment_status}')\" style=\"cursor: pointer; transition: all 0.3s ease;\">\n                        <div class=\"trip-image\">✈️</div>\n                        <div class=\"trip-content\">\n                            <h3 class=\"trip-title\">${booking.trip_name}</h3>\n                            <div class=\"trip-meta\">📅 ${booking.start_date} to ${booking.end_date} • 💰 $${(booking.total_price || 0).toFixed(2)} • 👥 ${booking.passengers || 1} passenger(s)</div>\n                            <p class=\"feature-desc\">${booking.destination}</p>\n                            <div style=\"margin-top: 1rem;\">\n                                ${statusBadge}\n                                ${booking.payment_status === 'paid' ? '<span class=\"badge badge-success\">💳 Paid</span>' : '<span class=\"badge badge-warning\">💳 Unpaid</span>'}\n                            </div>\n                            <div style=\"margin-top: 1rem;\">\n                                <small style=\"color: var(--gray);\">Booking ID: ${booking.id}</small>\n                            </div>\n                            <div style=\"margin-top: 0.5rem;\">\n                                <button class=\"btn-small btn-view\" onclick=\"event.stopPropagation(); viewBookingDetailsModal('${booking.id}')\" style=\"margin-right: 0.5rem;\">📋 View Details</button>\n                                ${booking.status !== 'cancelled' && booking.payment_status !== 'paid' ? \n                                    `<button class=\"btn-small btn-primary\" onclick=\"event.stopPropagation(); proceedToPayment('${booking.id}', ${booking.total_price})\">💳 Complete Payment</button>\n                                    <button class=\"btn-small btn-delete\" onclick=\"event.stopPropagation(); cancelBooking('${booking.id}')\" style=\"margin-left: 0.5rem;\">❌ Cancel</button>` : \n                                    ''}\n                            </div>\n                        </div>\n                    </div>\n                `;\n            });\n            \n            html += `\n                <div class=\"trip-card\" style=\"border: 2px dashed var(--primary); background: rgba(99, 102, 241, 0.05);\">\n                    <div class=\"trip-image\" style=\"background: rgba(99, 102, 241, 0.1); color: var(--primary);\">➕</div>\n                    <div class=\"trip-content\" style=\"text-align: center;\">\n                        <h3 class=\"trip-title\" style=\"color: var(--primary);\">Plan New Trip</h3>\n                        <p class=\"feature-desc\" style=\"margin: 1rem 0;\">Ready for your next adventure? Let our AI help you plan the perfect trip!</p>\n                        <button class=\"btn btn-primary\" onclick=\"navigateTo('plan')\">🚀 Start Planning</button>\n                    </div>\n                </div>\n            `;\n            \n            tripsGrid.innerHTML = html;\n        } else {\n            // Show empty state when no bookings\n            tripsGrid.innerHTML = `\n                <div class=\"empty-state\">\n                    <div class=\"empty-icon\">✈️</div>\n                    <h3>No trips booked yet</h3>\n                    <p>Start planning your next adventure and your bookings will appear here!</p>\n                    <button class=\"btn btn-primary\" onclick=\"navigateTo('plan')\">🚀 Plan Your First Trip</button>\n                </div>\n            `;\n        }\n    } catch (error) {\n        console.error('Error loading trips:', error);\n        tripsGrid.innerHTML = `\n            <div class=\"empty-state\">\n                <div class=\"empty-icon\">❌</div>\n                <h3>Error loading trips</h3>\n                <p>${error.message}</p>\n                <button class=\"btn btn-primary\" onclick=\"loadMyTrips()\">🔄 Try Again</button>\n            </div>\n        `;\n    }\n}\n\nfunction checkPaymentStatus() {\n    const urlParams = new URLSearchParams(window.location.search);\n    const paymentStatus = urlParams.get('payment');\n    const bookingId = urlParams.get('booking_id');\n    \n    if (paymentStatus === 'success' && bookingId) {\n        fetch(`/api/bookings/${bookingId}/confirm`, { method: 'POST' })\n            .then(response => {\n                if (!response.ok) {\n                    throw new Error(`HTTP error! status: ${response.status}`);\n                }\n                return response.json();\n            })\n            .then(() => {\n                navigateTo('trips');\n                setTimeout(() => {\n                    showSuccessMessage('🎉 Payment Successful! Your trip is confirmed!');\n                    loadMyTrips();\n                }, 500);\n            })\n            .catch(error => {\n                console.error('Error confirming booking:', error);\n                showSuccessMessage('⚠️ Payment was successful but there was an error confirming your booking. Please contact support.', 'warning');\n            });\n        \n        window.history.replaceState({}, document.title, '/');\n    } else if (paymentStatus === 'cancelled') {\n        showSuccessMessage('❌ Payment was cancelled. You can try again from My Trips.', 'warning');\n        window.history.replaceState({}, document.title, '/');\n    }\n}\n\n// Handle trip card click\nfunction handleTripClick(bookingId, paymentStatus) {\n    if (paymentStatus === 'paid') {\n        // Show full booking details in modal\n        viewBookingDetailsModal(bookingId);\n    } else {\n        // Show booking details and offer to complete payment\n        viewBookingDetailsModal(bookingId);\n    }\n}\n\n// View booking details in a beautiful modal\nasync function viewBookingDetailsModal(bookingId) {\n    try {\n        const response = await fetch(`/api/bookings/${bookingId}`);\n        const data = await response.json();\n        \n        if (data.status === 'success') {\n            const booking = data.booking;\n            \n            const statusBadge = booking.status === 'confirmed' \n                ? '<span class=\"badge badge-success\">✓ Confirmed</span>'\n                : booking.status === 'cancelled'\n                ? '<span class=\"badge\" style=\"background: rgba(239, 68, 68, 0.1); color: #ef4444;\">Cancelled</span>'\n                : '<span class=\"badge badge-primary\">Pending</span>';\n            \n            const paymentBadge = booking.payment_status === 'paid' \n                ? '<span class=\"badge badge-success\">💳 Paid</span>' \n                : '<span class=\"badge badge-warning\">💳 Unpaid</span>';\n            \n            const modalHTML = `\n                <div class=\"modal-backdrop\" onclick=\"closeBookingModal()\">\n                    <div class=\"modal-content booking-details-modal\" onclick=\"event.stopPropagation()\">\n                        <div class=\"modal-header\">\n                            <h2>✈️ ${booking.trip_name}</h2>\n                            <button class=\"close-btn\" onclick=\"closeBookingModal()\">×</button>\n                        </div>\n                        <div class=\"modal-body\">\n                            <div class=\"booking-status-badges\">\n                                ${statusBadge}\n                                ${paymentBadge}\n                            </div>\n                            \n                            <div class=\"booking-detail-section\">\n                                <h3>📍 Trip Information</h3>\n                                <div class=\"detail-row\">\n                                    <span class=\"detail-label\">Destination:</span>\n                                    <span class=\"detail-value\">${booking.destination}</span>\n                                </div>\n                                <div class=\"detail-row\">\n                                    <span class=\"detail-label\">Travel Dates:</span>\n                                    <span class=\"detail-value\">${booking.start_date} to ${booking.end_date}</span>\n                                </div>\n                                <div class=\"detail-row\">\n                                    <span class=\"detail-label\">Passengers:</span>\n                                    <span class=\"detail-value\">${booking.passengers} person(s)</span>\n                                </div>\n                            </div>\n                            \n                            <div class=\"booking-detail-section\">\n                                <h3>💰 Pricing Details</h3>\n                                <div class=\"detail-row\">\n                                    <span class=\"detail-label\">Base Price:</span>\n                                    <span class=\"detail-value\">$${(booking.base_price || 0).toFixed(2)}</span>\n                                </div>\n                                <div class=\"detail-row\">\n                                    <span class=\"detail-label\">Total Amount:</span>\n                                    <span class=\"detail-value\" style=\"font-weight: 700; font-size: 1.2em; color: var(--primary);\">$${(booking.total_price || 0).toFixed(2)}</span>\n                                </div>\n                            </div>\n                            \n                            <div class=\"booking-detail-section\">\n                                <h3>📋 Booking Information</h3>\n                                <div class=\"detail-row\">\n                                    <span class=\"detail-label\">Booking ID:</span>\n                                    <span class=\"detail-value\"><code>${booking.booking_id}</code></span>\n                                </div>\n                                ${booking.email ? `\n                                <div class=\"detail-row\">\n                                    <span class=\"detail-label\">Email:</span>\n                                    <span class=\"detail-value\">${booking.email}</span>\n                                </div>\n                                ` : ''}\n                                <div class=\"detail-row\">\n                                    <span class=\"detail-label\">Created:</span>\n                                    <span class=\"detail-value\">${booking.created_at ? new Date(booking.created_at).toLocaleString() : 'N/A'}</span>\n                                </div>\n                                ${booking.confirmed_at ? `\n                                <div class=\"detail-row\">\n                                    <span class=\"detail-label\">Confirmed:</span>\n                                    <span class=\"detail-value\">${new Date(booking.confirmed_at).toLocaleString()}</span>\n                                </div>\n                                ` : ''}\n                                ${booking.cancelled_at ? `\n                                <div class=\"detail-row\">\n                                    <span class=\"detail-label\">Cancelled:</span>\n                                    <span class=\"detail-value\">${new Date(booking.cancelled_at).toLocaleString()}</span>\n                                </div>\n                                ` : ''}\n                                ${booking.special_requests ? `\n                                <div class=\"detail-row\">\n                                    <span class=\"detail-label\">Special Requests:</span>\n                                    <span class=\"detail-value\">${booking.special_requests}</span>\n                                </div>\n                                ` : ''}\n                            </div>\n                            \n                            <div class=\"modal-actions\">\n                                ${booking.payment_status !== 'paid' && booking.status !== 'cancelled' ? \n                                    `<button class=\"btn btn-primary\" onclick=\"proceedToPayment('${booking.id}', ${booking.total_price})\">💳 Complete Payment</button>` \n                                    : ''}\n                                ${booking.status !== 'cancelled' && booking.payment_status !== 'paid' ? \n                                    `<button class=\"btn btn-secondary\" onclick=\"cancelBooking('${booking.id}'); closeBookingModal();\">❌ Cancel Booking</button>` \n                                    : ''}\n                                <button class=\"btn btn-secondary\" onclick=\"closeBookingModal()\">Close</button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            `;\n            \n            document.body.insertAdjacentHTML('beforeend', modalHTML);\n        }\n    } catch (error) {\n        alert('Error loading booking details: ' + error.message);\n    }\n}\n\nfunction closeBookingModal() {\n    const modal = document.querySelector('.modal-backdrop');\n    if (modal) {\n        modal.remove();\n    }\n}\n\n// Proceed to payment for unpaid bookings\nasync function proceedToPayment(bookingId, totalPrice) {\n    try {\n        const response = await fetch('/api/create-checkout-session', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n                booking_id: bookingId,\n                amount: totalPrice\n            })\n        });\n        \n        const data = await response.json();\n        \n        if (data.url) {\n            window.location.href = data.url;\n        } else {\n            alert('Error creating payment session. Please try again.');\n        }\n    } catch (error) {\n        alert('Error processing payment: ' + error.message);\n    }\n}\n\nasync function viewBookingDetails(bookingId) {\n    // Redirect to the modal version\n    viewBookingDetailsModal(bookingId);\n}\n\nasync function cancelBooking(bookingId) {\n    if (!confirm('Are you sure you want to cancel this booking?')) return;\n    \n    try {\n        const response = await fetch(`/api/bookings/${bookingId}`, {\n            method: 'DELETE'\n        });\n        \n        const data = await response.json();\n        \n        if (data.status === 'success') {\n            showSuccessMessage('✅ Booking cancelled successfully!');\n            loadMyTrips();\n        } else {\n            alert('Error cancelling booking: ' + (data.error || 'Unknown error'));\n        }\n    } catch (error) {\n        alert('Error cancelling booking: ' + error.message);\n    }\n}\n\nfunction showSuccessMessage(message, type = 'success') {\n    const alertClass = type === 'success' ? 'alert-success' : 'alert-warning';\n    const alert = document.createElement('div');\n    alert.className = `alert ${alertClass} success-toast`;\n    alert.style.position = 'fixed';\n    alert.style.top = '100px';\n    alert.style.right = '20px';\n    alert.style.zIndex = '3000';\n    alert.style.minWidth = '300px';\n    alert.innerHTML = message;\n    \n    document.body.appendChild(alert);\n    \n    setTimeout(() => {\n        alert.style.transition = 'opacity 0.3s';\n        alert.style.opacity = '0';\n        setTimeout(() => alert.remove(), 300);\n    }, 5000);\n}\n\n\nasync function openBookingPageFromChat() {\n    try {\n        // First check if we have stored trip details from chat\n        if (window.lastTripDetails) {\n            openBookingWithDetails();\n            return;\n        }\n        \n        // Otherwise try to extract from conversation history\n        const response = await fetch(\"/api/booking-options\", {\n            method: \"POST\",\n            headers: { \"Content-Type\": \"application/json\" },\n            body: JSON.stringify({})\n        });\n        const data = await response.json();\n        if (data.status === \"success\") {\n            bookingTripDetails = data.trip_details;\n            selectedFlight = null;\n            selectedHotel = null;\n            navigateTo(\"booking\");\n            setTimeout(() => loadBookingOptions(data), 300);\n        } else {\n            // Show helpful message\n            const helpMessage = `\n                <div style=\"text-align: center; padding: 2rem;\">\n                    <h3>📋 No Trip Details Found</h3>\n                    <p style=\"color: var(--gray); margin: 1rem 0;\">\n                        To create a booking, please plan a trip first using the AI chat.\n                    </p>\n                    <p style=\"color: var(--gray); margin: 1rem 0;\">\n                        Try saying: <strong>\"I want to book a trip to Paris for 2 people from December 1-7\"</strong>\n                    </p>\n                    <button class=\"btn-inline\" onclick=\"navigateTo('plan')\" style=\"margin-top: 1rem;\">\n                        🚀 Go to Plan Trip\n                    </button>\n                </div>\n            `;\n            \n            // Show as modal or message\n            const modal = document.createElement('div');\n            modal.style.cssText = 'position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); z-index: 10000; max-width: 500px;';\n            modal.innerHTML = helpMessage;\n            \n            const overlay = document.createElement('div');\n            overlay.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 9999;';\n            overlay.onclick = () => { modal.remove(); overlay.remove(); };\n            \n            document.body.appendChild(overlay);\n            document.body.appendChild(modal);\n            \n            setTimeout(() => { modal.remove(); overlay.remove(); }, 5000);\n        }\n    } catch (error) {\n        alert(\"Error: \" + error.message + \"\\n\\nPlease plan a trip in the chat first!\");\n    }\n}\n\nfunction loadBookingOptions(data) {\n    const summaryCard = document.getElementById(\"booking-details-card\");\n    const summaryContent = document.getElementById(\"booking-summary-content\");\n    const summaryText = document.getElementById(\"booking-summary\");\n    if (data.trip_details) {\n        const trip = data.trip_details;\n        summaryContent.innerHTML = `<div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;\"><div><strong>📍 Destination:</strong> ${trip.destination}</div><div><strong>✈️ Origin:</strong> ${trip.origin}</div><div><strong>📅 Dates:</strong> ${trip.start_date} to ${trip.end_date}</div><div><strong>💰 Budget:</strong> $${trip.budget.toFixed(2)}</div><div><strong>👥 Passengers:</strong> ${trip.passengers}</div></div>`;\n        summaryCard.style.display = \"block\";\n        summaryText.textContent = `Select flights and hotel for ${trip.destination}`;\n        \n        // Set default nights and passengers from trip details\n        const numNights = Math.ceil((new Date(trip.end_date) - new Date(trip.start_date)) / (1000 * 60 * 60 * 24));\n        const nightsSelect = document.getElementById(\"nights-select\");\n        const passengersSelect = document.getElementById(\"passengers-select\");\n        if (nightsSelect) nightsSelect.value = numNights || 1;\n        if (passengersSelect) passengersSelect.value = trip.passengers || 1;\n    }\n    \n    // Populate flight dropdown\n    const flightSelect = document.getElementById(\"flight-select\");\n    if (flightSelect && data.flights?.length > 0) {\n        flightSelect.innerHTML = '<option value=\"\">Select Flight</option>' + \n            data.flights.map((flight, index) => \n                `<option value=\"${index}\" data-price=\"${flight.price}\">${flight.airline} ${flight.flight_number} - $${flight.price.toFixed(2)} (${flight.departure_time} - ${flight.arrival_time})</option>`\n            ).join(\"\");\n    }\n    \n    // Populate hotel dropdown\n    const hotelSelect = document.getElementById(\"hotel-select\");\n    if (hotelSelect && data.hotels?.length > 0) {\n        hotelSelect.innerHTML = '<option value=\"\">Select Hotel</option>' + \n            data.hotels.map((hotel, index) => \n                `<option value=\"${index}\" data-price=\"${hotel.price_per_night}\">${hotel.name} - $${hotel.price_per_night.toFixed(2)}/night (${hotel.rating.toFixed(1)}⭐)</option>`\n            ).join(\"\");\n    }\n    \n    // Store flights and hotels data globally for later use\n    window.bookingFlights = data.flights || [];\n    window.bookingHotels = data.hotels || [];\n    \n    const flightsContainer = document.getElementById(\"flights-container\");\n    if (data.flights?.length > 0) {\n        flightsContainer.innerHTML = data.flights.map((flight, index) => `<div class=\"flight-option ${selectedFlight === index ? \"selected\" : \"\"}\" onclick=\"selectFlight(${index}, ${flight.price})\"><div class=\"flight-header\"><div class=\"flight-airline\"><strong>${flight.airline}</strong><span class=\"flight-number\">${flight.flight_number}</span></div><div class=\"flight-price\">$${flight.price.toFixed(2)}</div></div><div class=\"flight-details\"><div class=\"flight-time\"><div><strong>${flight.departure_time}</strong><span class=\"flight-city\">${data.trip_details?.origin || \"Mumbai\"}</span></div><div class=\"flight-duration\">${flight.duration}</div><div><strong>${flight.arrival_time}</strong><span class=\"flight-city\">${data.trip_details?.destination || \"Destination\"}</span></div></div><div class=\"flight-info\"><span class=\"badge badge-primary\">${flight.class}</span><span class=\"badge badge-secondary\">${flight.stops === 0 ? \"Non-stop\" : flight.stops + \" stop(s)\"}</span></div></div></div>`).join(\"\");\n    } else {\n        flightsContainer.innerHTML = \"<p style=\\\"text-align: center; color: var(--gray); padding: 2rem;\\\">No flights available.</p>\";\n    }\n    const hotelsContainer = document.getElementById(\"hotels-container\");\n    if (data.hotels?.length > 0) {\n        const numNights = data.trip_details ? Math.ceil((new Date(data.trip_details.end_date) - new Date(data.trip_details.start_date)) / (1000 * 60 * 60 * 24)) : 1;\n        hotelsContainer.innerHTML = data.hotels.map((hotel, index) => { const totalPrice = hotel.price_per_night * numNights; return `<div class=\"hotel-option ${selectedHotel === index ? \"selected\" : \"\"}\" onclick=\"selectHotel(${index}, ${hotel.price_per_night}, ${numNights})\"><div class=\"hotel-header\"><div><h4 class=\"hotel-name\">${hotel.name}</h4><div class=\"hotel-rating\">${\"⭐\".repeat(Math.floor(hotel.rating))} ${hotel.rating.toFixed(1)} <span class=\"hotel-reviews\">(${hotel.reviews} reviews)</span></div></div><div class=\"hotel-price\"><div class=\"price-per-night\">$${hotel.price_per_night.toFixed(2)}/night</div><div class=\"price-total\">$${totalPrice.toFixed(2)} total</div></div></div><div class=\"hotel-details\"><div class=\"hotel-location\">📍 ${hotel.location}</div><div class=\"hotel-amenities\">${hotel.amenities.map(a => `<span class=\"amenity-badge\">${a}</span>`).join(\"\")}</div><div class=\"hotel-style\"><span class=\"badge badge-${hotel.style === \"luxury\" ? \"primary\" : hotel.style === \"mid-range\" ? \"success\" : \"warning\"}\">${hotel.style}</span></div></div></div>`; }).join(\"\");\n    } else {\n        hotelsContainer.innerHTML = \"<p style=\\\"text-align: center; color: var(--gray); padding: 2rem;\\\">No hotels available.</p>\";\n    }\n    updateTotalPrice();\n}\n\nfunction updateFlightPrice() {\n    const flightSelect = document.getElementById(\"flight-select\");\n    if (flightSelect && flightSelect.value !== \"\") {\n        const index = parseInt(flightSelect.value);\n        const price = parseFloat(flightSelect.options[flightSelect.selectedIndex].dataset.price);\n        selectedFlight = index;\n        document.getElementById(\"flight-price\").textContent = `$${price.toFixed(2)}`;\n        // Update visual selection\n        document.querySelectorAll(\".flight-option\").forEach((f, i) => f.classList.toggle(\"selected\", i === index));\n    } else {\n        selectedFlight = null;\n        document.getElementById(\"flight-price\").textContent = \"$0.00\";\n        document.querySelectorAll(\".flight-option\").forEach(f => f.classList.remove(\"selected\"));\n    }\n    updateTotalPrice();\n}\n\nfunction updateHotelPrice() {\n    const hotelSelect = document.getElementById(\"hotel-select\");\n    if (hotelSelect && hotelSelect.value !== \"\") {\n        const index = parseInt(hotelSelect.value);\n        const price = parseFloat(hotelSelect.options[hotelSelect.selectedIndex].dataset.price);\n        selectedHotel = index;\n        document.getElementById(\"hotel-price\").textContent = `$${price.toFixed(2)}`;\n        // Update visual selection\n        document.querySelectorAll(\".hotel-option\").forEach((h, i) => h.classList.toggle(\"selected\", i === index));\n    } else {\n        selectedHotel = null;\n        document.getElementById(\"hotel-price\").textContent = \"$0.00\";\n        document.querySelectorAll(\".hotel-option\").forEach(h => h.classList.remove(\"selected\"));\n    }\n    updateTotalPrice();\n}\n\nfunction selectFlight(index, price) {\n    selectedFlight = index;\n    document.querySelectorAll(\".flight-option\").forEach((f, i) => f.classList.toggle(\"selected\", i === index));\n    const flightSelect = document.getElementById(\"flight-select\");\n    if (flightSelect) flightSelect.value = index;\n    updateTotalPrice();\n}\n\nfunction selectHotel(index, pricePerNight, nights) {\n    selectedHotel = index;\n    document.querySelectorAll(\".hotel-option\").forEach((h, i) => h.classList.toggle(\"selected\", i === index));\n    const hotelSelect = document.getElementById(\"hotel-select\");\n    if (hotelSelect) hotelSelect.value = index;\n    updateTotalPrice();\n}\nfunction togglePriceSummary() {\n    const footer = document.getElementById(\"price-summary-footer\");\n    if (footer) {\n        footer.classList.toggle(\"expanded\");\n    }\n}\n\nfunction updateTotalPrice() {\n    const flightPriceEl = document.getElementById(\"flight-price\");\n    const hotelPriceEl = document.getElementById(\"hotel-price\");\n    const nightsCountEl = document.getElementById(\"nights-count\");\n    const passengersCountEl = document.getElementById(\"passengers-count\");\n    const totalPriceEl = document.getElementById(\"total-price\");\n    const footerTotalEl = document.getElementById(\"footer-total-price\");\n    const proceedBtn = document.getElementById(\"proceed-booking-btn\");\n    \n    if (!flightPriceEl || !hotelPriceEl || !totalPriceEl) return;\n    \n    let flightPrice = 0, hotelPricePerNight = 0, nights = 1, passengers = 1;\n    \n    // Get flight price from dropdown or selection\n    const flightSelect = document.getElementById(\"flight-select\");\n    if (flightSelect && flightSelect.value !== \"\") {\n        flightPrice = parseFloat(flightSelect.options[flightSelect.selectedIndex].dataset.price || 0);\n    } else if (selectedFlight !== null && window.bookingFlights) {\n        flightPrice = window.bookingFlights[selectedFlight]?.price || 0;\n    }\n    \n    // Get hotel price from dropdown or selection\n    const hotelSelect = document.getElementById(\"hotel-select\");\n    if (hotelSelect && hotelSelect.value !== \"\") {\n        hotelPricePerNight = parseFloat(hotelSelect.options[hotelSelect.selectedIndex].dataset.price || 0);\n    } else if (selectedHotel !== null && window.bookingHotels) {\n        hotelPricePerNight = window.bookingHotels[selectedHotel]?.price_per_night || 0;\n    }\n    \n    // Get nights from dropdown\n    const nightsSelect = document.getElementById(\"nights-select\");\n    if (nightsSelect) {\n        nights = parseInt(nightsSelect.value || 1);\n    } else if (bookingTripDetails) {\n        nights = Math.ceil((new Date(bookingTripDetails.end_date) - new Date(bookingTripDetails.start_date)) / (1000 * 60 * 60 * 24));\n    }\n    \n    // Get passengers from dropdown\n    const passengersSelect = document.getElementById(\"passengers-select\");\n    if (passengersSelect) {\n        passengers = parseInt(passengersSelect.value || 1);\n    } else {\n        const passengerInput = document.getElementById(\"passenger-count\");\n        if (passengerInput) passengers = parseInt(passengerInput.value || 1);\n    }\n    \n    const total = (flightPrice * passengers) + (hotelPricePerNight * nights);\n    \n    flightPriceEl.textContent = `$${flightPrice.toFixed(2)}`;\n    hotelPriceEl.textContent = `$${hotelPricePerNight.toFixed(2)}`;\n    if (nightsCountEl) nightsCountEl.textContent = nights;\n    if (passengersCountEl) passengersCountEl.textContent = passengers;\n    totalPriceEl.innerHTML = `<strong>$${total.toFixed(2)}</strong>`;\n    \n    // Update footer total\n    if (footerTotalEl) {\n        footerTotalEl.textContent = `Total: $${total.toFixed(2)}`;\n    }\n    \n    // Enable proceed button only if both flight and hotel are selected\n    if (proceedBtn) {\n        const hasFlight = (flightSelect && flightSelect.value !== \"\") || selectedFlight !== null;\n        const hasHotel = (hotelSelect && hotelSelect.value !== \"\") || selectedHotel !== null;\n        proceedBtn.disabled = !(hasFlight && hasHotel);\n    }\n}\nasync function proceedToBooking() {\n    if (selectedFlight === null || selectedHotel === null) {\n        alert(\"Please select both flight and hotel.\");\n        return;\n    }\n    \n    const email = document.getElementById(\"passenger-email\")?.value;\n    if (!email || !email.includes('@')) {\n        alert(\"Please enter a valid email address.\");\n        document.getElementById(\"passenger-email\")?.focus();\n        return;\n    }\n    \n    try {\n        const flights = document.querySelectorAll(\".flight-option\");\n        const hotels = document.querySelectorAll(\".hotel-option\");\n        \n        const flightText = flights[selectedFlight].textContent;\n        const flightMatch = flightText.match(/([A-Za-z\\s]+)\\s+([A-Z0-9]+)/);\n        const flightDetails = {\n            airline: flightMatch?.[1].trim() || \"Unknown\",\n            flight_number: flightMatch?.[2] || \"N/A\",\n            price: parseFloat(flightText.match(/\\$([\\d.]+)/)?.[1] || 0)\n        };\n        \n        const hotelName = hotels[selectedHotel].querySelector(\".hotel-name\")?.textContent || \"Unknown\";\n        const hotelPriceMatch = hotels[selectedHotel].textContent.match(/\\$([\\d.]+)\\/night/);\n        const hotelDetails = {\n            name: hotelName,\n            price_per_night: parseFloat(hotelPriceMatch?.[1] || 0)\n        };\n        \n        const passengersSelect = document.getElementById(\"passengers-select\");\n        const passengers = passengersSelect ? parseInt(passengersSelect.value) : parseInt(document.getElementById(\"passenger-count\")?.value || 1);\n        const specialRequests = document.getElementById(\"special-requests\")?.value;\n        \n        const nightsSelect = document.getElementById(\"nights-select\");\n        const nights = nightsSelect ? parseInt(nightsSelect.value) : Math.ceil((new Date(bookingTripDetails.end_date) - new Date(bookingTripDetails.start_date)) / (1000 * 60 * 60 * 24));\n        \n        const totalPrice = (flightDetails.price * passengers) + (hotelDetails.price_per_night * nights);\n        \n        const proceedBtn = document.getElementById(\"proceed-booking-btn\");\n        if (proceedBtn) {\n            proceedBtn.disabled = true;\n            proceedBtn.innerHTML = '<div class=\"loading-spinner-small\" style=\"margin: 0 auto;\"></div> Processing...';\n        }\n        \n        const bookingResponse = await fetch(\"/api/bookings\", {\n            method: \"POST\",\n            headers: { \"Content-Type\": \"application/json\" },\n            body: JSON.stringify({\n                trip_id: `booking-${Date.now()}`,\n                trip_name: `Trip to ${bookingTripDetails.destination}`,\n                destination: bookingTripDetails.destination,\n                start_date: bookingTripDetails.start_date,\n                end_date: bookingTripDetails.end_date,\n                total_price: totalPrice,\n                passengers: passengers,\n                email: email,\n                flight_details: flightDetails,\n                hotel_details: hotelDetails,\n                special_requests: specialRequests || undefined\n            })\n        });\n        \n        const bookingData = await bookingResponse.json();\n        \n        if (bookingData.status === \"success\") {\n            const checkoutResponse = await fetch(\"/api/create-checkout-session\", {\n                method: \"POST\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify({\n                    booking_id: bookingData.booking_id\n                })\n            });\n            \n            const checkoutData = await checkoutResponse.json();\n            \n            if (checkoutData.status === \"success\" && checkoutData.checkout_url) {\n                window.location.href = checkoutData.checkout_url;\n            } else {\n                throw new Error(checkoutData.error || \"Failed to create payment session\");\n            }\n        } else {\n            throw new Error(bookingData.error || \"Failed to create booking\");\n        }\n    } catch (error) {\n        alert(\"Error: \" + error.message);\n        const proceedBtn = document.getElementById(\"proceed-booking-btn\");\n        if (proceedBtn) {\n            proceedBtn.disabled = false;\n            proceedBtn.innerHTML = '💳 Proceed to Payment';\n        }\n    }\n}\n\n// ========== AUTHENTICATION ==========\nasync function handleSignIn(event) {\n    event.preventDefault();\n    \n    const email = document.getElementById('signin-email').value;\n    const password = document.getElementById('signin-password').value;\n    const rememberMe = document.getElementById('remember-me').checked;\n    \n    const submitBtn = event.target.querySelector('.btn-submit');\n    const btnText = submitBtn.querySelector('span');\n    const btnSpinner = submitBtn.querySelector('.btn-spinner');\n    \n    // Show loading state\n    submitBtn.disabled = true;\n    btnText.style.display = 'none';\n    btnSpinner.style.display = 'block';\n    \n    try {\n        const response = await fetch('/api/auth/signin', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ email, password, remember_me: rememberMe })\n        });\n        \n        const data = await response.json();\n        \n        if (data.status === 'success') {\n            // Store user session\n            localStorage.setItem('user', JSON.stringify(data.user));\n            if (rememberMe) {\n                localStorage.setItem('auth_token', data.token);\n            } else {\n                sessionStorage.setItem('auth_token', data.token);\n            }\n            \n            // Load user profile\n            loadUserProfile();\n            \n            // Show success message\n            showSuccessMessage('✅ Welcome back! Redirecting to home...');\n            \n            // Navigate to home\n            setTimeout(() => {\n                navigateTo('home');\n            }, 1000);\n        } else {\n            showErrorToast(data.message || 'Sign in failed. Please check your credentials.');\n        }\n    } catch (error) {\n        console.error('Sign in error:', error);\n        showErrorToast('An error occurred during sign in. Please try again.');\n    } finally {\n        // Reset button state\n        submitBtn.disabled = false;\n        btnText.style.display = 'block';\n        btnSpinner.style.display = 'none';\n    }\n}\n\nasync function handleSignUp(event) {\n    event.preventDefault();\n    \n    const name = document.getElementById('signup-name').value;\n    const email = document.getElementById('signup-email').value;\n    const password = document.getElementById('signup-password').value;\n    const confirmPassword = document.getElementById('signup-confirm-password').value;\n    const termsAgree = document.getElementById('terms-agree').checked;\n    \n    // Validate passwords match\n    if (password !== confirmPassword) {\n        showErrorToast('Passwords do not match!');\n        return;\n    }\n    \n    // Validate password strength\n    if (password.length < 8) {\n        showErrorToast('Password must be at least 8 characters long!');\n        return;\n    }\n    \n    // Validate terms agreement\n    if (!termsAgree) {\n        showWarningToast('Please agree to the Terms of Service and Privacy Policy!');\n        return;\n    }\n    \n    const submitBtn = event.target.querySelector('.btn-submit');\n    const btnText = submitBtn.querySelector('span');\n    const btnSpinner = submitBtn.querySelector('.btn-spinner');\n    \n    // Show loading state\n    submitBtn.disabled = true;\n    btnText.style.display = 'none';\n    btnSpinner.style.display = 'block';\n    \n    try {\n        const response = await fetch('/api/auth/signup', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ name, email, password })\n        });\n        \n        const data = await response.json();\n        \n        if (data.status === 'success') {\n            // Store user session\n            localStorage.setItem('user', JSON.stringify(data.user));\n            sessionStorage.setItem('auth_token', data.token);\n            \n            // Load user profile\n            loadUserProfile();\n            \n            // Show success message\n            showSuccessMessage('✅ Account created successfully! Welcome aboard!');\n            \n            // Navigate to home\n            setTimeout(() => {\n                navigateTo('home');\n            }, 1000);\n        } else {\n            showErrorToast(data.message || 'Sign up failed. Please try again.');\n        }\n    } catch (error) {\n        console.error('Sign up error:', error);\n        showErrorToast('An error occurred during sign up. Please try again.');\n    } finally {\n        // Reset button state\n        submitBtn.disabled = false;\n        btnText.style.display = 'block';\n        btnSpinner.style.display = 'none';\n    }\n}\n\nfunction logout() {\n    localStorage.removeItem('user');\n    localStorage.removeItem('auth_token');\n    sessionStorage.removeItem('auth_token');\n    showInfoToast('You have been signed out successfully');\n    setTimeout(() => {\n        navigateTo('welcome');\n    }, 500);\n}\n\nfunction switchAccount() {\n    localStorage.removeItem('user');\n    localStorage.removeItem('auth_token');\n    sessionStorage.removeItem('auth_token');\n    showInfoToast('Switching account...');\n    setTimeout(() => {\n        navigateTo('signin');\n    }, 500);\n}\n\nfunction showAccountSettings() {\n    const userStr = localStorage.getItem('user');\n    if (!userStr) {\n        showErrorToast('Please sign in to view account settings');\n        return;\n    }\n    \n    const user = JSON.parse(userStr);\n    \n    showInfoToast('Account Settings:\\n• Name: ' + user.name + '\\n• Email: ' + user.email);\n}\n\nfunction showMyBookings() {\n    navigateTo('calendar');\n    setTimeout(() => {\n        showInfoToast('Viewing your bookings in Calendar');\n    }, 500);\n}\n\n// ========== PROFILE MENU ==========\nfunction toggleProfileMenu(event) {\n    event.stopPropagation();\n    const dropdown = document.getElementById('profile-dropdown');\n    const isOpen = dropdown.classList.contains('show');\n    \n    // Clear any pending hide timeout\n    if (profileDropdownHideTimeout) {\n        clearTimeout(profileDropdownHideTimeout);\n        profileDropdownHideTimeout = null;\n    }\n    \n    if (!isOpen) {\n        // Opening the dropdown\n        dropdown.style.display = 'block';\n        // Trigger animation\n        requestAnimationFrame(() => {\n            dropdown.classList.add('show');\n        });\n        // Add click listener to close when clicking outside\n        setTimeout(() => {\n            document.addEventListener('click', closeProfileMenuOnClickOutside);\n        }, 0);\n    } else {\n        // Closing the dropdown\n        dropdown.classList.remove('show');\n        // Wait for animation before hiding\n        profileDropdownHideTimeout = setTimeout(() => {\n            dropdown.style.display = 'none';\n            profileDropdownHideTimeout = null;\n        }, 300);\n        document.removeEventListener('click', closeProfileMenuOnClickOutside);\n    }\n}\n\nfunction closeProfileMenuOnClickOutside(event) {\n    const dropdown = document.getElementById('profile-dropdown');\n    const profileContainer = document.querySelector('.profile-menu-container');\n    \n    if (!profileContainer.contains(event.target)) {\n        // Clear any pending hide timeout\n        if (profileDropdownHideTimeout) {\n            clearTimeout(profileDropdownHideTimeout);\n            profileDropdownHideTimeout = null;\n        }\n        \n        dropdown.classList.remove('show');\n        profileDropdownHideTimeout = setTimeout(() => {\n            dropdown.style.display = 'none';\n            profileDropdownHideTimeout = null;\n        }, 300);\n        document.removeEventListener('click', closeProfileMenuOnClickOutside);\n    }\n}\n\nfunction loadUserProfile() {\n    const userStr = localStorage.getItem('user');\n    if (userStr) {\n        try {\n            const user = JSON.parse(userStr);\n            \n            // Update profile name and email\n            const profileName = document.getElementById('profile-name');\n            const profileEmail = document.getElementById('profile-email');\n            \n            if (profileName) profileName.textContent = user.name || 'User Name';\n            if (profileEmail) profileEmail.textContent = user.email || 'user@example.com';\n            \n            // Update initials in avatar\n            const initials = getInitials(user.name || 'User');\n            const profileInitials = document.getElementById('profile-initials');\n            const profileInitialsLarge = document.getElementById('profile-initials-large');\n            \n            if (profileInitials) profileInitials.textContent = initials;\n            if (profileInitialsLarge) profileInitialsLarge.textContent = initials;\n        } catch (error) {\n            console.error('Error loading user profile:', error);\n        }\n    }\n}\n\nfunction getInitials(name) {\n    if (!name) return 'U';\n    const parts = name.trim().split(' ');\n    if (parts.length >= 2) {\n        return (parts[0][0] + parts[parts.length - 1][0]).toUpperCase();\n    }\n    return name.substring(0, 2).toUpperCase();\n}\n\n// ========== FEATURE EXPLANATIONS ==========\nfunction showFeatureExplanation(feature) {\n    const tooltip = document.getElementById('feature-tooltip');\n    const title = document.getElementById('tooltip-title');\n    const description = document.getElementById('tooltip-description');\n    \n    const features = {\n        'ai': {\n            title: '🤖 AI-Powered Planning',\n            description: 'Our advanced AI assistant analyzes your preferences, budget, and travel dates to create personalized itineraries. Simply chat with our AI and it will search flights, hotels, activities, and create a complete day-by-day travel plan tailored just for you.'\n        },\n        'booking': {\n            title: '✈️ Smart Booking',\n            description: 'Seamlessly book your entire trip with secure Stripe payment integration. Choose from AI-recommended flights and hotels, or manually select your preferences. Track all your bookings in one place with real-time status updates and payment management.'\n        },\n        'budget': {\n            title: '💰 Budget Optimization',\n            description: 'Get the best value for your money with intelligent budget analysis. Our AI compares flight and hotel prices, suggests cost-effective alternatives, and provides detailed breakdowns of all expenses to help you stay within budget without compromising on quality.'\n        }\n    };\n    \n    const featureData = features[feature];\n    title.textContent = featureData.title;\n    description.textContent = featureData.description;\n    \n    tooltip.classList.add('active');\n}\n\nfunction hideFeatureExplanation() {\n    const tooltip = document.getElementById('feature-tooltip');\n    tooltip.classList.remove('active');\n}\n\nfunction checkAuth() {\n    const user = localStorage.getItem('user');\n    const token = localStorage.getItem('auth_token') || sessionStorage.getItem('auth_token');\n    return user && token;\n}\n\n// ========== CUSTOM CURSOR ==========\nfunction initCustomCursor() {\n    // Create cursor elements\n    const cursor = document.createElement('div');\n    cursor.className = 'custom-cursor';\n    document.body.appendChild(cursor);\n    \n    const cursorDot = document.createElement('div');\n    cursorDot.className = 'custom-cursor-dot';\n    document.body.appendChild(cursorDot);\n    \n    let mouseX = 0, mouseY = 0;\n    let cursorX = 0, cursorY = 0;\n    let dotX = 0, dotY = 0;\n    \n    // Track mouse movement\n    document.addEventListener('mousemove', (e) => {\n        mouseX = e.clientX;\n        mouseY = e.clientY;\n        \n        // Show cursors on first movement\n        cursor.classList.add('active');\n        cursorDot.classList.add('active');\n        \n        // Instant dot positioning\n        dotX = mouseX - 3;\n        dotY = mouseY - 3;\n    });\n    \n    // Smooth cursor animation\n    function animateCursor() {\n        // Smooth follow effect for outer circle\n        cursorX += (mouseX - cursorX - 10) * 0.15;\n        cursorY += (mouseY - cursorY - 10) * 0.15;\n        \n        cursor.style.left = cursorX + 'px';\n        cursor.style.top = cursorY + 'px';\n        cursorDot.style.left = dotX + 'px';\n        cursorDot.style.top = dotY + 'px';\n        \n        requestAnimationFrame(animateCursor);\n    }\n    animateCursor();\n    \n    // Click effect\n    document.addEventListener('mousedown', () => {\n        cursor.classList.add('clicked');\n        cursorDot.classList.add('clicked');\n    });\n    \n    document.addEventListener('mouseup', () => {\n        cursor.classList.remove('clicked');\n        cursorDot.classList.remove('clicked');\n    });\n    \n    // Hover effect for interactive elements\n    const interactiveElements = 'a, button, input, textarea, select, .btn, .card, .feature-card, .nav-link, .message-option, .flight-option, .hotel-option';\n    \n    document.addEventListener('mouseover', (e) => {\n        if (e.target.matches(interactiveElements) || e.target.closest(interactiveElements)) {\n            cursor.classList.add('hovering');\n            cursorDot.classList.add('hovering');\n        }\n    });\n    \n    document.addEventListener('mouseout', (e) => {\n        if (e.target.matches(interactiveElements) || e.target.closest(interactiveElements)) {\n            cursor.classList.remove('hovering');\n            cursorDot.classList.remove('hovering');\n        }\n    });\n    \n    // Hide cursor when leaving window\n    document.addEventListener('mouseleave', () => {\n        cursor.classList.remove('active');\n        cursorDot.classList.remove('active');\n    });\n    \n    document.addEventListener('mouseenter', () => {\n        cursor.classList.add('active');\n        cursorDot.classList.add('active');\n    });\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    // Initialize theme FIRST before any visual elements\n    initTheme();\n    \n    // Initialize custom cursor\n    initCustomCursor();\n    \n    // Initialize reminder checkbox\n    const reminderCheckbox = document.getElementById('event-reminder');\n    if (reminderCheckbox) {\n        reminderCheckbox.addEventListener('change', function() {\n            document.getElementById('reminder-options').style.display = this.checked ? 'block' : 'none';\n        });\n    }\n    \n    // Sync color picker with text input\n    const colorPicker = document.getElementById('event-color');\n    const colorText = document.getElementById('event-color-text');\n    if (colorPicker && colorText) {\n        colorPicker.addEventListener('input', function() {\n            colorText.value = this.value;\n        });\n        colorText.addEventListener('input', function() {\n            if (/^#[0-9A-F]{6}$/i.test(this.value)) {\n                colorPicker.value = this.value;\n            }\n        });\n    }\n    \n    // Initialize price summary footer - hidden by default\n    const footer = document.getElementById(\"price-summary-footer\");\n    if (footer) {\n        footer.style.display = \"none\";\n    }\n    \n    // Check authentication and navigate accordingly\n    if (checkAuth()) {\n        navigateTo('home');\n        loadUserProfile(); // Load user profile info\n    } else {\n        navigateTo('welcome');\n    }\n    \n    checkPaymentStatus();\n    \n    const chatInput = document.getElementById('chat-input');\n    if (chatInput) {\n        chatInput.addEventListener('keypress', (e) => {\n            if (e.key === 'Enter' && !e.shiftKey) {\n                e.preventDefault();\n                sendMessage();\n            }\n        });\n    }\n    \n    // Add welcome message with animation\n    setTimeout(() => {\n        if (checkAuth()) {\n            addMessage('assistant', \n                '👋 Hello! I\\'m your AI travel planning assistant. I can help you plan complete trips, find flights & hotels, create itineraries, manage budgets, and remember your preferences. I can also create bookings for you! Just tell me where you\\'d like to go or say \"I want to book a trip\" to get started! 🚀'\n            );\n        }\n    }, 500);\n    \n    // Add parallax effect on scroll\n    let lastScroll = 0;\n    window.addEventListener('scroll', () => {\n        const currentScroll = window.pageYOffset;\n        const hero = document.querySelector('.hero');\n        if (hero) {\n            hero.style.transform = `translateY(${currentScroll * 0.5}px)`;\n        }\n        lastScroll = currentScroll;\n    });\n});\n","size_bytes":115369},"agent/travel_agent.py":{"content":"import os\nimport json\nimport requests\nfrom typing import List, Dict, Any, Optional\nfrom datetime import datetime, timedelta\nfrom langchain_groq import ChatGroq\nfrom langchain_core.tools import tool\nfrom langchain_core.prompts import ChatPromptTemplate, MessagesPlaceholder\nfrom langchain_community.chat_message_histories import ChatMessageHistory\nfrom langchain_core.messages import AIMessage, HumanMessage, SystemMessage\nfrom langgraph.prebuilt import create_react_agent\n\n# Using Groq API with llama-3.3-70b-versatile model for fast travel planning\n\n# Global user preferences storage (in production would use a database)\nuser_preferences_store = {}\n\n@tool\ndef search_flights(origin: str, destination: str, date: str, max_budget: float = 1000.0) -> str:\n    \"\"\"\n    Search for available flights between two cities.\n    \n    Args:\n        origin: Departure city\n        destination: Arrival city\n        date: Travel date in YYYY-MM-DD format\n        max_budget: Maximum budget per person for the flight\n        \n    Returns:\n        JSON string with flight options including prices, times, airlines\n    \"\"\"\n    flights = [\n        {\n            \"airline\": \"Air India\",\n            \"flight_number\": \"AI202\",\n            \"departure_time\": \"08:00\",\n            \"arrival_time\": \"10:30\",\n            \"duration\": \"2h 30m\",\n            \"price\": min(max_budget * 0.6, 450),\n            \"stops\": 0,\n            \"class\": \"Economy\"\n        },\n        {\n            \"airline\": \"IndiGo\",\n            \"flight_number\": \"6E345\",\n            \"departure_time\": \"14:00\",\n            \"arrival_time\": \"16:45\",\n            \"duration\": \"2h 45m\",\n            \"price\": min(max_budget * 0.4, 350),\n            \"stops\": 0,\n            \"class\": \"Economy\"\n        },\n        {\n            \"airline\": \"SpiceJet\",\n            \"flight_number\": \"SG890\",\n            \"departure_time\": \"18:30\",\n            \"arrival_time\": \"21:15\",\n            \"duration\": \"2h 45m\",\n            \"price\": min(max_budget * 0.35, 320),\n            \"stops\": 0,\n            \"class\": \"Economy\"\n        }\n    ]\n    \n    result = {\n        \"origin\": origin,\n        \"destination\": destination,\n        \"date\": date,\n        \"flights_found\": len(flights),\n        \"flights\": flights\n    }\n    \n    return json.dumps(result, indent=2)\n\n@tool\ndef search_hotels(city: str, check_in: str, check_out: str, max_price_per_night: float = 150.0, accommodation_style: str = \"any\") -> str:\n    \"\"\"\n    Search for hotels in a destination city.\n    \n    Args:\n        city: Destination city\n        check_in: Check-in date in YYYY-MM-DD format\n        check_out: Check-out date in YYYY-MM-DD format\n        max_price_per_night: Maximum budget per night\n        accommodation_style: Preference like 'luxury', 'budget-friendly', 'mid-range', or 'any'\n        \n    Returns:\n        JSON string with hotel options including prices, ratings, amenities\n    \"\"\"\n    all_hotels = [\n        {\n            \"name\": \"Beach Paradise Resort\",\n            \"rating\": 4.5,\n            \"price_per_night\": min(max_price_per_night * 0.8, 120),\n            \"location\": \"Beachfront\",\n            \"amenities\": [\"Pool\", \"WiFi\", \"Breakfast\", \"Spa\", \"Beach Access\"],\n            \"reviews\": 1250,\n            \"style\": \"luxury\"\n        },\n        {\n            \"name\": \"Cozy Inn & Suites\",\n            \"rating\": 4.2,\n            \"price_per_night\": min(max_price_per_night * 0.5, 80),\n            \"location\": \"City Center\",\n            \"amenities\": [\"WiFi\", \"Breakfast\", \"Parking\", \"Gym\"],\n            \"reviews\": 890,\n            \"style\": \"mid-range\"\n        },\n        {\n            \"name\": \"Budget Stay Hotel\",\n            \"rating\": 3.8,\n            \"price_per_night\": min(max_price_per_night * 0.3, 50),\n            \"location\": \"Near Beach\",\n            \"amenities\": [\"WiFi\", \"AC\", \"24/7 Reception\"],\n            \"reviews\": 456,\n            \"style\": \"budget-friendly\"\n        }\n    ]\n    \n    # Filter by style preference\n    if accommodation_style != \"any\":\n        filtered_hotels = [h for h in all_hotels if h[\"style\"] == accommodation_style]\n        if filtered_hotels:\n            all_hotels = filtered_hotels\n    \n    result = {\n        \"city\": city,\n        \"check_in\": check_in,\n        \"check_out\": check_out,\n        \"hotels_found\": len(all_hotels),\n        \"hotels\": all_hotels\n    }\n    \n    return json.dumps(result, indent=2)\n\n@tool\ndef get_weather_forecast(city: str, date: str) -> str:\n    \"\"\"\n    Get weather forecast for a destination.\n    \n    Args:\n        city: Destination city\n        date: Date for weather forecast in YYYY-MM-DD format\n        \n    Returns:\n        JSON string with weather information\n    \"\"\"\n    # Simulate different weather based on month\n    try:\n        # Parse date in YYYY-MM-DD format\n        date_parts = date.split(\"-\")\n        if len(date_parts) < 2:\n            # Fallback: try to extract month from date string\n            month = 6  # Default to monsoon/fall season\n        else:\n            month = int(date_parts[1])\n    except (ValueError, IndexError):\n        # If date parsing fails, default to monsoon/fall season\n        month = 6\n    \n    if month in [12, 1, 2]:  # Winter\n        weather = {\n            \"city\": city,\n            \"date\": date,\n            \"temperature_high\": \"25°C\",\n            \"temperature_low\": \"18°C\",\n            \"condition\": \"Sunny and pleasant\",\n            \"humidity\": \"55%\",\n            \"precipitation_chance\": \"5%\",\n            \"recommendation\": \"Perfect weather for outdoor activities! Light jacket for evenings.\"\n        }\n    elif month in [3, 4, 5]:  # Summer\n        weather = {\n            \"city\": city,\n            \"date\": date,\n            \"temperature_high\": \"32°C\",\n            \"temperature_low\": \"26°C\",\n            \"condition\": \"Hot and sunny\",\n            \"humidity\": \"70%\",\n            \"precipitation_chance\": \"15%\",\n            \"recommendation\": \"Hot weather - stay hydrated and use sunscreen. Beach time recommended!\"\n        }\n    else:  # Monsoon/Fall\n        weather = {\n            \"city\": city,\n            \"date\": date,\n            \"temperature_high\": \"28°C\",\n            \"temperature_low\": \"22°C\",\n            \"condition\": \"Partly cloudy with occasional showers\",\n            \"humidity\": \"80%\",\n            \"precipitation_chance\": \"60%\",\n            \"recommendation\": \"Pack an umbrella and rain jacket. Great for indoor activities.\"\n        }\n    \n    return json.dumps(weather, indent=2)\n\n@tool\ndef search_activities(city: str, categories: Optional[List[str]] = None) -> str:\n    \"\"\"\n    Search for activities and attractions in a destination.\n    \n    Args:\n        city: Destination city\n        categories: List of interest categories like ['adventure', 'culture', 'food', 'beach', 'nightlife']\n        \n    Returns:\n        JSON string with activity options\n    \"\"\"\n    all_activities = [\n        {\n            \"name\": \"Scuba Diving Adventure\",\n            \"category\": \"adventure\",\n            \"duration\": \"3 hours\",\n            \"price\": 75,\n            \"rating\": 4.7,\n            \"description\": \"Explore vibrant coral reefs and marine life with expert instructors\"\n        },\n        {\n            \"name\": \"Beach Sunset Cruise\",\n            \"category\": \"beach\",\n            \"duration\": \"2 hours\",\n            \"price\": 50,\n            \"rating\": 4.6,\n            \"description\": \"Romantic sunset cruise along the coast with dinner included\"\n        },\n        {\n            \"name\": \"Local Food & Spice Tour\",\n            \"category\": \"food\",\n            \"duration\": \"4 hours\",\n            \"price\": 40,\n            \"rating\": 4.8,\n            \"description\": \"Taste authentic local cuisine and visit spice plantations\"\n        },\n        {\n            \"name\": \"Historical Fort & Museum Visit\",\n            \"category\": \"culture\",\n            \"duration\": \"3 hours\",\n            \"price\": 15,\n            \"rating\": 4.4,\n            \"description\": \"Explore centuries-old Portuguese architecture and local history\"\n        },\n        {\n            \"name\": \"Parasailing Experience\",\n            \"category\": \"adventure\",\n            \"duration\": \"1 hour\",\n            \"price\": 60,\n            \"rating\": 4.9,\n            \"description\": \"Soar 300 feet above the beach with breathtaking aerial views\"\n        },\n        {\n            \"name\": \"Yoga & Meditation Retreat\",\n            \"category\": \"wellness\",\n            \"duration\": \"2 hours\",\n            \"price\": 30,\n            \"rating\": 4.5,\n            \"description\": \"Beachside morning yoga and meditation session\"\n        },\n        {\n            \"name\": \"Night Market & Street Food\",\n            \"category\": \"nightlife\",\n            \"duration\": \"3 hours\",\n            \"price\": 25,\n            \"rating\": 4.7,\n            \"description\": \"Explore bustling night markets and taste local street food\"\n        }\n    ]\n    \n    # Filter by categories if specified\n    if categories:\n        filtered = [a for a in all_activities if a[\"category\"] in categories]\n        if filtered:\n            all_activities = filtered\n    \n    result = {\n        \"city\": city,\n        \"activities_found\": len(all_activities),\n        \"activities\": all_activities\n    }\n    \n    return json.dumps(result, indent=2)\n\n@tool\ndef calculate_trip_budget(flight_cost: float, hotel_cost_per_night: float, num_nights: int, \n                         activity_costs: List[float], daily_meal_budget: float = 30.0) -> str:\n    \"\"\"\n    Calculate total trip budget breakdown.\n    \n    Args:\n        flight_cost: Cost of round-trip flights\n        hotel_cost_per_night: Hotel cost per night\n        num_nights: Number of nights staying\n        activity_costs: List of activity costs to include\n        daily_meal_budget: Estimated daily budget for meals\n        \n    Returns:\n        JSON string with detailed budget breakdown\n    \"\"\"\n    hotel_total = hotel_cost_per_night * num_nights\n    meals_total = daily_meal_budget * num_nights\n    activities_total = sum(activity_costs)\n    transportation_total = 50  # Local transportation estimate\n    \n    total = flight_cost + hotel_total + meals_total + activities_total + transportation_total\n    \n    breakdown = {\n        \"flights\": {\n            \"amount\": flight_cost,\n            \"percentage\": round((flight_cost / total * 100), 1)\n        },\n        \"accommodation\": {\n            \"amount\": hotel_total,\n            \"nights\": num_nights,\n            \"per_night\": hotel_cost_per_night,\n            \"percentage\": round((hotel_total / total * 100), 1)\n        },\n        \"meals\": {\n            \"amount\": meals_total,\n            \"per_day\": daily_meal_budget,\n            \"percentage\": round((meals_total / total * 100), 1)\n        },\n        \"activities\": {\n            \"amount\": activities_total,\n            \"count\": len(activity_costs),\n            \"percentage\": round((activities_total / total * 100), 1)\n        },\n        \"local_transportation\": {\n            \"amount\": transportation_total,\n            \"percentage\": round((transportation_total / total * 100), 1)\n        },\n        \"total_cost\": total,\n        \"currency\": \"USD\"\n    }\n    \n    return json.dumps(breakdown, indent=2)\n\n@tool\ndef save_user_preferences(preferences: Dict[str, Any]) -> str:\n    \"\"\"\n    Save user travel preferences for future reference.\n    \n    Args:\n        preferences: Dictionary of preferences like {'accommodation_style': 'luxury', 'dietary': 'vegetarian', 'interests': ['culture', 'food']}\n        \n    Returns:\n        Confirmation message\n    \"\"\"\n    global user_preferences_store\n    user_preferences_store.update(preferences)\n    \n    return json.dumps({\n        \"status\": \"success\",\n        \"message\": f\"Saved {len(preferences)} preferences\",\n        \"current_preferences\": user_preferences_store\n    }, indent=2)\n\n@tool\ndef get_user_preferences() -> str:\n    \"\"\"\n    Retrieve all saved user preferences.\n    \n    Returns:\n        JSON string with all saved preferences\n    \"\"\"\n    global user_preferences_store\n    \n    if not user_preferences_store:\n        return json.dumps({\n            \"status\": \"empty\",\n            \"message\": \"No preferences saved yet\",\n            \"preferences\": {}\n        }, indent=2)\n    \n    return json.dumps({\n        \"status\": \"success\",\n        \"preferences\": user_preferences_store\n    }, indent=2)\n\n@tool\ndef create_booking(destination: str, trip_name: str, start_date: str, end_date: str, \n                  passengers: int, base_price: float = 200.0) -> str:\n    \"\"\"\n    Create a booking for a trip. This will save the booking and allow the user to proceed to payment.\n    \n    Args:\n        destination: Destination city/country\n        trip_name: Name of the trip\n        start_date: Start date in YYYY-MM-DD format\n        end_date: End date in YYYY-MM-DD format\n        passengers: Number of passengers (1-10)\n        base_price: Base price per person (default 200.0)\n        \n    Returns:\n        JSON string with booking confirmation and booking ID\n    \"\"\"\n    # Calculate total price\n    total_price = base_price * passengers\n    \n    # Generate a trip_id\n    trip_id = f\"ai-booking-{destination.lower().replace(' ', '-')}\"\n    \n    booking_data = {\n        \"trip_id\": trip_id,\n        \"trip_name\": trip_name,\n        \"destination\": destination,\n        \"start_date\": start_date,\n        \"end_date\": end_date,\n        \"total_price\": total_price,\n        \"passengers\": passengers,\n        \"flight_details\": {},\n        \"hotel_details\": {}\n    }\n    \n    try:\n        # Get the base URL from environment or use localhost\n        base_url = os.environ.get('BASE_URL', 'http://localhost:5000')\n        response = requests.post(\n            f\"{base_url}/api/bookings\",\n            json=booking_data,\n            timeout=5\n        )\n        \n        if response.status_code == 200:\n            result = response.json()\n            return json.dumps({\n                \"status\": \"success\",\n                \"message\": f\"Booking created successfully! Booking ID: {result.get('booking_id', 'N/A')}\",\n                \"booking_id\": result.get('booking_id'),\n                \"booking\": result.get('booking'),\n                \"next_step\": \"The user can now proceed to payment from the 'My Trips' page.\"\n            }, indent=2)\n        else:\n            return json.dumps({\n                \"status\": \"error\",\n                \"message\": f\"Failed to create booking: {response.text}\"\n            }, indent=2)\n    except Exception as e:\n        # If API call fails, return booking info for manual creation\n        return json.dumps({\n            \"status\": \"info\",\n            \"message\": f\"Booking details prepared: {trip_name} to {destination} for {passengers} passenger(s) from {start_date} to {end_date}. Total: ${total_price:.2f}\",\n            \"booking_data\": booking_data,\n            \"note\": \"Please visit the 'My Trips' page to complete the booking.\"\n        }, indent=2)\n\n@tool\ndef create_day_by_day_itinerary(destination: str, num_days: int, activities: List[str], \n                                hotel_name: str, special_interests: Optional[List[str]] = None) -> str:\n    \"\"\"\n    Create a detailed day-by-day travel itinerary.\n    \n    Args:\n        destination: Destination city\n        num_days: Number of days for the trip\n        activities: List of activity names to include\n        hotel_name: Name of the hotel\n        special_interests: Optional list of special interests to emphasize\n        \n    Returns:\n        JSON string with detailed daily itinerary\n    \"\"\"\n    itinerary = {\n        \"destination\": destination,\n        \"duration_days\": num_days,\n        \"hotel\": hotel_name,\n        \"days\": []\n    }\n    \n    for day in range(1, num_days + 1):\n        if day == 1:\n            day_plan = {\n                \"day\": day,\n                \"theme\": \"Arrival & Settling In\",\n                \"morning\": f\"Arrive at {destination}, hotel check-in at {hotel_name}\",\n                \"afternoon\": \"Light exploration of nearby area, beach/pool relaxation\",\n                \"evening\": \"Welcome dinner at hotel restaurant or nearby recommended spot\",\n                \"tips\": \"Rest and adjust to the new environment\"\n            }\n        elif day == num_days:\n            day_plan = {\n                \"day\": day,\n                \"theme\": \"Departure Day\",\n                \"morning\": \"Final breakfast, last-minute shopping or beach time\",\n                \"afternoon\": \"Hotel checkout, departure\",\n                \"evening\": \"Travel home\",\n                \"tips\": \"Pack souvenirs carefully, confirm flight times\"\n            }\n        else:\n            # Assign activities to middle days\n            activity_idx = (day - 2) % len(activities) if activities else 0\n            activity_name = activities[activity_idx] if activities else \"Local exploration\"\n            \n            day_plan = {\n                \"day\": day,\n                \"theme\": f\"Adventure Day - {activity_name}\",\n                \"morning\": f\"Scheduled activity: {activity_name}\",\n                \"afternoon\": \"Lunch at local restaurant, free time for beach or pool\",\n                \"evening\": \"Explore local markets, dinner at recommended restaurant\",\n                \"tips\": \"Stay hydrated, bring sunscreen and camera\"\n            }\n        \n        itinerary[\"days\"].append(day_plan)\n    \n    return json.dumps(itinerary, indent=2)\n\n\nclass TravelPlannerAgent:\n    \"\"\"Autonomous AI agent for travel planning with LangChain agent executor.\"\"\"\n    \n    def __init__(self):\n        # Use GROQ_API_KEY environment variable\n        self.llm = ChatGroq(\n            model=\"llama-3.3-70b-versatile\",\n            temperature=0.7\n        )\n        \n        # Chat history for conversation memory\n        self.chat_history = ChatMessageHistory()\n        \n        # System message for the agent\n        self.system_message = \"\"\"You are an autonomous AI travel planning agent with access to powerful tools.\n\nYour Mission:\n- Understand user travel requests through natural language\n- Autonomously use available tools to gather comprehensive information\n- Make intelligent recommendations based on preferences, budget, and context\n- Remember and apply user preferences across conversations\n- Create complete, well-reasoned travel plans\n\nAvailable Tools:\n- search_flights: Find flight options with prices and schedules\n- search_hotels: Discover hotels matching preferences and budget\n- get_weather_forecast: Check weather for travel dates\n- search_activities: Find attractions and activities\n- calculate_trip_budget: Compute detailed cost breakdowns\n- save_user_preferences: Store preferences for future trips\n- get_user_preferences: Retrieve saved preferences\n- create_day_by_day_itinerary: Generate detailed daily plans\n- create_booking: Create a booking for a planned trip (use when user wants to book)\n\nAgent Behavior:\n1. **Always start by checking saved preferences** using get_user_preferences\n2. **Extract key information** from user request (destination, budget, dates, interests)\n3. **Use tools autonomously** to gather flights, hotels, weather, activities\n4. **Make smart decisions** - select best options considering budget and preferences\n5. **Calculate budgets** to ensure plans fit constraints\n6. **Create itineraries** with day-by-day details\n7. **Save new preferences** when user mentions them\n8. **Be proactive** - if user mentions they \"love adventure\", save it and suggest adventure activities\n9. **Offer booking** - When user expresses interest in booking or says \"book this\", use create_booking tool\n10. **Extract booking details** - From the conversation, extract destination, dates, passengers, and price for booking\n\nResponse Format:\n- Use clear headings and sections\n- Present options with details (prices, ratings, times)\n- Explain your reasoning\n- Provide alternatives\n- Be enthusiastic and helpful!\n\nRemember: You have autonomy to use multiple tools in sequence to build complete travel plans!\"\"\"\n        \n        # Create tools list\n        self.tools = [\n            search_flights,\n            search_hotels,\n            get_weather_forecast,\n            search_activities,\n            calculate_trip_budget,\n            save_user_preferences,\n            get_user_preferences,\n            create_day_by_day_itinerary,\n            create_booking\n        ]\n        \n        # Create the agent\n        self.agent_executor = self._create_agent_executor()\n    \n    def _create_agent_executor(self):\n        \"\"\"Create the LangGraph agent with tools.\"\"\"\n        # Create the agent using LangGraph's create_react_agent\n        # Note: create_react_agent doesn't accept a prompt parameter\n        # System message will be included in messages when invoking\n        agent_executor = create_react_agent(\n            self.llm,\n            self.tools\n        )\n        \n        return agent_executor\n    \n    def plan_trip(self, user_request: str) -> Dict[str, Any]:\n        \"\"\"Process user travel request using the autonomous agent.\"\"\"\n        try:\n            # Prepare chat history for the agent\n            chat_history_messages = list(self.chat_history.messages)\n            \n            # Check if system message is already in history\n            has_system_message = any(isinstance(msg, SystemMessage) for msg in chat_history_messages)\n            \n            # Include system message at the beginning if not already in history\n            messages = []\n            if not has_system_message:\n                messages.append(SystemMessage(content=self.system_message))\n            messages.extend(chat_history_messages)\n            messages.append(HumanMessage(content=user_request))\n            \n            # Invoke the agent with LangGraph\n            result = self.agent_executor.invoke({\n                \"messages\": messages\n            })\n            \n            # Extract the final response - get the last AI message\n            final_message = None\n            for msg in reversed(result[\"messages\"]):\n                if isinstance(msg, AIMessage):\n                    final_message = msg\n                    break\n            \n            if not final_message:\n                # Fallback to last message\n                final_message = result[\"messages\"][-1]\n            \n            # Handle different response formats\n            if hasattr(final_message, 'content'):\n                content = final_message.content\n                # If content is a list (Gemini format), extract text from it\n                if isinstance(content, list):\n                    response_text = \"\"\n                    for item in content:\n                        if isinstance(item, dict) and 'text' in item:\n                            response_text += item['text']\n                        elif isinstance(item, str):\n                            response_text += item\n                else:\n                    response_text = str(content) if content else \"I'm processing your request...\"\n            else:\n                response_text = str(final_message) if final_message else \"I'm processing your request...\"\n            \n            # Clean up response text\n            if not response_text or response_text.strip() == \"\":\n                response_text = \"I've processed your request. How can I help you further?\"\n            \n            # Add to chat history\n            self.chat_history.add_user_message(user_request)\n            self.chat_history.add_ai_message(response_text)\n            \n            return {\n                \"status\": \"success\",\n                \"request\": user_request,\n                \"response\": response_text\n            }\n            \n        except Exception as e:\n            error_msg = f\"I encountered an error while planning: {str(e)}\\n\\nPlease try rephrasing your request or provide more details.\"\n            return {\n                \"status\": \"error\",\n                \"request\": user_request,\n                \"error\": str(e),\n                \"response\": error_msg\n            }\n    \n    def reset_memory(self):\n        \"\"\"Clear conversation history.\"\"\"\n        self.chat_history.clear()\n    \n    def get_conversation_history(self) -> List[Dict[str, str]]:\n        \"\"\"Get formatted conversation history.\"\"\"\n        messages = []\n        for msg in self.chat_history.messages:\n            messages.append({\n                \"role\": \"assistant\" if isinstance(msg, AIMessage) else \"user\",\n                \"content\": msg.content\n            })\n        return messages\n","size_bytes":24286},"README.md":{"content":"# Travel Planner AI Agent\n\n## Overview\n\nAn autonomous AI-powered travel planning application that uses natural language processing to create complete travel itineraries. The system leverages LangGraph's reactive agent framework to orchestrate multiple specialized tools, enabling multi-step reasoning and intelligent decision-making. Users interact through a conversational web interface where they can request travel plans in natural language, and the AI agent autonomously researches flights, hotels, activities, weather, and budgets to generate comprehensive itineraries.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Application Architecture\n**Pattern**: Monolithic backend with static frontend\n- **Backend**: FastAPI server exposing REST API endpoints\n- **Frontend**: Vanilla JavaScript single-page application (no framework)\n- **Deployment**: Self-contained Python application with embedded static file serving\n\n**Rationale**: Simplifies deployment and reduces complexity. FastAPI provides async capabilities and automatic API documentation. Vanilla JS keeps the frontend lightweight and eliminates build tooling requirements.\n\n### AI Agent Architecture\n**Framework**: LangGraph with ReAct (Reasoning + Acting) pattern\n- **Agent Type**: `create_react_agent` - autonomous multi-step planning agent\n- **LLM Provider**: Google Gemini AI (gemini-2.5-flash or gemini-2.5-pro models)\n- **Tool Orchestration**: LLM decides which tools to invoke and in what sequence\n- **Memory Management**: ChatMessageHistory maintains conversation context across interactions\n\n**Rationale**: LangGraph's ReAct agent enables true autonomous behavior where the LLM reasons about which actions to take. This allows the agent to chain multiple tools (e.g., search flights → check weather → find hotels → calculate budget) without hardcoded workflows. Google Gemini provides cost-effective, high-quality language understanding.\n\n### Tool System\n**Pattern**: Decorator-based tool registry with typed inputs\n- **Implementation**: LangChain `@tool` decorators for function-to-tool conversion\n- **Tool Count**: 8 specialized tools covering different travel planning domains\n- **Type Safety**: Pydantic validation for tool parameters\n\n**Tools**:\n1. `search_flights` - Flight search with pricing\n2. `search_hotels` - Accommodation discovery\n3. `get_weather_forecast` - Weather data retrieval\n4. `search_activities` - Local attractions/experiences\n5. `calculate_trip_budget` - Cost estimation\n6. `save_user_preferences` - Preference persistence\n7. `get_user_preferences` - Preference retrieval\n8. `create_day_by_day_itinerary` - Daily schedule generation\n\n**Rationale**: Modular tool design allows the agent to compose complex plans from simple building blocks. Each tool has a single responsibility, making them easier to test and maintain. The decorator pattern provides automatic schema generation for the LLM.\n\n### State Management\n**Pattern**: Hybrid - in-memory for conversations, global store for preferences\n- **Conversation Memory**: ChatMessageHistory (per-session, ephemeral)\n- **User Preferences**: Python dictionary (global, in-memory)\n- **No Database**: Current implementation uses in-process storage\n\n**Rationale**: For prototyping and demos, in-memory storage eliminates database setup complexity. Conversation history only needs to persist during active sessions. User preferences are stored globally to enable cross-session personalization.\n\n**Production Consideration**: The global `user_preferences_store` dictionary would need migration to persistent storage (database, Redis, etc.) for production deployments to handle multiple users and server restarts.\n\n### API Design\n**Pattern**: RESTful JSON API with single planning endpoint\n- **Endpoint**: `POST /api/plan` - accepts natural language queries\n- **Request Format**: JSON with `query` field\n- **Response Format**: Structured JSON with status, response, request echo, and error fields\n\n**Rationale**: Simple API surface reduces integration complexity. Single endpoint handles all travel planning queries since the agent's autonomous nature allows it to interpret diverse intents from natural language.\n\n### Frontend Architecture\n**Pattern**: Static file serving with client-side rendering\n- **No Build Process**: Direct HTML/CSS/JS files served via FastAPI StaticFiles\n- **Real-time Updates**: Fetch API for async backend communication\n- **Responsive Design**: CSS-based responsive layout without frameworks\n\n**Rationale**: Zero build complexity speeds development iteration. Modern browsers handle vanilla JS efficiently. Gradient-based UI design provides visual appeal without heavy CSS frameworks.\n\n## External Dependencies\n\n### AI/ML Services\n- **Google Gemini AI**: Primary LLM provider via `langchain_google_genai`\n  - Models: gemini-2.5-flash or gemini-2.5-pro\n  - Requires: `GEMINI_API_KEY` environment variable (passed as `google_api_key` parameter)\n  - Purpose: Natural language understanding, reasoning, tool selection\n  - Migration Note (Nov 2025): Migrated from OpenAI to Google Gemini for cost-effective AI credits\n\n### Python Frameworks\n- **FastAPI**: Web framework for REST API\n  - Provides async request handling and automatic OpenAPI documentation\n  \n- **Uvicorn**: ASGI server for running FastAPI application\n  - Production-ready async server\n\n- **LangGraph**: Agent orchestration framework\n  - Enables reactive agent pattern with multi-step reasoning\n  \n- **LangChain**: LLM application framework\n  - Provides tool abstraction, prompt templates, message history\n  - Components: `langchain_core`, `langchain_community`\n\n- **Pydantic**: Data validation and settings management\n  - Validates API request/response models\n  - Provides type safety for tool parameters\n\n### Data Storage\n**Current**: In-memory Python dictionaries\n- No external database configured\n- `user_preferences_store`: global dictionary for user preferences\n- `ChatMessageHistory`: per-session conversation storage\n\n**Future Consideration**: System is designed to swap in persistent storage (PostgreSQL, MongoDB, Redis) by replacing the global dictionary with database calls in the preference save/get tools.\n\n### Static Assets\n- **No CDN dependencies**: All CSS/JS is inline or self-hosted\n- **No frontend framework**: Pure HTML5/CSS3/JavaScript\n- **No external fonts or libraries**: Self-contained design\n\n## Installation & Setup\n\n### Prerequisites\n- Python 3.11 or higher\n- pip (Python package manager)\n- (Optional) Docker and Docker Compose for containerized deployment\n\n### Quick Start\n\n1. **Clone the repository**\n   ```bash\n   git clone <repository-url>\n   cd AI\n   ```\n\n2. **Install dependencies**\n   ```bash\n   # Using pip\n   pip install -r requirements.txt\n   \n   # Or use the build script\n   chmod +x build.sh\n   ./build.sh\n   \n   # Or use Make\n   make install\n   ```\n\n3. **Configure environment variables**\n   ```bash\n   cp .env.example .env\n   # Edit .env and add your API keys:\n   # - GROQ_API_KEY (required for AI features)\n   # - STRIPE_SECRET_KEY (required for payments)\n   # - DATABASE_URL (optional, defaults to SQLite)\n   ```\n\n4. **Run the application**\n   ```bash\n   python3 main.py\n   \n   # Or use Make\n   make run\n   ```\n\n5. **Access the application**\n   - Open your browser to `http://localhost:5000`\n   - API documentation available at `http://localhost:5000/docs`\n\n### Docker Deployment\n\n1. **Build and run with Docker Compose**\n   ```bash\n   docker-compose up --build\n   ```\n   \n   This will start:\n   - Web application on port 5000\n   - PostgreSQL database on port 5432\n\n2. **Or build Docker image manually**\n   ```bash\n   docker build -t travel-planner-ai .\n   docker run -p 5000:5000 --env-file .env travel-planner-ai\n   ```\n\n### Environment Variables\n\nCreate a `.env` file in the project root with the following variables:\n\n```env\n# Database (optional - defaults to SQLite)\nDATABASE_URL=postgresql://user:password@localhost:5432/traveldb\n\n# AI Agent (required for AI features)\nGROQ_API_KEY=your_groq_api_key_here\n\n# Stripe (required for payments)\nSTRIPE_SECRET_KEY=your_stripe_secret_key_here\nSTRIPE_PUBLISHABLE_KEY=your_stripe_publishable_key_here\n```\n\n## Build Commands\n\n### Using Make\n```bash\nmake install      # Install dependencies\nmake run          # Run the application\nmake build        # Build the application\nmake docker-build # Build Docker image\nmake docker-up    # Start Docker containers\nmake docker-down  # Stop Docker containers\nmake clean        # Clean build artifacts\n```\n\n### Using Build Script\n```bash\n./build.sh        # Automated build and setup\n```\n\n## Features\n\n### ✅ Implemented\n- 🤖 AI-powered travel planning with natural language queries\n- ✈️ Flight and hotel search simulation\n- 🌤️ Weather forecasting\n- 🎯 Activity recommendations\n- 💰 Budget calculation\n- 📅 Itinerary creation and calendar management\n- 💳 Complete booking system with Stripe integration\n- 🗄️ Database persistence for bookings and itineraries\n- 📋 User preference management\n- 🔒 Secure payment processing\n\n### 🚀 Production Ready\n- Database-backed storage (SQLite/PostgreSQL)\n- Docker containerization\n- Health check endpoints\n- Error handling and validation\n- Server-side price validation\n- Secure payment processing\n\n## API Endpoints\n\n- `GET /` - Main web interface\n- `POST /api/plan` - AI travel planning\n- `GET /api/bookings` - List all bookings\n- `POST /api/bookings` - Create new booking\n- `GET /api/bookings/{id}` - Get booking details\n- `POST /api/create-checkout-session` - Create Stripe payment session\n- `GET /api/itineraries` - List all itineraries\n- `POST /api/itineraries` - Save itinerary\n- `GET /health` - Health check\n\nFull API documentation available at `/docs` when server is running.\n\n## Development\n\n### Project Structure\n```\n.\n├── main.py              # FastAPI application\n├── database.py          # Database models and setup\n├── agent/\n│   └── travel_agent.py  # AI agent implementation\n├── static/\n│   ├── index.html       # Frontend HTML\n│   ├── app.js           # Frontend JavaScript\n│   └── styles.css       # Frontend styles\n├── requirements.txt     # Python dependencies\n├── Dockerfile           # Docker configuration\n├── docker-compose.yml   # Docker Compose setup\n└── .env.example         # Environment variables template\n```\n\n## License\n\nThis project is part of a hackathon submission.","size_bytes":10464},"build.sh":{"content":"#!/bin/bash\n\n# Build script for Travel Planner AI Agent\n\nset -e\n\necho \"🚀 Building Travel Planner AI Agent...\"\n\n# Check if Python is installed\nif ! command -v python3 &> /dev/null; then\n    echo \"❌ Python 3 is not installed. Please install Python 3.11 or higher.\"\n    exit 1\nfi\n\n# Check Python version\nPYTHON_VERSION=$(python3 --version | cut -d' ' -f2 | cut -d'.' -f1,2)\nREQUIRED_VERSION=\"3.11\"\n\nif [ \"$(printf '%s\\n' \"$REQUIRED_VERSION\" \"$PYTHON_VERSION\" | sort -V | head -n1)\" != \"$REQUIRED_VERSION\" ]; then\n    echo \"❌ Python 3.11 or higher is required. Current version: $PYTHON_VERSION\"\n    exit 1\nfi\n\n# Create virtual environment if it doesn't exist\nif [ ! -d \"venv\" ]; then\n    echo \"📦 Creating virtual environment...\"\n    python3 -m venv venv\nfi\n\n# Activate virtual environment\necho \"🔌 Activating virtual environment...\"\nsource venv/bin/activate\n\n# Upgrade pip\necho \"⬆️  Upgrading pip...\"\npip install --upgrade pip\n\n# Install dependencies\necho \"📥 Installing dependencies...\"\npip install -r requirements.txt\n\n# Create data directory\nmkdir -p data\n\n# Check for .env file\nif [ ! -f \".env\" ]; then\n    echo \"⚠️  Warning: .env file not found. Creating from .env.example...\"\n    if [ -f \".env.example\" ]; then\n        cp .env.example .env\n        echo \"✅ Created .env file. Please update it with your API keys.\"\n    else\n        echo \"⚠️  .env.example not found. Please create .env file manually.\"\n    fi\nfi\n\necho \"✅ Build complete!\"\necho \"\"\necho \"To run the application:\"\necho \"  source venv/bin/activate\"\necho \"  python3 main.py\"\necho \"\"\necho \"Or use Docker:\"\necho \"  docker-compose up --build\"\n\n","size_bytes":1631},"database.py":{"content":"import os\nfrom sqlalchemy import create_engine, Column, Integer, String, Float, DateTime, Text, JSON\nfrom sqlalchemy.ext.declarative import declarative_base\nfrom sqlalchemy.orm import sessionmaker\nfrom datetime import datetime\n\nDATABASE_URL = os.environ.get(\"DATABASE_URL\")\n\nif not DATABASE_URL:\n    DATABASE_URL = \"sqlite:///./travel_planner.db\"\n\n# Set connect_args based on database type\nconnect_args = {}\nif DATABASE_URL and DATABASE_URL.startswith(\"sqlite\"):\n    connect_args = {\"check_same_thread\": False}\n\nengine = create_engine(\n    DATABASE_URL,\n    pool_pre_ping=True,\n    pool_recycle=300,\n    connect_args=connect_args\n)\n\nSessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)\nBase = declarative_base()\n\nclass User(Base):\n    __tablename__ = \"users\"\n    \n    id = Column(Integer, primary_key=True, index=True)\n    name = Column(String, nullable=False)\n    email = Column(String, unique=True, index=True, nullable=False)\n    password_hash = Column(String, nullable=False)\n    created_at = Column(DateTime, default=datetime.utcnow)\n    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)\n\nclass Session(Base):\n    __tablename__ = \"sessions\"\n    \n    id = Column(Integer, primary_key=True, index=True)\n    token = Column(String, unique=True, index=True, nullable=False)\n    user_id = Column(Integer, nullable=False)\n    email = Column(String, nullable=False)\n    created_at = Column(DateTime, default=datetime.utcnow)\n    expires_at = Column(DateTime)\n\nclass Itinerary(Base):\n    __tablename__ = \"itineraries\"\n    \n    id = Column(Integer, primary_key=True, index=True)\n    user_id = Column(String, default=\"default_user\", index=True)\n    trip_name = Column(String, nullable=False)\n    destination = Column(String, nullable=False)\n    start_date = Column(String, nullable=False)\n    end_date = Column(String, nullable=False)\n    duration_days = Column(Integer)\n    budget = Column(Float)\n    description = Column(Text)\n    itinerary_data = Column(JSON)\n    created_at = Column(DateTime, default=datetime.utcnow)\n    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)\n\nclass Booking(Base):\n    __tablename__ = \"bookings\"\n    \n    id = Column(Integer, primary_key=True, index=True)\n    booking_id = Column(String, unique=True, index=True, nullable=False)\n    user_id = Column(String, default=\"default_user\", index=True)\n    trip_id = Column(String, nullable=False)\n    trip_name = Column(String, nullable=False)\n    destination = Column(String, nullable=False)\n    start_date = Column(String, nullable=False)\n    end_date = Column(String, nullable=False)\n    base_price = Column(Float, nullable=False)\n    total_price = Column(Float, nullable=False)\n    passengers = Column(Integer, nullable=False)\n    email = Column(String)\n    flight_details = Column(JSON)\n    hotel_details = Column(JSON)\n    special_requests = Column(Text)\n    status = Column(String, default=\"pending\", index=True)  # pending, confirmed, cancelled, completed\n    payment_status = Column(String, default=\"unpaid\", index=True)  # unpaid, paid, refunded\n    stripe_session_id = Column(String)\n    created_at = Column(DateTime, default=datetime.utcnow)\n    confirmed_at = Column(DateTime)\n    cancelled_at = Column(DateTime)\n    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)\n\nclass CalendarEvent(Base):\n    __tablename__ = \"calendar_events\"\n    \n    id = Column(Integer, primary_key=True, index=True)\n    user_id = Column(String, default=\"default_user\", index=True)\n    title = Column(String, nullable=False)\n    description = Column(Text)\n    start_date = Column(String, nullable=False)\n    end_date = Column(String, nullable=False)\n    start_time = Column(String)  # Optional time in HH:MM format\n    end_time = Column(String)  # Optional time in HH:MM format\n    all_day = Column(String, default=\"true\")  # \"true\" or \"false\" as string\n    event_type = Column(String, default=\"personal\")  # personal, trip, booking, reminder\n    tags = Column(JSON)  # Array of tag strings\n    color = Column(String, default=\"#6366f1\")  # Hex color code\n    booking_id = Column(String)  # Link to booking if applicable\n    reminder_enabled = Column(String, default=\"false\")  # \"true\" or \"false\"\n    reminder_time = Column(String)  # e.g., \"1 day before\", \"1 hour before\"\n    created_at = Column(DateTime, default=datetime.utcnow)\n    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)\n\ndef init_db():\n    Base.metadata.create_all(bind=engine)\n\ndef get_db():\n    db = SessionLocal()\n    try:\n        yield db\n    finally:\n        db.close()\n","size_bytes":4645},"static/calendar-dynamic.css":{"content":"/* Dynamic Google Calendar-Style UI */\n\n/* Calendar Page Header */\n.calendar-page-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-start;\n    margin-bottom: 2rem;\n    padding: 2rem;\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.15) 0%, rgba(236, 72, 153, 0.15) 50%, rgba(168, 85, 247, 0.15) 100%);\n    border-radius: 24px;\n    border: 2px solid transparent;\n    background-clip: padding-box;\n    position: relative;\n    overflow: hidden;\n    animation: fadeInDown 0.5s ease-out;\n    box-shadow: 0 8px 32px rgba(99, 102, 241, 0.2), 0 0 0 1px rgba(99, 102, 241, 0.1);\n}\n\n.calendar-page-header::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);\n    opacity: 0.1;\n    z-index: -1;\n    animation: gradientFloat 8s ease-in-out infinite;\n}\n\n@keyframes gradientFloat {\n    0%, 100% { transform: translateY(0) scale(1); opacity: 0.1; }\n    50% { transform: translateY(-10px) scale(1.05); opacity: 0.15; }\n}\n\n.calendar-header-left {\n    flex: 1;\n}\n\n.calendar-main-title {\n    font-size: 3rem;\n    font-weight: 900;\n    margin: 0 0 0.5rem 0;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #ec4899 75%, #667eea 100%);\n    background-size: 200% auto;\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n    animation: gradientShift 4s linear infinite;\n    letter-spacing: -0.02em;\n    text-shadow: 0 4px 20px rgba(99, 102, 241, 0.3);\n    filter: drop-shadow(0 0 30px rgba(99, 102, 241, 0.4));\n}\n\n@keyframes gradientShift {\n    0% { background-position: 0% 50%; }\n    100% { background-position: 200% 50%; }\n}\n\n.calendar-subtitle {\n    font-size: 1.1rem;\n    color: var(--gray);\n    margin: 0;\n    font-weight: 500;\n}\n\n.calendar-header-actions {\n    display: flex;\n    gap: 1rem;\n    align-items: center;\n}\n\n.calendar-action-btn {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.75rem 1.5rem;\n    border: none;\n    border-radius: 12px;\n    font-weight: 600;\n    font-size: 1rem;\n    cursor: pointer;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.calendar-today-btn {\n    background: white;\n    color: var(--primary);\n    border: 2px solid var(--primary);\n}\n\n.calendar-today-btn:hover {\n    background: var(--primary);\n    color: white;\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);\n}\n\n.calendar-add-btn {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    position: relative;\n    overflow: hidden;\n}\n\n.calendar-add-btn::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);\n    transition: left 0.5s;\n}\n\n.calendar-add-btn:hover::before {\n    left: 100%;\n}\n\n.calendar-add-btn:hover {\n    transform: translateY(-3px) scale(1.05);\n    box-shadow: 0 8px 24px rgba(99, 102, 241, 0.5), 0 0 40px rgba(99, 102, 241, 0.3);\n}\n\n.calendar-add-btn:active {\n    transform: translateY(-1px) scale(1.02);\n}\n\n/* View Selector - Enhanced */\n.calendar-view-selector {\n    display: flex;\n    gap: 0.5rem;\n    margin-bottom: 1.5rem;\n    background: rgba(255, 255, 255, 0.9);\n    backdrop-filter: blur(10px);\n    padding: 0.6rem;\n    border-radius: 16px;\n    box-shadow: \n        0 4px 16px rgba(99, 102, 241, 0.12),\n        inset 0 1px 1px rgba(255, 255, 255, 0.8);\n    animation: fadeInUp 0.5s ease-out 0.1s both;\n    border: 1px solid rgba(99, 102, 241, 0.1);\n}\n\n.view-btn {\n    flex: 1;\n    padding: 0.75rem 1.5rem;\n    border: none;\n    background: transparent;\n    border-radius: 8px;\n    font-weight: 600;\n    font-size: 0.95rem;\n    color: var(--gray);\n    cursor: pointer;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    position: relative;\n    overflow: hidden;\n}\n\n.view-btn::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.1), transparent);\n    transition: left 0.5s;\n}\n\n.view-btn:hover::before {\n    left: 100%;\n}\n\n.view-btn:hover {\n    color: var(--primary);\n    background: rgba(99, 102, 241, 0.05);\n}\n\n.view-btn.active {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    box-shadow: \n        0 4px 12px rgba(99, 102, 241, 0.4),\n        0 0 20px rgba(99, 102, 241, 0.2),\n        inset 0 1px 1px rgba(255, 255, 255, 0.2);\n    transform: scale(1.05);\n}\n\n/* Calendar Wrapper - Glassmorphism */\n.calendar-wrapper {\n    background: rgba(255, 255, 255, 0.85);\n    backdrop-filter: blur(20px);\n    -webkit-backdrop-filter: blur(20px);\n    border-radius: 24px;\n    padding: 2.5rem;\n    box-shadow: \n        0 8px 32px rgba(99, 102, 241, 0.15),\n        0 0 0 1px rgba(255, 255, 255, 0.18),\n        inset 0 1px 1px rgba(255, 255, 255, 0.9);\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n    animation: fadeInUp 0.5s ease-out 0.2s both;\n    position: relative;\n    overflow: hidden;\n    border: 1px solid rgba(99, 102, 241, 0.1);\n}\n\n.calendar-wrapper::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 5px;\n    background: linear-gradient(90deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #ec4899 75%, #667eea 100%);\n    background-size: 200% auto;\n    animation: slideInLeft 0.6s ease-out 0.3s forwards, gradientShift 3s linear infinite;\n    border-radius: 24px 24px 0 0;\n}\n\n.calendar-wrapper:hover {\n    transform: translateY(-4px);\n    box-shadow: \n        0 12px 48px rgba(99, 102, 241, 0.25),\n        0 0 0 1px rgba(255, 255, 255, 0.2),\n        inset 0 1px 1px rgba(255, 255, 255, 1);\n}\n\n.calendar-container {\n    position: relative;\n    min-height: 600px;\n}\n\n/* Stats Cards */\n.calendar-stats {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 1.5rem;\n    margin-top: 2rem;\n    animation: fadeInUp 0.5s ease-out 0.4s both;\n}\n\n.stat-card {\n    display: flex;\n    align-items: center;\n    gap: 1.5rem;\n    padding: 2rem;\n    background: rgba(255, 255, 255, 0.9);\n    backdrop-filter: blur(10px);\n    border-radius: 20px;\n    box-shadow: \n        0 4px 20px rgba(99, 102, 241, 0.1),\n        inset 0 1px 1px rgba(255, 255, 255, 0.8);\n    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);\n    border: 2px solid rgba(99, 102, 241, 0.1);\n    position: relative;\n    overflow: hidden;\n}\n\n.stat-card::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 5px;\n    height: 100%;\n    background: linear-gradient(180deg, #667eea 0%, #764ba2 50%, #f093fb 100%);\n    transform: scaleY(0);\n    transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);\n}\n\n.stat-card::after {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 0;\n    height: 0;\n    border-radius: 50%;\n    background: radial-gradient(circle, rgba(99, 102, 241, 0.1) 0%, transparent 70%);\n    transform: translate(-50%, -50%);\n    transition: width 0.6s, height 0.6s;\n}\n\n.stat-card:hover {\n    transform: translateY(-6px) scale(1.02);\n    box-shadow: \n        0 12px 32px rgba(99, 102, 241, 0.2),\n        0 0 40px rgba(99, 102, 241, 0.15),\n        inset 0 1px 1px rgba(255, 255, 255, 1);\n    border-color: rgba(99, 102, 241, 0.3);\n}\n\n.stat-card:hover::before {\n    transform: scaleY(1);\n}\n\n.stat-card:hover::after {\n    width: 300px;\n    height: 300px;\n}\n\n.stat-icon {\n    font-size: 2.8rem;\n    width: 70px;\n    height: 70px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.15) 0%, rgba(168, 85, 247, 0.15) 50%, rgba(236, 72, 153, 0.15) 100%);\n    border-radius: 16px;\n    box-shadow: \n        0 4px 16px rgba(99, 102, 241, 0.15),\n        inset 0 1px 1px rgba(255, 255, 255, 0.5);\n    position: relative;\n    overflow: hidden;\n}\n\n.stat-info {\n    flex: 1;\n}\n\n.stat-value {\n    font-size: 2.5rem;\n    font-weight: 900;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n    line-height: 1;\n    margin-bottom: 0.25rem;\n    filter: drop-shadow(0 2px 4px rgba(99, 102, 241, 0.2));\n}\n\n.stat-label {\n    font-size: 0.9rem;\n    color: var(--gray);\n    font-weight: 500;\n}\n\n/* Enhanced FullCalendar Styles */\n.fc-header-toolbar {\n    margin-bottom: 1.5rem;\n    padding: 1rem 0;\n    border-bottom: 2px solid rgba(99, 102, 241, 0.1);\n    animation: fadeIn 0.6s ease-out;\n}\n\n.fc-toolbar-title {\n    font-size: 1.75rem !important;\n    font-weight: 700 !important;\n    color: var(--dark) !important;\n    text-transform: capitalize;\n}\n\n.fc-button-group {\n    display: flex;\n    gap: 0.5rem;\n}\n\n.fc-button {\n    padding: 0.6rem 1.2rem !important;\n    border-radius: 10px !important;\n    font-weight: 600 !important;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;\n    box-shadow: 0 2px 8px rgba(99, 102, 241, 0.2) !important;\n}\n\n.fc-button:hover {\n    transform: translateY(-2px) !important;\n    box-shadow: 0 4px 16px rgba(99, 102, 241, 0.4) !important;\n}\n\n.fc-daygrid-day {\n    transition: all 0.2s ease;\n    position: relative;\n}\n\n.fc-daygrid-day:hover {\n    background: rgba(99, 102, 241, 0.05) !important;\n    transform: scale(1.02);\n    z-index: 1;\n}\n\n.fc-day-today {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.15) 0%, rgba(236, 72, 153, 0.1) 100%) !important;\n    border: 2px solid var(--primary) !important;\n    box-shadow: inset 0 0 15px rgba(99, 102, 241, 0.1);\n    animation: pulseToday 2s ease-in-out infinite;\n}\n\n.fc-day-today .fc-daygrid-day-number {\n    background: var(--primary) !important;\n    color: white !important;\n    border-radius: 50% !important;\n    width: 2.5rem !important;\n    height: 2.5rem !important;\n    display: flex !important;\n    align-items: center !important;\n    justify-content: center !important;\n    font-weight: 700 !important;\n    box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3);\n}\n\n.fc-event {\n    border-radius: 8px !important;\n    padding: 6px 10px !important;\n    border: 2px solid rgba(255, 255, 255, 0.3) !important;\n    font-weight: 600 !important;\n    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2) !important;\n    margin: 3px 2px !important;\n    backdrop-filter: blur(4px);\n    position: relative;\n    overflow: hidden;\n    animation: eventSlideIn 0.3s ease-out;\n}\n\n.fc-event::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 4px;\n    height: 100%;\n    background: rgba(255, 255, 255, 0.6);\n    animation: shimmer 2s infinite;\n}\n\n.fc-event:hover {\n    transform: translateY(-3px) scale(1.03) !important;\n    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3) !important;\n    z-index: 10 !important;\n    border-color: rgba(255, 255, 255, 0.7) !important;\n}\n\n/* Dark Mode */\n[data-theme=\"dark\"] .calendar-page-header {\n    background: rgba(99, 102, 241, 0.15);\n    border-color: rgba(99, 102, 241, 0.3);\n}\n\n[data-theme=\"dark\"] .calendar-view-selector {\n    background: #1e293b;\n}\n\n[data-theme=\"dark\"] .calendar-wrapper {\n    background: #1e293b;\n    border: 1px solid #334155;\n}\n\n[data-theme=\"dark\"] .stat-card {\n    background: #1e293b;\n    border-color: #334155;\n}\n\n[data-theme=\"dark\"] .stat-card:hover {\n    border-color: var(--primary);\n}\n\n[data-theme=\"dark\"] .calendar-today-btn {\n    background: #334155;\n    color: var(--dark);\n    border-color: var(--primary);\n}\n\n[data-theme=\"dark\"] .view-btn {\n    color: #cbd5e1;\n}\n\n[data-theme=\"dark\"] .view-btn:hover {\n    background: rgba(99, 102, 241, 0.1);\n    color: var(--dark);\n}\n\n/* Animations */\n@keyframes fadeInDown {\n    from {\n        opacity: 0;\n        transform: translateY(-20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n@keyframes fadeInUp {\n    from {\n        opacity: 0;\n        transform: translateY(20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n@keyframes fadeIn {\n    from {\n        opacity: 0;\n    }\n    to {\n        opacity: 1;\n    }\n}\n\n@keyframes slideInLeft {\n    from {\n        transform: scaleX(0);\n    }\n    to {\n        transform: scaleX(1);\n    }\n}\n\n@keyframes gradientShift {\n    0%, 100% {\n        background-position: 0% 50%;\n    }\n    50% {\n        background-position: 100% 50%;\n    }\n}\n\n@keyframes float {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(-10px);\n    }\n}\n\n@keyframes pulseToday {\n    0%, 100% {\n        box-shadow: inset 0 0 15px rgba(99, 102, 241, 0.1);\n    }\n    50% {\n        box-shadow: inset 0 0 20px rgba(99, 102, 241, 0.2);\n    }\n}\n\n@keyframes eventSlideIn {\n    from {\n        opacity: 0;\n        transform: translateX(-10px);\n    }\n    to {\n        opacity: 1;\n        transform: translateX(0);\n    }\n}\n\n@keyframes shimmer {\n    0% {\n        opacity: 0.6;\n    }\n    50% {\n        opacity: 1;\n    }\n    100% {\n        opacity: 0.6;\n    }\n}\n\n/* Mobile Responsive */\n@media (max-width: 768px) {\n    .calendar-page-header {\n        flex-direction: column;\n        gap: 1rem;\n    }\n    \n    .calendar-header-actions {\n        width: 100%;\n        justify-content: stretch;\n    }\n    \n    .calendar-action-btn {\n        flex: 1;\n        justify-content: center;\n    }\n    \n    .calendar-view-selector {\n        flex-wrap: wrap;\n    }\n    \n    .view-btn {\n        flex: 1 1 calc(50% - 0.25rem);\n        min-width: 80px;\n    }\n    \n    .calendar-stats {\n        grid-template-columns: 1fr;\n    }\n    \n    .calendar-main-title {\n        font-size: 2rem;\n    }\n}\n\n","size_bytes":13754},"static/plan-trip-styles.css":{"content":"/* Plan Trip Page - Full Page Redesign */\n\n/* Full Page Container */\n.plan-trip-fullpage {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    margin: 0;\n    padding: 0;\n    padding-top: 80px;\n    overflow: hidden;\n    background: #f8fafc;\n}\n\n\n/* Split Layout */\n.plan-split-container {\n    position: relative;\n    z-index: 1;\n    display: grid;\n    grid-template-columns: 55% 45%;\n    height: calc(100vh - 80px);\n    gap: 0;\n}\n\n/* Left Side - Chat */\n.plan-chat-side {\n    display: flex;\n    flex-direction: column;\n    background: rgba(255, 255, 255, 0.95);\n    backdrop-filter: blur(20px);\n    border-right: 1px solid rgba(99, 102, 241, 0.1);\n    box-shadow: 5px 0 30px rgba(0, 0, 0, 0.05);\n}\n\n/* Chat Header */\n.plan-chat-header {\n    padding: 1.5rem 2rem;\n    background: transparent;\n    border-bottom: 2px solid rgba(0, 0, 0, 0.05);\n    flex-shrink: 0;\n}\n\n.plan-header-content {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    flex-wrap: wrap;\n    gap: 1rem;\n}\n\n.plan-header-title {\n    display: flex;\n    align-items: center;\n    gap: 1.5rem;\n}\n\n.plan-ai-icon {\n    width: 50px;\n    height: 50px;\n    animation: pulse 2s ease-in-out infinite;\n}\n\n@keyframes pulse {\n    0%, 100% {\n        transform: scale(1);\n        opacity: 1;\n    }\n    50% {\n        transform: scale(1.05);\n        opacity: 0.9;\n    }\n}\n\n.plan-header-title h1 {\n    font-size: 1.5rem;\n    font-weight: 800;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n    margin: 0 0 0.25rem 0;\n}\n\n.plan-header-title p {\n    font-size: 0.95rem;\n    color: var(--gray);\n    margin: 0;\n    font-weight: 500;\n}\n\n.plan-clear-btn {\n    padding: 0.75rem 1.5rem;\n    border-radius: 12px;\n    border: 2px solid rgba(102, 126, 234, 0.2);\n    background: white;\n    color: var(--primary);\n    font-weight: 600;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.plan-clear-btn:hover {\n    background: var(--primary);\n    color: white;\n    border-color: var(--primary);\n    transform: translateY(-2px);\n    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);\n    cursor: none;\n}\n\n/* Chat Messages */\n.plan-chat-messages {\n    flex: 1;\n    overflow-y: auto;\n    padding: 1.5rem 2rem;\n    background: transparent;\n    position: relative;\n    min-height: 0;\n}\n\n/* Welcome State */\n.plan-welcome-state {\n    text-align: center;\n    padding: 2rem 1.5rem;\n    animation: fadeInUp 0.8s ease-out;\n}\n\n.welcome-icon-pulse {\n    margin: 0 auto 2rem;\n    animation: iconPulse 3s ease-in-out infinite;\n}\n\n@keyframes iconPulse {\n    0%, 100% {\n        transform: scale(1) rotate(0deg);\n    }\n    50% {\n        transform: scale(1.1) rotate(5deg);\n    }\n}\n\n.plan-welcome-state h2 {\n    font-size: 2rem;\n    font-weight: 800;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n    margin: 0 0 0.75rem 0;\n}\n\n.plan-welcome-state p {\n    font-size: 1.05rem;\n    color: var(--gray);\n    margin: 0 0 1.5rem 0;\n    max-width: 500px;\n    margin-left: auto;\n    margin-right: auto;\n}\n\n.welcome-suggestions {\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n    max-width: 450px;\n    margin: 0 auto;\n}\n\n.suggestion-chip {\n    padding: 1.2rem 2rem;\n    border-radius: 15px;\n    border: 2px solid rgba(102, 126, 234, 0.2);\n    background: white;\n    color: var(--dark);\n    font-weight: 600;\n    font-size: 1.05rem;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    text-align: left;\n}\n\n.suggestion-chip:hover {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    border-color: transparent;\n    transform: translateX(10px);\n    box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);\n    cursor: none;\n}\n\n/* Chat Input Area */\n.plan-chat-input-area {\n    padding: 1rem 2rem 1.25rem;\n    background: white;\n    border-top: 2px solid rgba(0, 0, 0, 0.05);\n    flex-shrink: 0;\n}\n\n.plan-quick-actions {\n    display: flex;\n    gap: 0.75rem;\n    margin-bottom: 1rem;\n    flex-wrap: wrap;\n}\n\n.quick-chip {\n    padding: 0.6rem 1.2rem;\n    border-radius: 20px;\n    background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);\n    color: var(--primary);\n    font-weight: 600;\n    font-size: 0.9rem;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    border: 1px solid rgba(102, 126, 234, 0.2);\n}\n\n.quick-chip:hover {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    transform: translateY(-2px);\n    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);\n    cursor: none;\n}\n\n.plan-input-container {\n    display: flex;\n    gap: 1rem;\n    align-items: center;\n}\n\n.plan-chat-input {\n    flex: 1;\n    padding: 1.2rem 1.5rem;\n    border-radius: 15px;\n    border: 2px solid rgba(102, 126, 234, 0.2);\n    font-size: 1rem;\n    background: rgba(102, 126, 234, 0.03);\n    transition: all 0.3s ease;\n}\n\n.plan-chat-input:focus {\n    outline: none;\n    border-color: var(--primary);\n    background: white;\n    box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);\n}\n\n.plan-send-btn {\n    padding: 1.2rem 2rem;\n    border-radius: 15px;\n    border: none;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    font-weight: 700;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);\n}\n\n.plan-send-btn:hover {\n    transform: translateY(-3px);\n    box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);\n    cursor: none;\n}\n\n.plan-send-btn:active {\n    transform: translateY(-1px);\n}\n\n/* Right Side - Graphics */\n.plan-graphics-side {\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    align-items: center;\n    padding: calc(3rem - 5px) 1.5rem 2rem;\n    background: transparent;\n    overflow: hidden;\n}\n\n.plan-graphics-content {\n    width: 100%;\n    max-width: 600px;\n    display: flex;\n    flex-direction: column;\n    gap: 1.5rem;\n    max-height: 100%;\n}\n\n/* Travel Illustration */\n.travel-illustration {\n    width: 86%;\n    max-width: 520px;\n    margin: 0 auto;\n    animation: fadeIn 1s ease-out;\n}\n\n.travel-svg {\n    width: 100%;\n    height: auto;\n    filter: drop-shadow(0 10px 30px rgba(0, 0, 0, 0.1));\n    border-radius: 20px;\n}\n\n/* Cloud Animation */\n.cloud-1 {\n    animation: cloudFloat1 30s infinite ease-in-out;\n}\n\n.cloud-2 {\n    animation: cloudFloat2 40s infinite ease-in-out;\n}\n\n@keyframes cloudFloat1 {\n    0%, 100% {\n        transform: translateX(0);\n    }\n    50% {\n        transform: translateX(50px);\n    }\n}\n\n@keyframes cloudFloat2 {\n    0%, 100% {\n        transform: translateX(0);\n    }\n    50% {\n        transform: translateX(-30px);\n    }\n}\n\n/* Airplane Animation */\n.airplane {\n    animation: airplanefly 20s infinite linear;\n    transform-origin: center;\n}\n\n@keyframes airplanefly {\n    0% {\n        transform: translate(0, 0);\n    }\n    25% {\n        transform: translate(100px, -30px);\n    }\n    50% {\n        transform: translate(200px, 20px);\n    }\n    75% {\n        transform: translate(100px, 40px);\n    }\n    100% {\n        transform: translate(0, 0);\n    }\n}\n\n/* Wave Animation */\n.wave-1 {\n    animation: waveMove 8s infinite ease-in-out;\n}\n\n.wave-2 {\n    animation: waveMove 10s infinite ease-in-out;\n}\n\n@keyframes waveMove {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(-5px);\n    }\n}\n\n/* Palm Tree Animation */\n.palm-tree {\n    animation: palmSway 4s infinite ease-in-out;\n    transform-origin: bottom;\n}\n\n@keyframes palmSway {\n    0%, 100% {\n        transform: rotate(0deg);\n    }\n    25% {\n        transform: rotate(2deg);\n    }\n    75% {\n        transform: rotate(-2deg);\n    }\n}\n\n/* Stats Grid */\n.plan-stats-grid {\n    display: grid;\n    grid-template-columns: repeat(3, 1fr);\n    gap: 1.5rem;\n    animation: fadeInUp 1.2s ease-out;\n}\n\n.stat-card {\n    background: white;\n    border-radius: 15px;\n    padding: 1rem;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 0.5rem;\n    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);\n    transition: all 0.3s ease;\n    animation: fadeInUp 0.8s ease-out backwards;\n}\n\n.stat-1 {\n    animation-delay: 0.2s;\n}\n\n.stat-2 {\n    animation-delay: 0.4s;\n}\n\n.stat-3 {\n    animation-delay: 0.6s;\n}\n\n.stat-card:hover {\n    transform: translateY(-10px);\n    box-shadow: 0 15px 40px rgba(102, 126, 234, 0.2);\n}\n\n.stat-icon {\n    font-size: 2rem;\n    animation: bounce 2s ease-in-out infinite;\n}\n\n@keyframes bounce {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(-10px);\n    }\n}\n\n.stat-content {\n    text-align: center;\n}\n\n.stat-number {\n    font-size: 1.6rem;\n    font-weight: 800;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n}\n\n.stat-label {\n    font-size: 0.75rem;\n    color: var(--gray);\n    font-weight: 600;\n}\n\n/* Testimonial */\n.plan-testimonial {\n    background: white;\n    border-radius: 20px;\n    padding: 1.5rem;\n    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);\n    position: relative;\n    animation: fadeInUp 1.4s ease-out;\n}\n\n.quote-icon {\n    font-size: 3rem;\n    color: rgba(102, 126, 234, 0.2);\n    line-height: 1;\n    position: absolute;\n    top: 0.5rem;\n    left: 1rem;\n    font-family: Georgia, serif;\n}\n\n.quote-text {\n    font-size: 1rem;\n    color: var(--dark);\n    font-style: italic;\n    margin: 0 0 0.75rem 0;\n    padding-top: 1.5rem;\n    line-height: 1.5;\n}\n\n.quote-author {\n    font-size: 0.85rem;\n    color: var(--primary);\n    font-weight: 700;\n}\n\n/* Message Bubbles (existing styles) */\n.message {\n    margin-bottom: 1.5rem;\n    animation: slideIn 0.4s ease-out;\n}\n\n@keyframes slideIn {\n    from {\n        opacity: 0;\n        transform: translateY(20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.user-message {\n    text-align: right;\n}\n\n.ai-message {\n    text-align: left;\n}\n\n.message-bubble {\n    display: inline-block;\n    max-width: 75%;\n    padding: 1.2rem 1.5rem;\n    border-radius: 18px;\n    font-size: 1rem;\n    line-height: 1.5;\n    position: relative;\n}\n\n.user-message .message-bubble {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    border-bottom-right-radius: 4px;\n}\n\n.ai-message .message-bubble {\n    background: white;\n    color: var(--dark);\n    border-bottom-left-radius: 4px;\n    box-shadow: 0 3px 15px rgba(0, 0, 0, 0.08);\n}\n\n/* Responsive Design */\n@media (max-width: 1200px) {\n    .plan-split-container {\n        grid-template-columns: 60% 40%;\n    }\n    \n    .plan-stats-grid {\n        grid-template-columns: 1fr;\n    }\n}\n\n@media (max-width: 968px) {\n    .plan-split-container {\n        grid-template-columns: 1fr;\n        grid-template-rows: 1fr auto;\n    }\n    \n    .plan-graphics-side {\n        display: none;\n    }\n    \n    .plan-chat-side {\n        border-right: none;\n    }\n}\n\n@media (max-width: 640px) {\n    .plan-chat-header {\n        padding: 1.5rem;\n    }\n    \n    .plan-header-title h1 {\n        font-size: 1.4rem;\n    }\n    \n    .plan-ai-icon {\n        width: 45px;\n        height: 45px;\n    }\n    \n    .plan-chat-messages {\n        padding: 1.5rem;\n    }\n    \n    .plan-chat-input-area {\n        padding: 1rem 1.5rem;\n    }\n    \n    .plan-input-container {\n        flex-direction: column;\n    }\n    \n    .plan-send-btn {\n        width: 100%;\n        justify-content: center;\n    }\n    \n    .welcome-suggestions {\n        max-width: 100%;\n    }\n}\n\n/* Dark Mode Support */\n[data-theme=\"dark\"] .plan-trip-fullpage {\n    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);\n}\n\n[data-theme=\"dark\"] .plan-chat-side {\n    background: rgba(26, 26, 46, 0.95);\n    border-right-color: rgba(102, 126, 234, 0.2);\n}\n\n[data-theme=\"dark\"] .plan-chat-header {\n    background: linear-gradient(135deg, rgba(102, 126, 234, 0.15) 0%, rgba(118, 75, 162, 0.15) 100%);\n    border-bottom-color: rgba(102, 126, 234, 0.2);\n}\n\n[data-theme=\"dark\"] .plan-header-title h1 {\n    background: linear-gradient(135deg, #a5b4fc 0%, #c4b5fd 100%);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n}\n\n[data-theme=\"dark\"] .plan-header-title p {\n    color: #94a3b8;\n}\n\n[data-theme=\"dark\"] .plan-chat-messages {\n    background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(236, 72, 153, 0.05) 100%);\n}\n\n[data-theme=\"dark\"] .plan-welcome-state h2 {\n    background: linear-gradient(135deg, #a5b4fc 0%, #c4b5fd 100%);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n}\n\n[data-theme=\"dark\"] .plan-welcome-state p {\n    color: #94a3b8;\n}\n\n[data-theme=\"dark\"] .plan-chat-input-area {\n    background: rgba(26, 26, 46, 1);\n    border-top-color: rgba(102, 126, 234, 0.2);\n}\n\n[data-theme=\"dark\"] .plan-chat-input {\n    background: rgba(102, 126, 234, 0.08);\n    border-color: rgba(102, 126, 234, 0.3);\n    color: white;\n}\n\n[data-theme=\"dark\"] .plan-chat-input::placeholder {\n    color: rgba(255, 255, 255, 0.5);\n}\n\n[data-theme=\"dark\"] .suggestion-chip {\n    background: rgba(26, 26, 46, 1);\n    color: white;\n    border-color: rgba(102, 126, 234, 0.3);\n}\n\n[data-theme=\"dark\"] .quick-chip {\n    background: rgba(102, 126, 234, 0.15);\n    border-color: rgba(102, 126, 234, 0.3);\n    color: white;\n}\n\n[data-theme=\"dark\"] .stat-card {\n    background: rgba(26, 26, 46, 0.9);\n}\n\n[data-theme=\"dark\"] .stat-number {\n    background: linear-gradient(135deg, #a5b4fc 0%, #c4b5fd 100%);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n}\n\n[data-theme=\"dark\"] .stat-label {\n    color: #94a3b8;\n}\n\n[data-theme=\"dark\"] .plan-testimonial {\n    background: rgba(26, 26, 46, 0.9);\n}\n\n[data-theme=\"dark\"] .quote-text {\n    color: white;\n}\n\n[data-theme=\"dark\"] .quote-author {\n    color: #a5b4fc;\n}\n\n[data-theme=\"dark\"] .ai-message .message-bubble {\n    background: rgba(26, 26, 46, 0.9);\n    color: white;\n}\n\n[data-theme=\"dark\"] .plan-clear-btn {\n    background: rgba(26, 26, 46, 1);\n    color: white;\n    border-color: rgba(102, 126, 234, 0.3);\n}\n\n[data-theme=\"dark\"] .plan-graphics-side {\n    background: linear-gradient(135deg, rgba(102, 126, 234, 0.08) 0%, rgba(236, 72, 153, 0.08) 100%);\n}\n","size_bytes":14592},"static/booking-styles.css":{"content":"/* Booking Page Styles - MakeMyTrip-like design */\n\n/* Price Dropdown Styles */\n.price-dropdown {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n}\n\n.price-select {\n    padding: 0.5rem 1rem;\n    border: 2px solid #e2e8f0;\n    border-radius: 8px;\n    font-size: 0.95rem;\n    background: white;\n    color: var(--dark);\n    cursor: pointer;\n    transition: all 0.3s;\n    min-width: 200px;\n}\n\n.price-select:focus {\n    outline: none;\n    border-color: var(--primary);\n    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);\n}\n\n.price-display {\n    font-weight: 600;\n    color: var(--primary);\n    min-width: 80px;\n    text-align: right;\n}\n\n.total-price-display {\n    font-size: 1.3rem;\n    color: var(--primary);\n}\n\n/* Dark Mode Styles - Comprehensive */\n[data-theme=\"dark\"] {\n    --dark: #f8fafc;\n    --light: #1e293b;\n    --gray: #94a3b8;\n    background: #0f172a;\n    color: var(--dark);\n}\n\n[data-theme=\"dark\"] .booking-section,\n[data-theme=\"dark\"] .price-summary-card,\n[data-theme=\"dark\"] .booking-summary-card,\n[data-theme=\"dark\"] .flight-option,\n[data-theme=\"dark\"] .hotel-option {\n    background: #1e293b;\n    color: var(--dark);\n    border-color: #334155;\n    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);\n}\n\n[data-theme=\"dark\"] .booking-section-title,\n[data-theme=\"dark\"] .section-title {\n    color: #f8fafc;\n}\n\n[data-theme=\"dark\"] .feature-desc,\n[data-theme=\"dark\"] .booking-summary-content {\n    color: #cbd5e1;\n}\n\n[data-theme=\"dark\"] .price-select,\n[data-theme=\"dark\"] .form-input,\n[data-theme=\"dark\"] textarea.form-input {\n    background: #334155;\n    border-color: #475569;\n    color: #f8fafc;\n}\n\n[data-theme=\"dark\"] .price-select:focus,\n[data-theme=\"dark\"] .form-input:focus {\n    border-color: var(--primary);\n    background: #3f4b5f;\n}\n\n[data-theme=\"dark\"] .price-select::placeholder,\n[data-theme=\"dark\"] .form-input::placeholder {\n    color: #94a3b8;\n}\n\n[data-theme=\"dark\"] .flight-option:hover,\n[data-theme=\"dark\"] .hotel-option:hover {\n    background: #2d3748;\n    border-color: var(--primary);\n}\n\n[data-theme=\"dark\"] .flight-option.selected,\n[data-theme=\"dark\"] .hotel-option.selected {\n    background: rgba(99, 102, 241, 0.15);\n    border-color: var(--primary);\n}\n\n[data-theme=\"dark\"] .price-summary-footer {\n    background: #1e293b;\n    border-top-color: #334155;\n}\n\n[data-theme=\"dark\"] .price-summary-toggle {\n    color: #f8fafc;\n}\n\n[data-theme=\"dark\"] .passenger-form label,\n[data-theme=\"dark\"] .form-group label {\n    color: #cbd5e1;\n}\n\n[data-theme=\"dark\"] .loading-container p {\n    color: #94a3b8;\n}\n\n[data-theme=\"dark\"] .navbar {\n    background: rgba(30, 41, 59, 0.95);\n    border-bottom-color: #334155;\n}\n\n[data-theme=\"dark\"] .nav-link {\n    color: #cbd5e1;\n}\n\n[data-theme=\"dark\"] .nav-link:hover,\n[data-theme=\"dark\"] .nav-link.active {\n    background: rgba(99, 102, 241, 0.2);\n    color: var(--primary);\n}\n\n[data-theme=\"dark\"] .theme-toggle {\n    background: rgba(99, 102, 241, 0.2);\n    border-radius: 50%;\n    width: 40px;\n    height: 40px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.3s;\n}\n\n[data-theme=\"dark\"] .theme-toggle:hover {\n    background: rgba(99, 102, 241, 0.3);\n    transform: scale(1.1);\n}\n\n[data-theme=\"dark\"] .amenity-badge,\n[data-theme=\"dark\"] .badge {\n    background: #334155;\n    color: #cbd5e1;\n    border-color: #475569;\n}\n\n[data-theme=\"dark\"] .hotel-name,\n[data-theme=\"dark\"] .flight-airline strong {\n    color: #f8fafc;\n}\n\n[data-theme=\"dark\"] .hotel-location,\n[data-theme=\"dark\"] .flight-city {\n    color: #94a3b8;\n}\n\n/* Loading Spinners */\n.loading-spinner-small {\n    border: 3px solid rgba(99, 102, 241, 0.2);\n    border-top-color: var(--primary);\n    border-radius: 50%;\n    width: 20px;\n    height: 20px;\n    animation: spin 0.8s linear infinite;\n    display: inline-block;\n}\n\n@keyframes spin {\n    to { transform: rotate(360deg); }\n}\n\n.booking-section {\n    background: white;\n    border-radius: 20px;\n    padding: 2rem;\n    margin-bottom: 2rem;\n    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);\n}\n\n.booking-section-title {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--dark);\n    margin-bottom: 1.5rem;\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n}\n\n.options-container {\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n}\n\n.flight-option, .hotel-option {\n    border: 2px solid #e2e8f0;\n    border-radius: 12px;\n    padding: 1.5rem;\n    cursor: pointer;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    background: white;\n}\n\n.flight-option:hover, .hotel-option:hover {\n    border-color: var(--primary);\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(99, 102, 241, 0.15);\n}\n\n.flight-option.selected, .hotel-option.selected {\n    border-color: var(--primary);\n    background: rgba(99, 102, 241, 0.05);\n    box-shadow: 0 4px 20px rgba(99, 102, 241, 0.2);\n}\n\n.flight-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 1rem;\n}\n\n.flight-airline {\n    display: flex;\n    flex-direction: column;\n    gap: 0.25rem;\n}\n\n.flight-number {\n    font-size: 0.85rem;\n    color: var(--gray);\n}\n\n.flight-price {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--primary);\n}\n\n.flight-details {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    flex-wrap: wrap;\n    gap: 1rem;\n}\n\n.flight-time {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    flex: 1;\n}\n\n.flight-time > div {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n}\n\n.flight-time strong {\n    font-size: 1.2rem;\n    color: var(--dark);\n}\n\n.flight-city {\n    font-size: 0.85rem;\n    color: var(--gray);\n    margin-top: 0.25rem;\n}\n\n.flight-duration {\n    color: var(--gray);\n    font-size: 0.9rem;\n    padding: 0.5rem;\n    background: rgba(99, 102, 241, 0.1);\n    border-radius: 8px;\n}\n\n.flight-info {\n    display: flex;\n    gap: 0.5rem;\n    flex-wrap: wrap;\n}\n\n.hotel-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-start;\n    margin-bottom: 1rem;\n    gap: 1rem;\n}\n\n.hotel-name {\n    font-size: 1.3rem;\n    font-weight: 700;\n    color: var(--dark);\n    margin-bottom: 0.5rem;\n}\n\n.hotel-rating {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    color: var(--dark);\n    font-weight: 600;\n}\n\n.hotel-reviews {\n    font-size: 0.85rem;\n    color: var(--gray);\n    font-weight: 400;\n}\n\n.hotel-price {\n    text-align: right;\n}\n\n.price-per-night {\n    font-size: 1.1rem;\n    color: var(--gray);\n    margin-bottom: 0.25rem;\n}\n\n.price-total {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--primary);\n}\n\n.hotel-details {\n    display: flex;\n    flex-direction: column;\n    gap: 0.75rem;\n}\n\n.hotel-location {\n    color: var(--gray);\n    font-size: 0.9rem;\n}\n\n.hotel-amenities {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 0.5rem;\n}\n\n.amenity-badge {\n    padding: 0.3rem 0.8rem;\n    background: rgba(99, 102, 241, 0.1);\n    color: var(--primary);\n    border-radius: 20px;\n    font-size: 0.85rem;\n    font-weight: 500;\n}\n\n.booking-summary-card {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(236, 72, 153, 0.1) 100%);\n    border-radius: 20px;\n    padding: 2rem;\n    margin-bottom: 2rem;\n    border: 2px solid rgba(99, 102, 241, 0.2);\n}\n\n.price-summary-card {\n    background: white;\n    border-radius: 20px;\n    padding: 2rem;\n    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);\n}\n\n/* Collapsible Price Summary Footer */\n.price-summary-footer {\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    z-index: 1000;\n    background: white;\n    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.15);\n    border-top: 2px solid var(--primary);\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.price-summary-toggle {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 1rem 2rem;\n    cursor: pointer;\n    background: var(--gradient-1);\n    color: white;\n    transition: all 0.3s;\n    user-select: none;\n}\n\n.price-summary-toggle:hover {\n    background: linear-gradient(135deg, #7c8ef5 0%, #8a5db8 100%);\n}\n\n.toggle-content {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    flex: 1;\n}\n\n.toggle-icon {\n    font-size: 1.5rem;\n}\n\n.toggle-text {\n    font-size: 1.1rem;\n    font-weight: 600;\n}\n\n.toggle-total {\n    margin-left: auto;\n    font-size: 1.2rem;\n    font-weight: 700;\n    background: rgba(255, 255, 255, 0.2);\n    padding: 0.5rem 1rem;\n    border-radius: 8px;\n}\n\n.toggle-arrow {\n    font-size: 1.2rem;\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    margin-left: 1rem;\n}\n\n.price-summary-footer.expanded .toggle-arrow {\n    transform: rotate(180deg);\n}\n\n.price-summary-content {\n    max-height: 0;\n    overflow: hidden;\n    transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1), padding 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n    background: white;\n}\n\n.price-summary-footer.expanded .price-summary-content {\n    max-height: 800px;\n    padding: 2rem;\n    overflow-y: auto;\n}\n\n.price-summary-content .price-summary-card {\n    margin: 0;\n    box-shadow: none;\n    border: none;\n}\n\n/* Dark mode for footer */\n[data-theme=\"dark\"] .price-summary-footer {\n    background: #1e293b;\n    border-top-color: var(--primary);\n}\n\n[data-theme=\"dark\"] .price-summary-content {\n    background: #1e293b;\n}\n\n[data-theme=\"dark\"] .price-summary-content .price-summary-card {\n    background: #334155;\n    color: var(--dark);\n}\n\n/* Mobile responsive */\n@media (max-width: 768px) {\n    .price-summary-toggle {\n        padding: 0.75rem 1rem;\n    }\n    \n    .toggle-content {\n        flex-direction: column;\n        align-items: flex-start;\n        gap: 0.5rem;\n    }\n    \n    .toggle-text {\n        font-size: 1rem;\n    }\n    \n    .toggle-total {\n        margin-left: 0;\n        font-size: 1rem;\n        width: 100%;\n        text-align: center;\n    }\n    \n    .price-summary-footer.expanded .price-summary-content {\n        padding: 1rem;\n        max-height: 70vh;\n    }\n    \n    .price-dropdown {\n        flex-direction: column;\n        gap: 0.5rem;\n    }\n    \n    .price-select {\n        min-width: 100%;\n    }\n    \n    .price-display {\n        text-align: left;\n    }\n}\n\n.price-breakdown {\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n}\n\n.price-row {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0.75rem 0;\n    border-bottom: 1px solid #e2e8f0;\n    gap: 1rem;\n}\n\n.price-row > span:first-child {\n    font-weight: 500;\n    min-width: 150px;\n}\n\n.price-row.total-row {\n    border-top: 2px solid var(--primary);\n    border-bottom: none;\n    padding-top: 1rem;\n    margin-top: 0.5rem;\n    font-size: 1.2rem;\n}\n\n.passenger-form {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n    gap: 1.5rem;\n}\n\n.form-group {\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n}\n\n.form-group label {\n    font-weight: 600;\n    color: var(--dark);\n    display: flex;\n    align-items: center;\n    gap: 0.25rem;\n}\n\n.form-input {\n    padding: 0.75rem 1rem;\n    border: 2px solid #e2e8f0;\n    border-radius: 8px;\n    font-size: 1rem;\n    transition: all 0.3s;\n}\n\n.form-input:focus {\n    outline: none;\n    border-color: var(--primary);\n    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);\n}\n\n@media (max-width: 768px) {\n    .flight-time {\n        flex-direction: column;\n        align-items: flex-start;\n    }\n    \n    .hotel-header {\n        flex-direction: column;\n    }\n    \n    .hotel-price {\n        text-align: left;\n    }\n    \n    .price-summary-card {\n        position: relative;\n        top: 0;\n    }\n}\n\n","size_bytes":11598},"static/styles.css":{"content":"* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\n:root {\n    --primary: #6366f1;\n    --primary-dark: #4f46e5;\n    --secondary: #ec4899;\n    --accent: #14b8a6;\n    --dark: #1e293b;\n    --light: #f8fafc;\n    --gray: #64748b;\n    --success: #10b981;\n    --warning: #f59e0b;\n    --gradient-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    --gradient-2: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);\n    --gradient-3: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);\n    --gradient-hero: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);\n    \n    /* Light theme (default) */\n    --bg-primary: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);\n    --bg-secondary: #ffffff;\n    --bg-tertiary: #f8fafc;\n    --text-primary: #1e293b;\n    --text-secondary: #64748b;\n    --border-color: rgba(99, 102, 241, 0.1);\n    --shadow-sm: 0 2px 10px rgba(0, 0, 0, 0.1);\n    --shadow-md: 0 4px 20px rgba(0, 0, 0, 0.15);\n    --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.2);\n    --navbar-bg: rgba(255, 255, 255, 0.95);\n    --card-bg: rgba(255, 255, 255, 0.9);\n    --input-bg: #ffffff;\n    --chat-user-bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    --chat-assistant-bg: #f1f5f9;\n    --chat-assistant-text: #1e293b;\n}\n\n/* Dark theme */\n[data-theme=\"dark\"] {\n    --bg-primary: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);\n    --bg-secondary: #1e293b;\n    --bg-tertiary: #334155;\n    --text-primary: #f1f5f9;\n    --text-secondary: #94a3b8;\n    --border-color: rgba(99, 102, 241, 0.2);\n    --shadow-sm: 0 2px 10px rgba(0, 0, 0, 0.3);\n    --shadow-md: 0 4px 20px rgba(0, 0, 0, 0.4);\n    --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.5);\n    --navbar-bg: rgba(30, 41, 59, 0.95);\n    --card-bg: rgba(30, 41, 59, 0.9);\n    --input-bg: #334155;\n    --chat-user-bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    --chat-assistant-bg: #334155;\n    --chat-assistant-text: #f1f5f9;\n}\n\nbody {\n    font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    background: var(--bg-primary);\n    background-attachment: fixed;\n    color: var(--text-primary);\n    line-height: 1.6;\n    overflow-x: hidden;\n    position: relative;\n    transition: background 0.3s ease, color 0.3s ease;\n    cursor: none;\n}\n\n/* Custom Cursor */\n.custom-cursor {\n    position: fixed;\n    width: 20px;\n    height: 20px;\n    border: 2px solid var(--primary);\n    border-radius: 50%;\n    pointer-events: none;\n    z-index: 9999;\n    transition: transform 0.15s ease, opacity 0.15s ease;\n    opacity: 0;\n    mix-blend-mode: difference;\n}\n\n.custom-cursor-dot {\n    position: fixed;\n    width: 6px;\n    height: 6px;\n    background: var(--primary);\n    border-radius: 50%;\n    pointer-events: none;\n    z-index: 10000;\n    transition: transform 0.1s ease, opacity 0.1s ease;\n    opacity: 0;\n}\n\n.custom-cursor.active {\n    opacity: 1;\n}\n\n.custom-cursor-dot.active {\n    opacity: 1;\n}\n\n.custom-cursor.clicked {\n    transform: scale(0.6);\n}\n\n.custom-cursor.hovering {\n    transform: scale(1.5);\n    border-color: var(--secondary);\n}\n\n.custom-cursor-dot.hovering {\n    background: var(--secondary);\n    transform: scale(2);\n}\n\nbody::before {\n    content: '';\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: \n        radial-gradient(circle at 20% 50%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),\n        radial-gradient(circle at 80% 80%, rgba(236, 72, 153, 0.1) 0%, transparent 50%),\n        radial-gradient(circle at 40% 20%, rgba(20, 184, 166, 0.1) 0%, transparent 50%);\n    pointer-events: none;\n    z-index: 0;\n}\n\n.page {\n    display: none;\n    animation: fadeIn 0.5s ease-in-out;\n    position: relative;\n    z-index: 1;\n}\n\n.page.active {\n    display: block;\n    animation: slideInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1);\n}\n\n@keyframes slideInUp {\n    from {\n        opacity: 0;\n        transform: translateY(30px) scale(0.95);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0) scale(1);\n    }\n}\n\n@keyframes fadeIn {\n    from {\n        opacity: 0;\n        transform: translateY(20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n@keyframes fadeInUp {\n    from {\n        opacity: 0;\n        transform: translateY(40px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.navbar {\n    background: var(--navbar-bg);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n    box-shadow: var(--shadow-sm);\n    position: sticky;\n    top: 0;\n    z-index: 1000;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    border-bottom: 1px solid var(--border-color);\n}\n\n.navbar.scrolled {\n    box-shadow: var(--shadow-md);\n    padding: 0.5rem 0;\n}\n\n.nav-container {\n    max-width: 1400px;\n    margin: 0 auto;\n    padding: 0.75rem 2rem;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    gap: 1.5rem;\n}\n\n.nav-logo {\n    font-size: 1.5rem;\n    font-weight: 800;\n    background: var(--gradient-1);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    transition: all 0.3s;\n    position: relative;\n}\n\n.nav-logo:hover {\n    transform: scale(1.05);\n    filter: brightness(1.1);\n    cursor: none;\n}\n\n.nav-logo::after {\n    content: '';\n    position: absolute;\n    bottom: -5px;\n    left: 0;\n    width: 0;\n    height: 3px;\n    background: var(--gradient-1);\n    transition: width 0.3s;\n    border-radius: 2px;\n}\n\n.nav-logo:hover::after {\n    width: 100%;\n}\n\n.nav-links {\n    display: flex;\n    gap: 1.5rem;\n    align-items: center;\n    list-style: none;\n}\n\n.nav-link {\n    cursor: pointer;\n    padding: 0.5rem 1rem;\n    border-radius: 8px;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    font-weight: 500;\n    color: var(--gray);\n    position: relative;\n    overflow: hidden;\n}\n\n.nav-link::before {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 0;\n    height: 0;\n    border-radius: 50%;\n    background: rgba(99, 102, 241, 0.1);\n    transform: translate(-50%, -50%);\n    transition: width 0.6s, height 0.6s;\n}\n\n.nav-link:hover::before {\n    width: 300px;\n    height: 300px;\n}\n\n.nav-link:hover,\n.nav-link.active {\n    color: var(--primary);\n    background: rgba(99, 102, 241, 0.1);\n    transform: translateY(-2px);\n    cursor: none;\n}\n\n.nav-link.active {\n    font-weight: 600;\n    box-shadow: 0 2px 8px rgba(99, 102, 241, 0.2);\n}\n\n.nav-link.nav-booking {\n    background: var(--gradient-1) !important;\n    color: white !important;\n    transition: all 0.3s;\n}\n\n.nav-link.nav-booking:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);\n    cursor: none;\n}\n\n.theme-toggle {\n    cursor: pointer;\n    padding: 0.5rem;\n    border-radius: 50%;\n    width: 40px;\n    height: 40px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.3s;\n    font-size: 1.2rem;\n}\n\n.theme-toggle:hover {\n    background: rgba(99, 102, 241, 0.1);\n    transform: scale(1.1) rotate(15deg);\n    cursor: none;\n}\n\n/* Dark Mode Global Styles */\n[data-theme=\"dark\"] {\n    --dark: #f8fafc;\n    --light: #1e293b;\n    --gray: #94a3b8;\n}\n\n[data-theme=\"dark\"] body {\n    background: #0f172a;\n    color: var(--dark);\n}\n\n[data-theme=\"dark\"] body::before {\n    background: \n        radial-gradient(circle at 20% 50%, rgba(99, 102, 241, 0.05) 0%, transparent 50%),\n        radial-gradient(circle at 80% 80%, rgba(236, 72, 153, 0.05) 0%, transparent 50%),\n        radial-gradient(circle at 40% 20%, rgba(20, 184, 166, 0.05) 0%, transparent 50%);\n}\n\n[data-theme=\"dark\"] .page {\n    background: transparent;\n}\n\n[data-theme=\"dark\"] .feature-card,\n[data-theme=\"dark\"] .trip-card,\n[data-theme=\"dark\"] .chat-box,\n[data-theme=\"dark\"] .preferences-card {\n    background: #1e293b;\n    color: var(--dark);\n    border-color: #334155;\n}\n\n[data-theme=\"dark\"] .message-bubble {\n    background: #334155;\n    color: var(--dark);\n}\n\n[data-theme=\"dark\"] .message.user .message-bubble {\n    background: var(--gradient-1);\n    color: white;\n}\n\n[data-theme=\"dark\"] .chat-messages {\n    background: #0f172a;\n}\n\n[data-theme=\"dark\"] .chat-input {\n    background: #334155;\n    border-color: #475569;\n    color: var(--dark);\n}\n\n[data-theme=\"dark\"] .btn-primary {\n    background: var(--gradient-1);\n    color: white;\n}\n\n[data-theme=\"dark\"] .badge {\n    background: rgba(99, 102, 241, 0.2);\n    color: var(--primary);\n}\n\n/* Dark Mode - Hero Section */\n[data-theme=\"dark\"] .hero {\n    background: linear-gradient(135deg, #1e293b 0%, #334155 50%, #1e293b 100%);\n}\n\n/* Dark Mode - Features Section */\n[data-theme=\"dark\"] .features {\n    background: #0f172a;\n}\n\n[data-theme=\"dark\"] .features::before {\n    background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.3), transparent);\n}\n\n/* Dark Mode - Trip Cards */\n[data-theme=\"dark\"] .trip-content {\n    background: #1e293b;\n    color: var(--dark);\n}\n\n[data-theme=\"dark\"] .trip-title,\n[data-theme=\"dark\"] .feature-title {\n    color: var(--dark);\n}\n\n[data-theme=\"dark\"] .feature-desc,\n[data-theme=\"dark\"] .trip-desc {\n    color: #94a3b8;\n}\n\n[data-theme=\"dark\"] .trip-image {\n    background: #334155;\n}\n\n/* Dark Mode - Section Titles */\n[data-theme=\"dark\"] .section-title {\n    color: var(--dark);\n}\n\n/* Dark Mode - Inputs and Form Elements */\n[data-theme=\"dark\"] input[type=\"text\"],\n[data-theme=\"dark\"] input[type=\"email\"],\n[data-theme=\"dark\"] input[type=\"password\"],\n[data-theme=\"dark\"] input[type=\"date\"],\n[data-theme=\"dark\"] input[type=\"number\"],\n[data-theme=\"dark\"] textarea,\n[data-theme=\"dark\"] select {\n    background: #334155;\n    border-color: #475569;\n    color: var(--dark);\n}\n\n[data-theme=\"dark\"] input::placeholder,\n[data-theme=\"dark\"] textarea::placeholder {\n    color: #64748b;\n}\n\n/* Dark Mode - Calendar Modal */\n[data-theme=\"dark\"] .modal-content {\n    background: #1e293b;\n    color: var(--dark);\n    border-color: #334155;\n}\n\n[data-theme=\"dark\"] .modal-header {\n    border-bottom-color: #334155;\n}\n\n[data-theme=\"dark\"] .modal-close {\n    color: var(--dark);\n}\n\n[data-theme=\"dark\"] .modal-close:hover {\n    background: rgba(255, 255, 255, 0.1);\n    cursor: none;\n}\n\n[data-theme=\"dark\"] .form-group label {\n    color: var(--dark);\n}\n\n/* Dark Mode - Buttons */\n[data-theme=\"dark\"] .btn-secondary {\n    background: #334155;\n    color: var(--dark);\n    border-color: #475569;\n}\n\n[data-theme=\"dark\"] .btn-secondary:hover {\n    background: #475569;\n    cursor: none;\n}\n\n/* Dark Mode - Booking Modal */\n[data-theme=\"dark\"] .booking-details-modal {\n    background: #1e293b;\n}\n\n[data-theme=\"dark\"] .booking-detail-section {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.08) 0%, rgba(236, 72, 153, 0.08) 100%);\n    border-color: rgba(99, 102, 241, 0.2);\n}\n\n[data-theme=\"dark\"] .booking-detail-section h3 {\n    color: #a5b4fc;\n}\n\n[data-theme=\"dark\"] .booking-detail-section p,\n[data-theme=\"dark\"] .booking-detail-section li {\n    color: #cbd5e1;\n}\n\n[data-theme=\"dark\"] .booking-summary {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.08) 0%, rgba(236, 72, 153, 0.08) 100%);\n}\n\n[data-theme=\"dark\"] .booking-item {\n    border-bottom-color: #334155;\n}\n\n[data-theme=\"dark\"] .booking-item label {\n    color: #94a3b8;\n}\n\n[data-theme=\"dark\"] .booking-item span {\n    color: var(--dark);\n}\n\n[data-theme=\"dark\"] .booking-summary-card {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.08) 0%, rgba(236, 72, 153, 0.08) 100%);\n}\n\n[data-theme=\"dark\"] .booking-section {\n    background: #1e293b;\n    border: 1px solid #334155;\n}\n\n[data-theme=\"dark\"] .booking-section-title {\n    color: var(--dark);\n}\n\n[data-theme=\"dark\"] .booking-summary-item strong {\n    color: #a5b4fc;\n}\n\n[data-theme=\"dark\"] .booking-summary-item {\n    color: #cbd5e1;\n}\n\n[data-theme=\"dark\"] .booking-footer-note {\n    background: rgba(99, 102, 241, 0.08);\n}\n\n[data-theme=\"dark\"] .booking-footer-note p {\n    color: #94a3b8;\n}\n\n[data-theme=\"dark\"] .booking-destination {\n    color: white;\n}\n\n[data-theme=\"dark\"] .booking-subtitle {\n    color: rgba(255, 255, 255, 0.9);\n}\n\n.btn-inline {\n    display: inline-block;\n    margin: 0.5rem 0.5rem 0.5rem 0;\n    padding: 0.5rem 1rem;\n    background: var(--primary);\n    color: white;\n    border: none;\n    border-radius: 8px;\n    cursor: pointer;\n    font-size: 0.9rem;\n    transition: all 0.3s;\n}\n\n.btn-inline:hover {\n    background: var(--primary-dark);\n    transform: translateY(-2px);\n    box-shadow: 0 4px 8px rgba(99, 102, 241, 0.3);\n    cursor: none;\n}\n\n.hero {\n    background: var(--gradient-hero);\n    min-height: 90vh;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    position: relative;\n    overflow: hidden;\n    animation: gradientShift 10s ease infinite;\n    background-size: 200% 200%;\n}\n\n@keyframes gradientShift {\n    0%, 100% {\n        background-position: 0% 50%;\n    }\n    50% {\n        background-position: 100% 50%;\n    }\n}\n\n.hero::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 1440 320\"><path fill=\"rgba(255,255,255,0.1)\" d=\"M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,122.7C672,117,768,139,864,138.7C960,139,1056,117,1152,112C1248,107,1344,117,1392,122.7L1440,128L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z\"></path></svg>') no-repeat bottom;\n    animation: wave 10s linear infinite;\n}\n\n@keyframes wave {\n    0% {\n        background-position: 0 bottom;\n    }\n    100% {\n        background-position: 1440px bottom;\n    }\n}\n\n.hero-content {\n    text-align: center;\n    color: white;\n    z-index: 1;\n    padding: 2rem;\n    max-width: 900px;\n}\n\n.hero-title {\n    font-size: 4rem;\n    font-weight: 900;\n    margin-bottom: 1rem;\n    animation: slideUp 1s ease-out;\n}\n\n@keyframes slideUp {\n    from {\n        opacity: 0;\n        transform: translateY(50px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.hero-subtitle {\n    font-size: 1.5rem;\n    margin-bottom: 2rem;\n    opacity: 0.95;\n    animation: slideUp 1s ease-out 0.2s both;\n}\n\n.hero-buttons {\n    display: flex;\n    gap: 1rem;\n    justify-content: center;\n    animation: slideUp 1s ease-out 0.4s both;\n}\n\n.btn {\n    padding: 1rem 2.5rem;\n    border: none;\n    border-radius: 50px;\n    font-size: 1.1rem;\n    font-weight: 600;\n    cursor: pointer;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    display: inline-flex;\n    align-items: center;\n    gap: 0.5rem;\n    position: relative;\n    overflow: hidden;\n}\n\n.btn::before {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 0;\n    height: 0;\n    border-radius: 50%;\n    background: rgba(255, 255, 255, 0.3);\n    transform: translate(-50%, -50%);\n    transition: width 0.6s, height 0.6s;\n}\n\n.btn:hover::before {\n    width: 300px;\n    height: 300px;\n    cursor: none;\n}\n\n.btn-primary {\n    background: white;\n    color: var(--primary);\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);\n}\n\n.btn-primary:hover {\n    transform: translateY(-3px) scale(1.05);\n    box-shadow: 0 15px 40px rgba(99, 102, 241, 0.4);\n    cursor: none;\n}\n\n.btn-primary:active {\n    transform: translateY(-1px) scale(1.02);\n}\n\n.btn-secondary {\n    background: rgba(255, 255, 255, 0.2);\n    color: white;\n    border: 2px solid white;\n    backdrop-filter: blur(10px);\n}\n\n.btn-secondary:hover {\n    background: rgba(255, 255, 255, 0.3);\n    transform: translateY(-3px);\n    cursor: none;\n}\n\n.features {\n    padding: 5rem 2rem;\n    background: white;\n    position: relative;\n}\n\n.features::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 1px;\n    background: linear-gradient(90deg, transparent, var(--primary), transparent);\n}\n\n.container {\n    max-width: 1400px;\n    margin: 0 auto;\n}\n\n.section-title {\n    text-align: center;\n    font-size: 2.5rem;\n    font-weight: 800;\n    margin-bottom: 3rem;\n    background: var(--gradient-1);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n}\n\n.features-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n    gap: 2rem;\n    justify-items: center;\n}\n\n.feature-card {\n    background: white;\n    padding: 2rem;\n    border-radius: 20px;\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n    border: 2px solid transparent;\n    position: relative;\n    overflow: hidden;\n}\n\n.feature-card::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(99, 102, 241, 0.1), transparent);\n    transition: left 0.6s;\n}\n\n.feature-card:hover::before {\n    left: 100%;\n}\n\n.feature-card:hover {\n    transform: translateY(-10px) scale(1.02);\n    box-shadow: 0 20px 50px rgba(99, 102, 241, 0.2);\n    border-color: var(--primary);\n    cursor: none;\n}\n\n.feature-card:nth-child(1) { animation-delay: 0.1s; }\n.feature-card:nth-child(2) { animation-delay: 0.2s; }\n.feature-card:nth-child(3) { animation-delay: 0.3s; }\n.feature-card:nth-child(4) { animation-delay: 0.4s; }\n.feature-card:nth-child(5) { animation-delay: 0.5s; }\n.feature-card:nth-child(6) { animation-delay: 0.6s; }\n\n.feature-icon {\n    font-size: 3rem;\n    margin-bottom: 1rem;\n    display: inline-block;\n    transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);\n}\n\n.feature-card:hover .feature-icon {\n    transform: scale(1.2) rotate(5deg);\n}\n\n.feature-title {\n    font-size: 1.5rem;\n    font-weight: 700;\n    margin-bottom: 0.5rem;\n    color: var(--dark);\n}\n\n.feature-desc {\n    color: var(--gray);\n    line-height: 1.7;\n}\n\n.chat-container {\n    max-width: 1400px;\n    margin: 2rem auto;\n    padding: 0 2rem;\n}\n\n.chat-box {\n    background: white;\n    border-radius: 20px;\n    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);\n    overflow: hidden;\n    height: 700px;\n    display: flex;\n    flex-direction: column;\n    border: 1px solid rgba(99, 102, 241, 0.1);\n    animation: slideInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1);\n    position: relative;\n}\n\n.chat-box::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 4px;\n    background: var(--gradient-1);\n    animation: shimmer 2s infinite;\n}\n\n@keyframes shimmer {\n    0% {\n        background-position: -200% 0;\n    }\n    100% {\n        background-position: 200% 0;\n    }\n}\n\n.chat-header {\n    background: var(--gradient-1);\n    color: white;\n    padding: 1.5rem;\n    font-size: 1.3rem;\n    font-weight: 700;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    position: relative;\n    overflow: hidden;\n}\n\n.chat-header::before {\n    content: '';\n    position: absolute;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);\n    animation: rotate 20s linear infinite;\n}\n\n@keyframes rotate {\n    from {\n        transform: rotate(0deg);\n    }\n    to {\n        transform: rotate(360deg);\n    }\n}\n\n.chat-messages {\n    flex: 1;\n    padding: 2rem;\n    overflow-y: auto;\n    background: #f8fafc;\n}\n\n.message {\n    margin-bottom: 1.5rem;\n    animation: messageSlide 0.4s cubic-bezier(0.16, 1, 0.3, 1);\n    opacity: 0;\n    animation-fill-mode: forwards;\n}\n\n.message.user {\n    animation-delay: 0.1s;\n}\n\n.message.assistant {\n    animation-delay: 0.2s;\n}\n\n@keyframes messageSlide {\n    from {\n        opacity: 0;\n        transform: translateX(-20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateX(0);\n    }\n}\n\n.message.user {\n    text-align: right;\n}\n\n.message.user .message-bubble {\n    animation: messageSlideRight 0.3s ease-out;\n}\n\n@keyframes messageSlideRight {\n    from {\n        opacity: 0;\n        transform: translateX(20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateX(0);\n    }\n}\n\n.message-bubble {\n    display: inline-block;\n    max-width: 70%;\n    padding: 1rem 1.5rem;\n    border-radius: 20px;\n    text-align: left;\n    position: relative;\n    word-wrap: break-word;\n    animation: bubblePop 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);\n}\n\n@keyframes bubblePop {\n    0% {\n        transform: scale(0.8);\n        opacity: 0;\n    }\n    50% {\n        transform: scale(1.05);\n    }\n    100% {\n        transform: scale(1);\n        opacity: 1;\n    }\n}\n\n.message.user .message-bubble {\n    background: var(--gradient-1);\n    color: white;\n    border-bottom-right-radius: 5px;\n}\n\n.message.assistant .message-bubble {\n    background: white;\n    color: var(--dark);\n    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n    border-bottom-left-radius: 5px;\n}\n\n.chat-input-area {\n    padding: 1.5rem;\n    background: white;\n    border-top: 1px solid #e2e8f0;\n}\n\n.chat-input-container {\n    display: flex;\n    gap: 1rem;\n}\n\n.chat-input {\n    flex: 1;\n    padding: 1rem 1.5rem;\n    border: 2px solid #e2e8f0;\n    border-radius: 50px;\n    font-size: 1rem;\n    outline: none;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    background: white;\n}\n\n.chat-input:focus {\n    border-color: var(--primary);\n    box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.15), 0 4px 12px rgba(99, 102, 241, 0.1);\n    transform: translateY(-2px);\n}\n\n.chat-input::placeholder {\n    color: #94a3b8;\n    transition: opacity 0.3s;\n}\n\n.chat-input:focus::placeholder {\n    opacity: 0.5;\n}\n\n.preferences-container {\n    max-width: 900px;\n    margin: 2rem auto;\n    padding: 0 2rem;\n}\n\n.preferences-card {\n    background: white;\n    padding: 2rem;\n    border-radius: 20px;\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);\n    margin-bottom: 2rem;\n}\n\n.form-group {\n    margin-bottom: 1.5rem;\n}\n\n.form-label {\n    display: block;\n    margin-bottom: 0.5rem;\n    font-weight: 600;\n    color: var(--dark);\n}\n\n.form-input,\n.form-select {\n    width: 100%;\n    padding: 0.75rem 1rem;\n    border: 2px solid #e2e8f0;\n    border-radius: 10px;\n    font-size: 1rem;\n    outline: none;\n    transition: all 0.3s;\n}\n\n.form-input:focus,\n.form-select:focus {\n    border-color: var(--primary);\n    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);\n}\n\n.loading-spinner {\n    display: inline-block;\n    width: 20px;\n    height: 20px;\n    border: 3px solid rgba(255, 255, 255, 0.3);\n    border-radius: 50%;\n    border-top-color: white;\n    animation: spin 0.8s linear infinite;\n}\n\n@keyframes spin {\n    to {\n        transform: rotate(360deg);\n    }\n}\n\n.badge {\n    display: inline-block;\n    padding: 0.4rem 1rem;\n    border-radius: 20px;\n    font-size: 0.85rem;\n    font-weight: 600;\n    margin: 0.25rem;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n}\n\n.badge::before {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 0;\n    height: 0;\n    border-radius: 50%;\n    background: rgba(255, 255, 255, 0.3);\n    transform: translate(-50%, -50%);\n    transition: width 0.4s, height 0.4s;\n}\n\n.badge:hover::before {\n    width: 200px;\n    height: 200px;\n}\n\n.badge:hover {\n    transform: translateY(-2px) scale(1.05);\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.badge-primary {\n    background: rgba(99, 102, 241, 0.1);\n    color: var(--primary);\n}\n\n.badge-success {\n    background: rgba(16, 185, 129, 0.1);\n    color: var(--success);\n}\n\n.trips-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));\n    gap: 2rem;\n    padding: 2rem;\n}\n\n.trip-card {\n    background: white;\n    border-radius: 20px;\n    overflow: hidden;\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n    cursor: pointer;\n    position: relative;\n    border: 1px solid rgba(0, 0, 0, 0.05);\n    animation: fadeInUp 0.6s ease-out forwards;\n    opacity: 0;\n}\n\n.trip-card:nth-child(1) {\n    animation-delay: 0.1s;\n}\n\n.trip-card:nth-child(2) {\n    animation-delay: 0.2s;\n}\n\n.trip-card:nth-child(3) {\n    animation-delay: 0.3s;\n}\n\n.trip-card:nth-child(4) {\n    animation-delay: 0.4s;\n}\n\n@keyframes fadeInUp {\n    from {\n        opacity: 0;\n        transform: translateY(30px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.trip-card::after {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    border-radius: 20px;\n    padding: 2px;\n    background: var(--gradient-1);\n    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);\n    -webkit-mask-composite: xor;\n    mask-composite: exclude;\n    opacity: 0;\n    transition: opacity 0.3s;\n}\n\n.trip-card:hover::after {\n    opacity: 1;\n}\n\n.trip-card:hover {\n    transform: translateY(-10px);\n    box-shadow: 0 20px 60px rgba(99, 102, 241, 0.2);\n    border-color: rgba(99, 102, 241, 0.3);\n    cursor: none;\n}\n\n.trip-image {\n    width: 100%;\n    height: 200px;\n    background: var(--gradient-1);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 4rem;\n    position: relative;\n    overflow: hidden;\n    transition: all 0.4s ease;\n}\n\n.trip-image::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0) 100%);\n    opacity: 0;\n    transition: opacity 0.4s ease;\n}\n\n.trip-card:hover .trip-image::before {\n    opacity: 1;\n}\n\n.trip-card:hover .trip-image {\n    transform: scale(1.05);\n}\n\n.trip-content {\n    padding: 1.5rem;\n    background: white;\n    position: relative;\n}\n\n.trip-title {\n    font-size: 1.3rem;\n    font-weight: 700;\n    margin-bottom: 0.5rem;\n    color: var(--dark);\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.trip-meta {\n    color: var(--gray);\n    font-size: 0.9rem;\n    margin-bottom: 1rem;\n    display: flex;\n    flex-wrap: wrap;\n    gap: 0.5rem;\n}\n\n.modal {\n    display: none;\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: rgba(0, 0, 0, 0.7);\n    z-index: 2000;\n    align-items: center;\n    justify-content: center;\n    backdrop-filter: blur(5px);\n    animation: modalFadeIn 0.3s ease-out;\n}\n\n.modal.active {\n    display: flex;\n}\n\n@keyframes modalFadeIn {\n    from {\n        opacity: 0;\n    }\n    to {\n        opacity: 1;\n    }\n}\n\n.modal-content {\n    background: white;\n    border-radius: 20px;\n    max-width: 600px;\n    width: 90%;\n    max-height: 85vh;\n    overflow-y: auto;\n    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n    animation: modalSlideUp 0.3s ease-out;\n}\n\n@keyframes modalSlideUp {\n    from {\n        transform: translateY(50px);\n        opacity: 0;\n    }\n    to {\n        transform: translateY(0);\n        opacity: 1;\n    }\n}\n\n.modal-header {\n    background: var(--gradient-1);\n    color: white;\n    padding: 1.5rem 2rem;\n    border-radius: 20px 20px 0 0;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n.modal-header h2 {\n    margin: 0;\n    font-size: 1.5rem;\n}\n\n.modal-close {\n    background: rgba(255, 255, 255, 0.2);\n    border: none;\n    color: white;\n    font-size: 1.5rem;\n    cursor: pointer;\n    width: 40px;\n    height: 40px;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.3s;\n}\n\n.modal-close:hover {\n    background: rgba(255, 255, 255, 0.3);\n    transform: rotate(90deg);\n    cursor: none;\n}\n\n.modal-body {\n    padding: 2rem;\n}\n\n/* Booking Details Modal */\n.modal-backdrop {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: rgba(0, 0, 0, 0.7);\n    backdrop-filter: blur(8px);\n    z-index: 2000;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    animation: modalFadeIn 0.3s ease-out;\n}\n\n.booking-details-modal {\n    background: var(--bg-secondary);\n    border-radius: 20px;\n    max-width: 700px;\n    width: 90%;\n    max-height: 90vh;\n    overflow-y: auto;\n    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n    animation: modalSlideUp 0.3s ease-out;\n}\n\n.booking-details-modal .modal-header {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    padding: 2rem;\n    border-radius: 20px 20px 0 0;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    position: relative;\n    overflow: hidden;\n}\n\n.booking-details-modal .modal-header::before {\n    content: '';\n    position: absolute;\n    top: -50%;\n    right: -50%;\n    width: 200%;\n    height: 200%;\n    background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);\n    animation: rotate 20s linear infinite;\n}\n\n.booking-details-modal .modal-header h2 {\n    margin: 0;\n    font-size: 1.8rem;\n    font-weight: 800;\n    position: relative;\n    z-index: 1;\n}\n\n.close-btn {\n    background: rgba(255, 255, 255, 0.2);\n    border: none;\n    color: white;\n    font-size: 2rem;\n    cursor: pointer;\n    width: 45px;\n    height: 45px;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.3s;\n    position: relative;\n    z-index: 1;\n    line-height: 1;\n}\n\n.close-btn:hover {\n    background: rgba(255, 255, 255, 0.3);\n    transform: rotate(90deg);\n}\n\n.booking-status-badges {\n    display: flex;\n    gap: 0.75rem;\n    margin-bottom: 2rem;\n    flex-wrap: wrap;\n}\n\n.booking-detail-section {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.03) 0%, rgba(236, 72, 153, 0.03) 100%);\n    border: 1px solid rgba(99, 102, 241, 0.1);\n    border-radius: 15px;\n    padding: 1.5rem;\n    margin-bottom: 1.5rem;\n}\n\n.booking-detail-section h3 {\n    color: var(--primary);\n    font-size: 1.2rem;\n    font-weight: 700;\n    margin-bottom: 1rem;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.detail-row {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 0.75rem 0;\n    border-bottom: 1px solid rgba(99, 102, 241, 0.1);\n}\n\n.detail-row:last-child {\n    border-bottom: none;\n}\n\n.detail-label {\n    color: var(--gray);\n    font-weight: 500;\n    font-size: 0.95rem;\n}\n\n.detail-value {\n    color: var(--text-primary);\n    font-weight: 600;\n    text-align: right;\n}\n\n.detail-value code {\n    background: rgba(99, 102, 241, 0.1);\n    padding: 0.25rem 0.75rem;\n    border-radius: 8px;\n    color: var(--primary);\n    font-family: 'Courier New', monospace;\n    font-size: 0.9rem;\n}\n\n.modal-actions {\n    display: flex;\n    gap: 1rem;\n    margin-top: 2rem;\n    padding-top: 1.5rem;\n    border-top: 2px solid rgba(99, 102, 241, 0.1);\n    flex-wrap: wrap;\n}\n\n.modal-actions .btn {\n    flex: 1;\n    min-width: 150px;\n}\n\n/* Trip card hover effect */\n.trip-card:hover {\n    transform: translateY(-5px);\n    box-shadow: 0 15px 40px rgba(99, 102, 241, 0.2);\n    cursor: none;\n}\n\n.booking-summary {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(236, 72, 153, 0.05) 100%);\n    padding: 1.5rem;\n    border-radius: 15px;\n    margin-bottom: 1.5rem;\n}\n\n.booking-item {\n    display: flex;\n    justify-content: space-between;\n    padding: 0.75rem 0;\n    border-bottom: 1px solid rgba(0, 0, 0, 0.1);\n}\n\n.booking-item:last-child {\n    border-bottom: none;\n    font-weight: 700;\n    font-size: 1.2rem;\n    color: var(--primary);\n}\n\n.booking-item label {\n    color: var(--gray);\n}\n\n.booking-item span {\n    color: var(--dark);\n    font-weight: 600;\n}\n\n/* Enhanced Booking Modal Styles */\n.booking-hero {\n    background: var(--gradient-1);\n    padding: 2.5rem 2rem;\n    margin: -2rem -2rem 2rem -2rem;\n    border-radius: 20px 20px 0 0;\n    display: flex;\n    align-items: center;\n    gap: 1.5rem;\n    color: white;\n}\n\n.booking-hero-icon {\n    font-size: 4rem;\n    background: rgba(255, 255, 255, 0.2);\n    width: 90px;\n    height: 90px;\n    border-radius: 20px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    backdrop-filter: blur(10px);\n    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);\n}\n\n.booking-hero-content {\n    flex: 1;\n}\n\n.booking-destination {\n    font-size: 1.8rem;\n    font-weight: 800;\n    margin: 0 0 0.5rem 0;\n}\n\n.booking-subtitle {\n    font-size: 1.1rem;\n    opacity: 0.95;\n    margin: 0;\n}\n\n.booking-summary-card {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(236, 72, 153, 0.05) 100%);\n    border-radius: 15px;\n    padding: 1.5rem;\n    margin-bottom: 1.5rem;\n    border: 1px solid rgba(99, 102, 241, 0.1);\n}\n\n.booking-row {\n    margin-bottom: 1rem;\n}\n\n.booking-row:last-child {\n    margin-bottom: 0;\n}\n\n.booking-detail {\n    display: flex;\n    align-items: flex-start;\n    gap: 1rem;\n}\n\n.booking-icon {\n    font-size: 1.8rem;\n    width: 45px;\n    height: 45px;\n    background: white;\n    border-radius: 12px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);\n}\n\n.detail-label {\n    font-size: 0.85rem;\n    color: var(--gray);\n    margin-bottom: 0.25rem;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.detail-value {\n    font-size: 1.1rem;\n    color: var(--dark);\n    font-weight: 600;\n}\n\n.passenger-controls {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    margin-top: 0.25rem;\n}\n\n.passenger-btn {\n    background: var(--primary);\n    border: none;\n    color: white;\n    width: 36px;\n    height: 36px;\n    border-radius: 10px;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 1.3rem;\n    transition: all 0.3s;\n    box-shadow: 0 4px 10px rgba(99, 102, 241, 0.3);\n}\n\n.passenger-btn:hover {\n    background: var(--primary-dark);\n    transform: translateY(-2px);\n    box-shadow: 0 6px 15px rgba(99, 102, 241, 0.4);\n}\n\n.passenger-btn:active {\n    transform: translateY(0);\n}\n\n.passenger-controls input {\n    width: 60px;\n    text-align: center;\n    font-size: 1.1rem;\n    font-weight: 700;\n    border: 2px solid var(--primary);\n    border-radius: 10px;\n    padding: 0.5rem;\n    color: var(--primary);\n    background: white;\n}\n\n.price-breakdown-card {\n    background: linear-gradient(135deg, rgba(16, 185, 129, 0.05) 0%, rgba(20, 184, 166, 0.05) 100%);\n    border-radius: 15px;\n    padding: 1.5rem;\n    margin-bottom: 1.5rem;\n    border: 1px solid rgba(16, 185, 129, 0.2);\n}\n\n.price-row {\n    display: flex;\n    justify-content: space-between;\n    padding: 0.75rem 0;\n    color: var(--dark);\n}\n\n.price-row span {\n    font-size: 1rem;\n}\n\n.price-divider {\n    height: 1px;\n    background: linear-gradient(90deg, transparent, var(--primary), transparent);\n    margin: 0.5rem 0;\n}\n\n.total-row {\n    padding-top: 1rem;\n    font-size: 1.1rem;\n}\n\n.total-price {\n    font-size: 1.8rem !important;\n    font-weight: 800 !important;\n    color: var(--success) !important;\n    transition: transform 0.2s ease;\n}\n\n.trust-badges {\n    display: flex;\n    gap: 1rem;\n    margin-bottom: 1.5rem;\n    flex-wrap: wrap;\n}\n\n.trust-badge {\n    flex: 1;\n    min-width: 140px;\n    background: white;\n    padding: 1rem;\n    border-radius: 12px;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 0.5rem;\n    text-align: center;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n    border: 2px solid rgba(99, 102, 241, 0.1);\n    transition: all 0.3s;\n}\n\n.trust-badge:hover {\n    transform: translateY(-3px);\n    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);\n    border-color: var(--primary);\n}\n\n.trust-badge span:first-child {\n    font-size: 1.8rem;\n}\n\n.trust-badge span:last-child {\n    font-size: 0.85rem;\n    color: var(--gray);\n    font-weight: 600;\n}\n\n.booking-form {\n    margin-bottom: 1.5rem;\n}\n\n.form-group-modern {\n    margin-bottom: 1.5rem;\n}\n\n.form-label-modern {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    margin-bottom: 0.75rem;\n    font-weight: 600;\n    color: var(--dark);\n}\n\n.label-icon {\n    font-size: 1.2rem;\n}\n\n.form-input-modern {\n    width: 100%;\n    padding: 1rem 1.25rem;\n    border: 2px solid #e2e8f0;\n    border-radius: 12px;\n    font-size: 1rem;\n    transition: all 0.3s;\n    font-family: inherit;\n    background: white;\n}\n\n.form-input-modern:focus {\n    outline: none;\n    border-color: var(--primary);\n    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);\n    transform: translateY(-2px);\n}\n\n.form-input-modern::placeholder {\n    color: #cbd5e1;\n}\n\ntextarea.form-input-modern {\n    resize: vertical;\n    min-height: 80px;\n}\n\n.btn-booking-cta {\n    width: 100%;\n    background: var(--gradient-1);\n    color: white;\n    border: none;\n    padding: 1.25rem 2rem;\n    border-radius: 15px;\n    font-size: 1.2rem;\n    font-weight: 700;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 1rem;\n    transition: all 0.3s;\n    box-shadow: 0 10px 25px rgba(99, 102, 241, 0.3);\n    position: relative;\n    overflow: hidden;\n}\n\n.btn-booking-cta::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);\n    transition: left 0.5s;\n}\n\n.btn-booking-cta:hover::before {\n    left: 100%;\n}\n\n.btn-booking-cta:hover {\n    transform: translateY(-3px);\n    box-shadow: 0 15px 35px rgba(99, 102, 241, 0.4);\n    cursor: none;\n}\n\n.btn-booking-cta:active {\n    transform: translateY(-1px);\n}\n\n.cta-text {\n    font-size: 1.1rem;\n}\n\n.cta-icon {\n    font-size: 1.5rem;\n}\n\n.booking-footer-note {\n    margin-top: 1.5rem;\n    padding: 1rem;\n    background: rgba(99, 102, 241, 0.05);\n    border-radius: 10px;\n    text-align: center;\n}\n\n.booking-footer-note p {\n    margin: 0;\n    font-size: 0.9rem;\n    color: var(--gray);\n}\n\n.pulse {\n    animation: pulse 2s infinite;\n}\n\n@keyframes pulse {\n    0%, 100% {\n        transform: scale(1);\n    }\n    50% {\n        transform: scale(1.05);\n    }\n}\n\n.success-icon {\n    font-size: 4rem;\n    text-align: center;\n    animation: bounceIn 0.6s ease-out;\n}\n\n@keyframes bounceIn {\n    0% {\n        transform: scale(0);\n    }\n    50% {\n        transform: scale(1.2);\n    }\n    100% {\n        transform: scale(1);\n    }\n}\n\n.alert {\n    padding: 1rem 1.5rem;\n    border-radius: 10px;\n    margin-bottom: 1rem;\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n}\n\n.alert-success {\n    background: rgba(16, 185, 129, 0.1);\n    border: 1px solid var(--success);\n    color: var(--success);\n}\n\n.alert-info {\n    background: rgba(99, 102, 241, 0.1);\n    border: 1px solid var(--primary);\n    color: var(--primary);\n}\n\n.alert-warning {\n    background: rgba(245, 158, 11, 0.1);\n    border: 1px solid var(--warning);\n    color: var(--warning);\n}\n\n.success-toast {\n    animation: slideInRight 0.5s ease-out, pulse 0.5s ease-out 0.5s;\n    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);\n    backdrop-filter: blur(10px);\n}\n\n@keyframes slideInRight {\n    from {\n        transform: translateX(400px);\n        opacity: 0;\n    }\n    to {\n        transform: translateX(0);\n        opacity: 1;\n    }\n}\n\n.shimmer {\n    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);\n    background-size: 200% 100%;\n    animation: shimmer 1.5s infinite;\n}\n\n@keyframes shimmer {\n    0% {\n        background-position: 200% 0;\n    }\n    100% {\n        background-position: -200% 0;\n    }\n}\n\n.floating {\n    animation: floating 3s ease-in-out infinite;\n}\n\n@keyframes floating {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(-10px);\n    }\n}\n\n/* Calendar Styles */\n.calendar-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));\n    gap: 2rem;\n    padding: 1rem;\n}\n\n.calendar-card {\n    background: white;\n    border-radius: 20px;\n    overflow: hidden;\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);\n    transition: all 0.3s;\n    display: flex;\n    border-left: 5px solid var(--primary);\n    animation: fadeIn 0.5s ease-out;\n}\n\n.calendar-card:hover {\n    transform: translateY(-5px);\n    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);\n    border-left-color: var(--secondary);\n}\n\n.calendar-date {\n    background: var(--gradient-1);\n    color: white;\n    padding: 1.5rem 1rem;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    min-width: 100px;\n    text-align: center;\n}\n\n.date-month {\n    font-size: 1rem;\n    font-weight: 600;\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n\n.date-day {\n    font-size: 3rem;\n    font-weight: 800;\n    line-height: 1;\n    margin: 0.5rem 0;\n}\n\n.date-year {\n    font-size: 0.9rem;\n    opacity: 0.9;\n}\n\n.calendar-content {\n    padding: 1.5rem;\n    flex: 1;\n}\n\n.trip-destination,\n.trip-dates,\n.trip-duration,\n.trip-budget,\n.trip-description {\n    margin: 0.5rem 0;\n    color: var(--gray);\n    font-size: 0.95rem;\n}\n\n.calendar-actions {\n    display: flex;\n    gap: 0.5rem;\n    margin-top: 1rem;\n}\n\n.btn-small {\n    padding: 0.5rem 1rem;\n    border: none;\n    border-radius: 8px;\n    font-size: 0.85rem;\n    font-weight: 600;\n    cursor: pointer;\n    transition: all 0.3s;\n    display: inline-flex;\n    align-items: center;\n    gap: 0.3rem;\n}\n\n.btn-view {\n    background: rgba(99, 102, 241, 0.1);\n    color: var(--primary);\n}\n\n.btn-view:hover {\n    background: rgba(99, 102, 241, 0.2);\n    transform: translateY(-2px);\n    cursor: none;\n}\n\n.btn-delete {\n    background: rgba(239, 68, 68, 0.1);\n    color: #ef4444;\n}\n\n.btn-delete:hover {\n    background: rgba(239, 68, 68, 0.2);\n    transform: translateY(-2px);\n    cursor: none;\n}\n\n/* Loading Animations */\n.loading-container {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    padding: 3rem;\n    text-align: center;\n}\n\n.loading-spinner-large {\n    display: inline-block;\n    width: 60px;\n    height: 60px;\n    border: 6px solid rgba(99, 102, 241, 0.1);\n    border-radius: 50%;\n    border-top-color: var(--primary);\n    animation: spin 1s linear infinite;\n    position: relative;\n}\n\n.loading-spinner-large::after {\n    content: '';\n    position: absolute;\n    top: -6px;\n    left: -6px;\n    right: -6px;\n    bottom: -6px;\n    border-radius: 50%;\n    border: 6px solid transparent;\n    border-right-color: var(--secondary);\n    animation: spin 1.5s linear infinite reverse;\n}\n\n/* Typing Indicator */\n.typing-indicator {\n    display: flex;\n    gap: 0.5rem;\n    padding: 1rem 1.5rem;\n    align-items: center;\n}\n\n.typing-indicator span {\n    width: 8px;\n    height: 8px;\n    border-radius: 50%;\n    background: var(--gray);\n    animation: typing 1.4s infinite;\n}\n\n.typing-indicator span:nth-child(1) {\n    animation-delay: 0s;\n}\n\n.typing-indicator span:nth-child(2) {\n    animation-delay: 0.2s;\n}\n\n.typing-indicator span:nth-child(3) {\n    animation-delay: 0.4s;\n}\n\n@keyframes typing {\n    0%, 60%, 100% {\n        transform: translateY(0);\n        opacity: 0.7;\n    }\n    30% {\n        transform: translateY(-10px);\n        opacity: 1;\n    }\n}\n\n/* Message highlight animation for dynamic effects */\n.message-highlight {\n    animation: messageHighlight 1s ease-out;\n}\n\n@keyframes messageHighlight {\n    0%, 100% {\n        transform: scale(1);\n        box-shadow: none;\n    }\n    50% {\n        transform: scale(1.02);\n        box-shadow: 0 0 20px rgba(99, 102, 241, 0.3);\n    }\n}\n\n/* Send Button Spinning Effect */\n.btn-primary.spinning {\n    animation: pulse 1.5s ease-in-out infinite, rotate 2s linear infinite;\n}\n\n@keyframes rotate {\n    from {\n        transform: rotate(0deg);\n    }\n    to {\n        transform: rotate(360deg);\n    }\n}\n\n.btn-primary.spinning:hover {\n    transform: translateY(-3px) rotate(360deg);\n}\n\n/* Empty State */\n.empty-state {\n    text-align: center;\n    padding: 4rem 2rem;\n    max-width: 600px;\n    margin: 0 auto;\n}\n\n.empty-icon {\n    font-size: 5rem;\n    margin-bottom: 1rem;\n    animation: floating 3s ease-in-out infinite;\n}\n\n.empty-state h3 {\n    font-size: 1.8rem;\n    color: var(--dark);\n    margin-bottom: 0.5rem;\n}\n\n.empty-state p {\n    color: var(--gray);\n    margin-bottom: 2rem;\n    font-size: 1.1rem;\n}\n\n/* Fade-in Animation for Messages */\n@keyframes fadeInUp {\n    from {\n        opacity: 0;\n        transform: translateY(30px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.message {\n    animation: fadeInUp 0.4s ease-out;\n}\n\n/* Data Fetching Skeleton Loader */\n.skeleton {\n    background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);\n    background-size: 200% 100%;\n    animation: shimmer 1.5s infinite;\n    border-radius: 10px;\n}\n\n/* Badge warning */\n.badge-warning {\n    background: rgba(245, 158, 11, 0.1);\n    color: var(--warning);\n}\n\n/* Pulse animation for important elements */\n@keyframes pulse {\n    0%, 100% {\n        opacity: 1;\n        transform: scale(1);\n    }\n    50% {\n        opacity: 0.8;\n        transform: scale(1.05);\n    }\n}\n\n.pulse-animation {\n    animation: pulse 2s ease-in-out infinite;\n}\n\n/* Smooth scroll */\nhtml {\n    scroll-behavior: smooth;\n}\n\n/* Enhanced card hover effects */\n.card-hover-effect {\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.card-hover-effect:hover {\n    transform: translateY(-5px);\n    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);\n}\n\n/* Gradient text animation */\n.gradient-text {\n    background: var(--gradient-1);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n    background-size: 200% auto;\n    animation: gradient-shift 3s ease infinite;\n}\n\n@keyframes gradient-shift {\n    0%, 100% {\n        background-position: 0% center;\n    }\n    50% {\n        background-position: 100% center;\n    }\n}\n\n/* Ripple effect */\n.ripple {\n    position: relative;\n    overflow: hidden;\n}\n\n.ripple::after {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 0;\n    height: 0;\n    border-radius: 50%;\n    background: rgba(255, 255, 255, 0.5);\n    transform: translate(-50%, -50%);\n    transition: width 0.6s, height 0.6s;\n}\n\n.ripple:active::after {\n    width: 300px;\n    height: 300px;\n}\n\n@media (max-width: 768px) {\n    .hero-title {\n        font-size: 2.5rem;\n    }\n\n    .hero-subtitle {\n        font-size: 1.2rem;\n    }\n\n    .nav-links {\n        display: none;\n    }\n\n    .features-grid,\n    .trips-grid,\n    .calendar-grid {\n        grid-template-columns: 1fr;\n    }\n    \n    .modal-content {\n        width: 95%;\n        max-height: 90vh;\n    }\n    \n    .calendar-card {\n        flex-direction: column;\n    }\n    \n    .calendar-date {\n        flex-direction: row;\n        gap: 1rem;\n        padding: 1rem;\n        min-width: auto;\n    }\n    \n    .date-day {\n        font-size: 2rem;\n    }\n    \n    .message-bubble {\n        max-width: 85%;\n    }\n    \n    .nav-link.nav-booking {\n        padding: 0.4rem 1rem;\n        font-size: 0.9rem;\n    }\n}\n\n/* Booking Page Styles */\n.booking-section {\n    background: white;\n    border-radius: 20px;\n    padding: 2rem;\n    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);\n    margin-bottom: 2rem;\n}\n\n.booking-section-title {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--dark);\n    margin-bottom: 1.5rem;\n    padding-bottom: 1rem;\n    border-bottom: 2px solid rgba(99, 102, 241, 0.1);\n}\n\n.booking-summary-card {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(236, 72, 153, 0.1) 100%);\n    border-radius: 20px;\n    padding: 2rem;\n    margin-bottom: 2rem;\n    border: 2px solid rgba(99, 102, 241, 0.2);\n}\n\n.booking-summary-content {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n    gap: 1rem;\n}\n\n.booking-summary-item {\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n}\n\n.booking-summary-item strong {\n    color: var(--primary);\n    font-size: 0.9rem;\n}\n\n.options-container {\n    display: flex;\n    flex-direction: column;\n    gap: 1.5rem;\n}\n\n.flight-card, .hotel-card {\n    background: white;\n    border: 2px solid #e2e8f0;\n    border-radius: 16px;\n    padding: 1.5rem;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    cursor: pointer;\n    position: relative;\n}\n\n.flight-card:hover, .hotel-card:hover {\n    border-color: var(--primary);\n    box-shadow: 0 8px 24px rgba(99, 102, 241, 0.15);\n    transform: translateY(-2px);\n}\n\n.flight-card.selected, .hotel-card.selected {\n    border-color: var(--primary);\n    background: rgba(99, 102, 241, 0.05);\n    box-shadow: 0 8px 24px rgba(99, 102, 241, 0.2);\n}\n\n.flight-card.selected::before, .hotel-card.selected::before {\n    content: '✓';\n    position: absolute;\n    top: 1rem;\n    right: 1rem;\n    width: 30px;\n    height: 30px;\n    background: var(--primary);\n    color: white;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: bold;\n    font-size: 1.2rem;\n}\n\n.flight-header, .hotel-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-start;\n    margin-bottom: 1rem;\n}\n\n.flight-info, .hotel-info {\n    flex: 1;\n}\n\n.flight-airline, .hotel-name {\n    font-size: 1.2rem;\n    font-weight: 700;\n    color: var(--dark);\n    margin-bottom: 0.5rem;\n}\n\n.flight-number, .hotel-location {\n    font-size: 0.9rem;\n    color: var(--gray);\n    margin-bottom: 0.5rem;\n}\n\n.flight-time, .hotel-rating {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    margin-top: 0.5rem;\n}\n\n.flight-price, .hotel-price {\n    text-align: right;\n}\n\n.flight-price-amount, .hotel-price-amount {\n    font-size: 1.5rem;\n    font-weight: 700;\n    color: var(--primary);\n}\n\n.flight-price-label, .hotel-price-label {\n    font-size: 0.85rem;\n    color: var(--gray);\n}\n\n.flight-details, .hotel-details {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));\n    gap: 1rem;\n    margin-top: 1rem;\n    padding-top: 1rem;\n    border-top: 1px solid #e2e8f0;\n}\n\n.flight-detail-item, .hotel-detail-item {\n    display: flex;\n    flex-direction: column;\n    gap: 0.25rem;\n}\n\n.flight-detail-label, .hotel-detail-label {\n    font-size: 0.8rem;\n    color: var(--gray);\n    font-weight: 500;\n}\n\n.flight-detail-value, .hotel-detail-value {\n    font-size: 0.95rem;\n    color: var(--dark);\n    font-weight: 600;\n}\n\n.hotel-amenities {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 0.5rem;\n    margin-top: 1rem;\n}\n\n.hotel-amenity {\n    background: rgba(99, 102, 241, 0.1);\n    color: var(--primary);\n    padding: 0.3rem 0.8rem;\n    border-radius: 20px;\n    font-size: 0.8rem;\n    font-weight: 500;\n}\n\n.hotel-reviews {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    margin-top: 0.5rem;\n}\n\n.star-rating {\n    color: #fbbf24;\n    font-size: 1rem;\n}\n\n.passenger-form {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n    gap: 1.5rem;\n}\n\n.form-group {\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n}\n\n.form-group label {\n    font-weight: 600;\n    color: var(--dark);\n    font-size: 0.95rem;\n}\n\n.form-input {\n    padding: 0.75rem 1rem;\n    border: 2px solid #e2e8f0;\n    border-radius: 12px;\n    font-size: 1rem;\n    transition: all 0.3s;\n    font-family: inherit;\n}\n\n.form-input:focus {\n    outline: none;\n    border-color: var(--primary);\n    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);\n}\n\n.price-summary-card {\n    background: white;\n    border-radius: 20px;\n    padding: 2rem;\n    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);\n    margin-top: 2rem;\n    position: sticky;\n    bottom: 2rem;\n}\n\n.price-breakdown {\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n}\n\n.price-row {\n    display: flex;\n    justify-content: space-between;\n    padding: 0.75rem 0;\n    border-bottom: 1px solid #e2e8f0;\n}\n\n.price-row.total-row {\n    border-top: 2px solid var(--primary);\n    border-bottom: none;\n    padding-top: 1rem;\n    margin-top: 0.5rem;\n    font-size: 1.2rem;\n}\n\n.price-row:last-child {\n    border-bottom: none;\n}\n\n/* My Trips Page - Enhanced Layout */\n#trips-page {\n    min-height: 100vh;\n    padding-top: 80px;\n}\n\n#trips-page .container {\n    max-width: 1400px;\n    margin: 0 auto;\n}\n\n#trips-page .section-title {\n    text-align: center;\n    font-size: 2.5rem;\n    margin-bottom: 0.5rem;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n}\n\n#trips-page .trips-subtitle {\n    text-align: center;\n    color: var(--text-secondary);\n    font-size: 1.1rem;\n    margin-bottom: 3rem;\n}\n\n#trips-page .trips-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));\n    gap: 2rem;\n    padding-bottom: 3rem;\n}\n\n/* Profile Menu Styles */\n.profile-menu-container {\n    position: relative;\n    cursor: default !important;\n    z-index: 1000;\n}\n\n.profile-trigger {\n    display: flex;\n    align-items: center;\n    padding: 0.5rem 1rem;\n    border-radius: 30px;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    background: rgba(99, 102, 241, 0.1);\n}\n\n.profile-trigger:hover {\n    background: rgba(99, 102, 241, 0.2);\n    cursor: none;\n}\n\n.profile-avatar {\n    width: 36px;\n    height: 36px;\n    border-radius: 50%;\n    background: var(--gradient-1);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    color: white;\n    font-weight: 700;\n    font-size: 0.9rem;\n    box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3);\n}\n\n.profile-dropdown {\n    position: absolute;\n    top: calc(100% + 0.5rem);\n    right: 0;\n    min-width: 280px;\n    background: var(--bg-secondary);\n    border-radius: 15px;\n    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);\n    border: 1px solid var(--border-color);\n    overflow: hidden;\n    z-index: 1001;\n    opacity: 0;\n    transform: translateY(-10px);\n    transition: opacity 0.3s ease-out, transform 0.3s ease-out;\n    pointer-events: none;\n}\n\n.profile-dropdown.show {\n    opacity: 1;\n    transform: translateY(0);\n    pointer-events: auto;\n}\n\n@keyframes dropdownFade {\n    from {\n        opacity: 0;\n        transform: translateY(-10px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.profile-dropdown-header {\n    padding: 1.5rem;\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n}\n\n.profile-avatar-large {\n    width: 50px;\n    height: 50px;\n    border-radius: 50%;\n    background: var(--gradient-1);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    color: white;\n    font-weight: 700;\n    font-size: 1.2rem;\n    box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);\n    flex-shrink: 0;\n}\n\n.profile-info {\n    flex: 1;\n    min-width: 0;\n}\n\n.profile-name {\n    font-weight: 700;\n    font-size: 1rem;\n    color: var(--text-primary);\n    margin-bottom: 0.25rem;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.profile-email {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.profile-dropdown-divider {\n    height: 1px;\n    background: var(--border-color);\n    margin: 0.5rem 0;\n}\n\n.profile-dropdown-menu {\n    list-style: none;\n    padding: 0.5rem 0;\n    margin: 0;\n}\n\n.profile-dropdown-menu li {\n    padding: 0.75rem 1.5rem;\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    cursor: pointer;\n    transition: all 0.2s ease;\n    color: var(--text-primary);\n    font-size: 0.95rem;\n}\n\n.profile-dropdown-menu li:hover {\n    background: rgba(99, 102, 241, 0.1);\n    color: var(--primary);\n    cursor: none;\n}\n\n.profile-dropdown-menu li svg {\n    flex-shrink: 0;\n}\n\n.profile-dropdown-menu li.logout-item {\n    color: #ef4444;\n}\n\n.profile-dropdown-menu li.logout-item:hover {\n    background: rgba(239, 68, 68, 0.1);\n    cursor: none;\n}\n\n/* Dark mode support for profile */\n[data-theme=\"dark\"] .profile-trigger {\n    background: rgba(99, 102, 241, 0.15);\n}\n\n[data-theme=\"dark\"] .profile-trigger:hover {\n    background: rgba(99, 102, 241, 0.25);\n    cursor: none;\n}\n\n[data-theme=\"dark\"] .profile-dropdown {\n    background: #1e293b;\n    border-color: rgba(99, 102, 241, 0.2);\n}\n\n[data-theme=\"dark\"] .profile-dropdown-header {\n    background: rgba(99, 102, 241, 0.15);\n}\n\n/* Toast Notifications */\n#toast-container {\n    position: fixed;\n    top: 90px;\n    right: 20px;\n    z-index: 10000;\n    display: flex;\n    flex-direction: column;\n    gap: 0.75rem;\n    max-width: 400px;\n}\n\n.toast {\n    background: white;\n    border-radius: 12px;\n    padding: 1rem 1.25rem;\n    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);\n    border-left: 4px solid var(--primary);\n    display: flex;\n    align-items: start;\n    gap: 0.75rem;\n    animation: toastSlideIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    min-width: 300px;\n    max-width: 400px;\n}\n\n.toast.toast-success {\n    border-left-color: #10b981;\n}\n\n.toast.toast-error {\n    border-left-color: #ef4444;\n}\n\n.toast.toast-warning {\n    border-left-color: #f59e0b;\n}\n\n.toast.toast-info {\n    border-left-color: #3b82f6;\n}\n\n.toast-icon {\n    font-size: 1.25rem;\n    flex-shrink: 0;\n    margin-top: 0.1rem;\n}\n\n.toast-content {\n    flex: 1;\n    min-width: 0;\n}\n\n.toast-title {\n    font-weight: 700;\n    font-size: 0.95rem;\n    margin-bottom: 0.25rem;\n    color: var(--text-primary);\n}\n\n.toast-message {\n    font-size: 0.875rem;\n    color: var(--text-secondary);\n    line-height: 1.5;\n}\n\n.toast-close {\n    background: none;\n    border: none;\n    font-size: 1.5rem;\n    color: var(--text-secondary);\n    cursor: pointer;\n    padding: 0;\n    width: 24px;\n    height: 24px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 4px;\n    transition: all 0.2s ease;\n    flex-shrink: 0;\n}\n\n.toast-close:hover {\n    background: rgba(0, 0, 0, 0.05);\n    color: var(--text-primary);\n}\n\n.toast.toast-hiding {\n    animation: toastSlideOut 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;\n}\n\n@keyframes toastSlideIn {\n    from {\n        transform: translateX(400px);\n        opacity: 0;\n    }\n    to {\n        transform: translateX(0);\n        opacity: 1;\n    }\n}\n\n@keyframes toastSlideOut {\n    from {\n        transform: translateX(0) scale(1);\n        opacity: 1;\n    }\n    to {\n        transform: translateX(400px) scale(0.8);\n        opacity: 0;\n    }\n}\n\n/* Dark mode toast */\n[data-theme=\"dark\"] .toast {\n    background: #1e293b;\n    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);\n}\n\n[data-theme=\"dark\"] .toast-close:hover {\n    background: rgba(255, 255, 255, 0.1);\n}\n\n/* Mobile Navbar Responsive */\n@media (max-width: 1024px) {\n    .nav-links {\n        gap: 0.75rem;\n        font-size: 0.9rem;\n    }\n    \n    .profile-trigger {\n        padding: 0.4rem 0.75rem;\n    }\n    \n    .profile-avatar {\n        width: 32px;\n        height: 32px;\n        font-size: 0.85rem;\n    }\n}\n\n@media (max-width: 900px) {\n    .nav-link {\n        padding: 0.5rem 0.75rem;\n    }\n    \n    .nav-link.nav-booking {\n        padding: 0.4rem 1rem !important;\n        font-size: 0.85rem;\n    }\n    \n    .profile-dropdown {\n        right: -10px;\n    }\n}\n\n@media (max-width: 768px) {\n    .nav-container {\n        padding: 0.75rem 1rem;\n    }\n    \n    .nav-links {\n        gap: 0.5rem;\n        font-size: 0.85rem;\n        overflow-x: auto;\n        -webkit-overflow-scrolling: touch;\n        scrollbar-width: none;\n    }\n    \n    .nav-links::-webkit-scrollbar {\n        display: none;\n    }\n    \n    .nav-link {\n        white-space: nowrap;\n        padding: 0.4rem 0.6rem;\n    }\n    \n    .nav-link.theme-toggle,\n    .profile-menu-container {\n        flex-shrink: 0;\n    }\n}\n\n/* Mobile toast adjustments */\n@media (max-width: 640px) {\n    #toast-container {\n        right: 10px;\n        left: 10px;\n        max-width: none;\n        top: 70px;\n    }\n    \n    .toast {\n        min-width: auto;\n        max-width: none;\n    }\n    \n    .nav-logo {\n        font-size: 1rem;\n    }\n    \n    .nav-links {\n        font-size: 0.8rem;\n    }\n    \n    .profile-dropdown {\n        min-width: 260px;\n        right: 0;\n    }\n}\n","size_bytes":59862},"attached_assets/content-1762635480469.md":{"content":"# 404\n\n## This page could not be found.\n\nStripeM-Inner","size_bytes":54},"static/auth-styles.css":{"content":"/* Authentication Pages Styles - Beautiful & Dynamic */\n\n/* Welcome/Landing Page */\n.welcome-container {\n    min-height: 100vh;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    position: relative;\n    overflow: hidden;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n}\n\n/* Animated Background */\n.welcome-bg {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    overflow: hidden;\n}\n\n.gradient-orb {\n    position: absolute;\n    border-radius: 50%;\n    filter: blur(80px);\n    opacity: 0.6;\n    animation: float 20s ease-in-out infinite;\n}\n\n.orb-1 {\n    width: 400px;\n    height: 400px;\n    background: radial-gradient(circle, rgba(236, 72, 153, 0.8) 0%, transparent 70%);\n    top: -100px;\n    left: -100px;\n    animation-delay: 0s;\n}\n\n.orb-2 {\n    width: 600px;\n    height: 600px;\n    background: radial-gradient(circle, rgba(99, 102, 241, 0.6) 0%, transparent 70%);\n    bottom: -150px;\n    right: -150px;\n    animation-delay: 7s;\n}\n\n.orb-3 {\n    width: 500px;\n    height: 500px;\n    background: radial-gradient(circle, rgba(168, 85, 247, 0.7) 0%, transparent 70%);\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    animation-delay: 14s;\n}\n\n@keyframes float {\n    0%, 100% { transform: translate(0, 0) scale(1); }\n    25% { transform: translate(10px, -10px) scale(1.02); }\n    50% { transform: translate(-8px, 8px) scale(0.98); }\n    75% { transform: translate(8px, 10px) scale(1.01); }\n}\n\n/* Welcome Content */\n.welcome-content {\n    position: relative;\n    z-index: 10;\n    text-align: center;\n    color: white;\n    max-width: 600px;\n    padding: 2rem;\n    animation: fadeInUp 0.8s ease-out;\n}\n\n.welcome-logo {\n    margin-bottom: 2rem;\n}\n\n.logo-icon {\n    width: 120px;\n    height: 120px;\n    margin: 0 auto 1.5rem;\n    filter: drop-shadow(0 10px 30px rgba(0, 0, 0, 0.3));\n}\n\n.welcome-title {\n    font-size: 3.5rem;\n    font-weight: 900;\n    margin: 0;\n    background: linear-gradient(135deg, #ffffff 0%, #f0f0ff 100%);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n    text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\n    animation: shimmer 3s ease-in-out infinite;\n}\n\n@keyframes shimmer {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.8; }\n}\n\n.welcome-tagline {\n    font-size: 1.5rem;\n    margin: 1rem 0 3rem;\n    opacity: 0.95;\n    font-weight: 300;\n    letter-spacing: 0.5px;\n}\n\n/* Mini Features */\n.welcome-features-mini {\n    display: flex;\n    justify-content: center;\n    gap: 2rem;\n    margin: 3rem 0;\n    flex-wrap: wrap;\n}\n\n.mini-feature {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    background: rgba(255, 255, 255, 0.15);\n    backdrop-filter: blur(10px);\n    padding: 1rem 1.5rem;\n    border-radius: 50px;\n    border: 1px solid rgba(255, 255, 255, 0.2);\n    font-weight: 500;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    animation: fadeIn 0.6s ease-out backwards;\n    cursor: pointer;\n}\n\n.mini-feature:nth-child(1) { animation-delay: 0.2s; }\n.mini-feature:nth-child(2) { animation-delay: 0.4s; }\n.mini-feature:nth-child(3) { animation-delay: 0.6s; }\n\n.mini-feature:hover {\n    background: rgba(255, 255, 255, 0.25);\n    transform: translateY(-5px);\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);\n    cursor: none;\n}\n\n.mini-icon {\n    font-size: 1.5rem;\n}\n\n/* Welcome Buttons */\n.welcome-actions {\n    display: flex;\n    gap: 1.5rem;\n    justify-content: center;\n    margin: 3rem 0;\n}\n\n.btn-welcome {\n    padding: 1.25rem 3rem;\n    font-size: 1.125rem;\n    font-weight: 700;\n    border: none;\n    border-radius: 50px;\n    cursor: pointer;\n    display: inline-flex;\n    align-items: center;\n    gap: 0.75rem;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    position: relative;\n    overflow: hidden;\n}\n\n.btn-welcome::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);\n    transform: translateX(-100%);\n    transition: transform 0.6s;\n}\n\n.btn-welcome:hover::before {\n    transform: translateX(100%);\n}\n\n.btn-signin {\n    background: white;\n    color: #667eea;\n    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);\n}\n\n.btn-signin:hover {\n    transform: translateY(-3px) scale(1.05);\n    box-shadow: 0 15px 50px rgba(0, 0, 0, 0.3);\n    cursor: none;\n}\n\n.btn-signup {\n    background: rgba(255, 255, 255, 0.2);\n    color: white;\n    border: 2px solid white;\n    backdrop-filter: blur(10px);\n}\n\n.btn-signup:hover {\n    background: rgba(255, 255, 255, 0.3);\n    transform: translateY(-3px) scale(1.05);\n    cursor: none;\n}\n\n.btn-arrow {\n    transition: transform 0.3s;\n}\n\n.btn-welcome:hover .btn-arrow {\n    transform: translateX(5px);\n}\n\n/* Welcome Info */\n.welcome-info {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    gap: 2rem;\n    margin-top: 4rem;\n    flex-wrap: wrap;\n    opacity: 0.9;\n}\n\n.info-item {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 0.25rem;\n}\n\n.info-item strong {\n    font-size: 1.75rem;\n    font-weight: 800;\n    background: linear-gradient(135deg, #ffffff 0%, #f0f0ff 100%);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n}\n\n.info-divider {\n    width: 1px;\n    height: 40px;\n    background: rgba(255, 255, 255, 0.3);\n}\n\n/* Auth Container - Split Screen */\n.auth-container {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    min-height: 100vh;\n    background: #f8fafc;\n}\n\n[data-theme=\"dark\"] .auth-container {\n    background: #0f172a;\n}\n\n/* Left Side - Visual */\n.auth-left {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    padding: 3rem;\n    position: relative;\n    overflow: hidden;\n}\n\n.auth-left::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: url('data:image/svg+xml,<svg width=\"100\" height=\"100\" xmlns=\"http://www.w3.org/2000/svg\"><defs><pattern id=\"grid\" width=\"100\" height=\"100\" patternUnits=\"userSpaceOnUse\"><path d=\"M 100 0 L 0 0 0 100\" fill=\"none\" stroke=\"rgba(255,255,255,0.05)\" stroke-width=\"1\"/></pattern></defs><rect width=\"100%\" height=\"100%\" fill=\"url(%23grid)\" /></svg>');\n    opacity: 0.5;\n}\n\n.auth-visual {\n    position: relative;\n    z-index: 1;\n    color: white;\n    max-width: 500px;\n    text-align: center;\n}\n\n.visual-icon {\n    font-size: 5rem;\n    margin-bottom: 2rem;\n    animation: float 3s ease-in-out infinite;\n    filter: drop-shadow(0 10px 30px rgba(0, 0, 0, 0.3));\n}\n\n.visual-title {\n    font-size: 3rem;\n    font-weight: 900;\n    margin-bottom: 1rem;\n    text-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);\n}\n\n.visual-subtitle {\n    font-size: 1.25rem;\n    margin-bottom: 3rem;\n    opacity: 0.95;\n    line-height: 1.6;\n}\n\n.visual-features {\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n    text-align: left;\n}\n\n.visual-feature {\n    padding: 1rem 1.5rem;\n    background: rgba(255, 255, 255, 0.15);\n    backdrop-filter: blur(10px);\n    border-radius: 12px;\n    border: 1px solid rgba(255, 255, 255, 0.2);\n    font-size: 1.125rem;\n    transition: all 0.3s;\n}\n\n.visual-feature:hover {\n    background: rgba(255, 255, 255, 0.25);\n    transform: translateX(10px);\n}\n\n/* Right Side - Form */\n.auth-right {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    padding: 3rem;\n    background: white;\n}\n\n[data-theme=\"dark\"] .auth-right {\n    background: #1e293b;\n}\n\n.auth-form-container {\n    max-width: 480px;\n    width: 100%;\n    animation: fadeIn 0.6s ease-out;\n}\n\n.btn-back {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.5rem;\n    padding: 0.5rem 1rem;\n    background: none;\n    border: 1px solid #e2e8f0;\n    border-radius: 8px;\n    color: var(--dark);\n    cursor: pointer;\n    font-size: 0.95rem;\n    margin-bottom: 2rem;\n    transition: all 0.3s;\n}\n\n[data-theme=\"dark\"] .btn-back {\n    border-color: #475569;\n    color: var(--light);\n}\n\n.btn-back:hover {\n    background: #f1f5f9;\n    transform: translateX(-5px);\n    cursor: none;\n}\n\n[data-theme=\"dark\"] .btn-back:hover {\n    background: #334155;\n    cursor: none;\n}\n\n.auth-title {\n    font-size: 2.5rem;\n    font-weight: 800;\n    color: var(--dark);\n    margin-bottom: 0.5rem;\n}\n\n[data-theme=\"dark\"] .auth-title {\n    color: var(--light);\n}\n\n.auth-subtitle {\n    color: var(--gray);\n    font-size: 1rem;\n    margin-bottom: 2.5rem;\n}\n\n/* Auth Form */\n.auth-form {\n    display: flex;\n    flex-direction: column;\n    gap: 1.5rem;\n}\n\n.form-group-auth {\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n}\n\n.form-group-auth label {\n    font-weight: 600;\n    color: var(--dark);\n    font-size: 0.95rem;\n}\n\n[data-theme=\"dark\"] .form-group-auth label {\n    color: var(--light);\n}\n\n.auth-input {\n    padding: 0.875rem 1.125rem;\n    border: 2px solid #e2e8f0;\n    border-radius: 12px;\n    font-size: 1rem;\n    transition: all 0.3s;\n    background: white;\n}\n\n[data-theme=\"dark\"] .auth-input {\n    background: #334155;\n    border-color: #475569;\n    color: var(--light);\n}\n\n.auth-input:focus {\n    outline: none;\n    border-color: #667eea;\n    box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);\n}\n\n.auth-input::placeholder {\n    color: #94a3b8;\n}\n\n.input-hint {\n    font-size: 0.875rem;\n    color: var(--gray);\n    margin-top: 0.25rem;\n}\n\n/* Form Options */\n.form-options {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin: -0.5rem 0;\n}\n\n.checkbox-label {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    cursor: pointer;\n    color: var(--dark);\n    font-size: 0.95rem;\n}\n\n[data-theme=\"dark\"] .checkbox-label {\n    color: var(--light);\n}\n\n.checkbox-label input[type=\"checkbox\"] {\n    width: 18px;\n    height: 18px;\n    cursor: pointer;\n    accent-color: #667eea;\n}\n\n.link-forgot, .link-inline {\n    color: #667eea;\n    text-decoration: none;\n    font-size: 0.95rem;\n    font-weight: 600;\n    transition: all 0.3s;\n}\n\n.link-forgot:hover, .link-inline:hover {\n    color: #764ba2;\n    text-decoration: underline;\n}\n\n/* Submit Button */\n.btn-submit {\n    padding: 1rem 2rem;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    border: none;\n    border-radius: 12px;\n    font-size: 1.125rem;\n    font-weight: 700;\n    cursor: pointer;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    margin-top: 0.5rem;\n    position: relative;\n    overflow: hidden;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 0.5rem;\n}\n\n.btn-submit::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);\n    transform: translateX(-100%);\n    transition: transform 0.6s;\n}\n\n.btn-submit:hover::before {\n    transform: translateX(100%);\n}\n\n.btn-submit:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);\n    cursor: none;\n}\n\n.btn-submit:disabled {\n    opacity: 0.6;\n    cursor: not-allowed;\n    transform: none;\n}\n\n.btn-spinner {\n    border: 3px solid rgba(255, 255, 255, 0.3);\n    border-top-color: white;\n    border-radius: 50%;\n    width: 20px;\n    height: 20px;\n    animation: spin 0.8s linear infinite;\n}\n\n/* Divider */\n.auth-divider {\n    display: flex;\n    align-items: center;\n    text-align: center;\n    margin: 2rem 0 1.5rem;\n    color: var(--gray);\n    font-size: 0.875rem;\n}\n\n.auth-divider::before,\n.auth-divider::after {\n    content: '';\n    flex: 1;\n    border-bottom: 1px solid #e2e8f0;\n}\n\n[data-theme=\"dark\"] .auth-divider::before,\n[data-theme=\"dark\"] .auth-divider::after {\n    border-color: #475569;\n}\n\n.auth-divider span {\n    padding: 0 1rem;\n}\n\n/* Social Buttons */\n.social-buttons {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 1rem;\n}\n\n.btn-social {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 0.75rem;\n    padding: 0.875rem 1.5rem;\n    border: 2px solid #e2e8f0;\n    border-radius: 12px;\n    background: white;\n    color: var(--dark);\n    cursor: pointer;\n    font-weight: 600;\n    transition: all 0.3s;\n}\n\n[data-theme=\"dark\"] .btn-social {\n    background: #334155;\n    border-color: #475569;\n    color: var(--light);\n}\n\n.btn-social:hover {\n    border-color: #667eea;\n    background: #f8fafc;\n    transform: translateY(-2px);\n    cursor: none;\n}\n\n[data-theme=\"dark\"] .btn-social:hover {\n    background: #475569;\n    cursor: none;\n}\n\n/* Auth Switch */\n.auth-switch {\n    text-align: center;\n    margin-top: 2rem;\n    color: var(--gray);\n}\n\n.auth-switch a {\n    color: #667eea;\n    font-weight: 600;\n    text-decoration: none;\n    transition: all 0.3s;\n}\n\n.auth-switch a:hover {\n    color: #764ba2;\n    text-decoration: underline;\n}\n\n/* Animations */\n@keyframes fadeIn {\n    from { opacity: 0; }\n    to { opacity: 1; }\n}\n\n@keyframes fadeInUp {\n    from {\n        opacity: 0;\n        transform: translateY(30px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n/* Responsive Design */\n@media (max-width: 968px) {\n    .auth-container {\n        grid-template-columns: 1fr;\n    }\n    \n    .auth-left {\n        display: none;\n    }\n    \n    .welcome-title {\n        font-size: 2.5rem;\n    }\n    \n    .welcome-actions {\n        flex-direction: column;\n    }\n    \n    .btn-welcome {\n        width: 100%;\n        justify-content: center;\n    }\n    \n    .welcome-features-mini {\n        flex-direction: column;\n        gap: 1rem;\n    }\n    \n    .welcome-info {\n        gap: 1rem;\n    }\n    \n    .info-divider {\n        display: none;\n    }\n}\n\n@media (max-width: 640px) {\n    .welcome-title {\n        font-size: 2rem;\n    }\n    \n    .welcome-tagline {\n        font-size: 1.125rem;\n    }\n    \n    .logo-icon {\n        width: 80px;\n        height: 80px;\n    }\n    \n    .auth-right {\n        padding: 2rem 1.5rem;\n    }\n    \n    .auth-title {\n        font-size: 2rem;\n    }\n    \n    .social-buttons {\n        grid-template-columns: 1fr;\n    }\n}\n\n/* Feature Tooltip */\n.feature-tooltip {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    z-index: 10000;\n    opacity: 0;\n    visibility: hidden;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    pointer-events: none;\n    background: rgba(0, 0, 0, 0.6);\n    backdrop-filter: blur(5px);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.feature-tooltip.active {\n    opacity: 1;\n    visibility: visible;\n    pointer-events: auto;\n}\n\n.tooltip-content {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    padding: 2.5rem;\n    border-radius: 20px;\n    max-width: 500px;\n    width: 90vw;\n    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);\n    position: relative;\n    animation: tooltipSlideUp 0.3s ease-out;\n    transform: scale(0.8);\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.feature-tooltip.active .tooltip-content {\n    transform: scale(1);\n}\n\n@keyframes tooltipSlideUp {\n    from {\n        transform: translateY(20px);\n        opacity: 0;\n    }\n    to {\n        transform: translateY(0);\n        opacity: 1;\n    }\n}\n\n.tooltip-close {\n    position: absolute;\n    top: 1rem;\n    right: 1rem;\n    background: rgba(255, 255, 255, 0.2);\n    border: none;\n    color: white;\n    font-size: 2rem;\n    width: 40px;\n    height: 40px;\n    border-radius: 50%;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.3s;\n    line-height: 1;\n}\n\n.tooltip-close:hover {\n    background: rgba(255, 255, 255, 0.3);\n    transform: rotate(90deg);\n}\n\n.tooltip-content h3 {\n    font-size: 1.75rem;\n    margin-bottom: 1rem;\n    font-weight: 700;\n}\n\n.tooltip-content p {\n    font-size: 1.1rem;\n    line-height: 1.6;\n    opacity: 0.95;\n    font-weight: 300;\n}\n","size_bytes":15956}},"version":2}